<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AI第一天</title>
    <url>/2022/02/21/AI_Day1/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>AI</category>
      </categories>
      <tags>
        <tag>AI</tag>
      </tags>
  </entry>
  <entry>
    <title>firstOne</title>
    <url>/2022/01/09/1/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>前端</category>
      </categories>
  </entry>
  <entry>
    <title>linux常用命令</title>
    <url>/2022/01/12/Linux%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h4 id="1-系统状况"><a href="#1-系统状况" class="headerlink" title="1.系统状况"></a>1.系统状况</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">top # 查看所有进程的信息，M按内存排序，p按cpu排序</span><br><span class="line">df -h # 查看硬盘使用情况</span><br><span class="line">free -h # 查看内存使用情况</span><br><span class="line">du -sh # 查看当前目录占用的硬盘空间</span><br><span class="line">ps aux # 查看所有进程</span><br><span class="line">kill -9 pid # 杀死编号pid的进程</span><br><span class="line">netstat -nt #查看所有网络连接</span><br><span class="line">w #列出当前登录的用户</span><br><span class="line">ping www.baidu.com # 检查是否联网</span><br></pre></td></tr></table></figure>

<h4 id="2-文件权限"><a href="#2-文件权限" class="headerlink" title="2.文件权限"></a>2.文件权限</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chmod +x xxx <span class="comment">#添加可执行权限</span></span><br><span class="line">chmod +x xxx -R <span class="comment">#递归地修改整个文件</span></span><br></pre></td></tr></table></figure>

<h4 id="3-文件"><a href="#3-文件" class="headerlink" title="3.文件"></a>3.文件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find path -name <span class="string">&#x27;*.py&#x27;</span> <span class="comment">#搜索某个路径下的.py文件</span></span><br><span class="line">grep xxx <span class="comment"># stdin读入若干行数据</span></span><br><span class="line">wc <span class="comment"># 统计行数等 -l 行数 -w 单词数 -c 字节数</span></span><br><span class="line">tree <span class="comment">#展示文件结构，-a展示隐藏文件</span></span><br><span class="line">ag xxx <span class="comment">#搜索当前目录下的所有文件，检索xxx字符</span></span><br><span class="line">cut -d <span class="string">&#x27;分割符&#x27;</span> -f 3,5 <span class="comment">#分割符分开的第3，第5列</span></span><br><span class="line">sort <span class="comment">#按字典序排序</span></span><br><span class="line">xargs <span class="comment">#将stdin数据分割成命令</span></span><br><span class="line">head -3 xxx <span class="comment">#展示前三行内容，tail是尾部</span></span><br></pre></td></tr></table></figure>

<h4 id="4-工具"><a href="#4-工具" class="headerlink" title="4.工具"></a>4.工具</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">time <span class="built_in">command</span> <span class="comment">#统计command的执行时间</span></span><br><span class="line">ipython3 <span class="comment">#小型jupyter</span></span><br><span class="line">tar -zcvf xxx.tar.gz path <span class="comment">#压缩至</span></span><br><span class="line">tar -zxvf xxx.tar.gz <span class="comment">#解压</span></span><br><span class="line">diff xxx yyy <span class="comment">#查找两个文件的不同点</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux命令</tag>
      </tags>
  </entry>
  <entry>
    <title>bash</title>
    <url>/2022/01/10/bash/</url>
    <content><![CDATA[<h4 id="1-Hello-World"><a href="#1-Hello-World" class="headerlink" title="1. Hello World"></a>1. Hello World</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span> <span class="comment">#双引号表示执行，单引号表示单纯输出</span></span><br><span class="line"></span><br><span class="line">chmod +x xxx.sh <span class="comment">#使xxx.sh脚本具有执行能力</span></span><br></pre></td></tr></table></figure>

<h4 id="2-注释"><a href="#2-注释" class="headerlink" title="2.注释"></a>2.注释</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">:&lt;&lt;!</span><br><span class="line">注释 <span class="comment"># !是任意字符串，#也可</span></span><br><span class="line">!</span><br></pre></td></tr></table></figure>

<h4 id="3-变量"><a href="#3-变量" class="headerlink" title="3.变量"></a>3.变量</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">name=<span class="string">&#x27;luohk&#x27;</span></span><br><span class="line">name=<span class="string">&quot;luohk&quot;</span></span><br><span class="line">name=luohk <span class="comment">#三种都是一样的</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$name</span> <span class="comment"># luohk</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;name&#125;</span>19 <span class="comment"># luohk19</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">readonly</span> name <span class="comment">#只读变量</span></span><br><span class="line"><span class="built_in">declare</span> -r name <span class="comment">#另一种写法</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">unset</span> name <span class="comment">#删除变量</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> name <span class="comment">#自定义转环境</span></span><br><span class="line"><span class="built_in">export</span> name=luohk <span class="comment">#环境转自定义</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#name&#125;</span> <span class="comment"># 5</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#name:0:3&#125;</span> <span class="comment">#luo</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#默认变量 $0, $1, $2</span></span><br><span class="line"><span class="comment"># $# 传入参数个数; $* 用空格隔开; $@ 参数用双引号括起来</span></span><br></pre></td></tr></table></figure>

<h4 id="4-数组"><a href="#4-数组" class="headerlink" title="4.数组"></a>4.数组</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">array=(1 xyz luohk) <span class="comment">#用空格隔开</span></span><br><span class="line">array[1] = xyz <span class="comment">#按index取</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$&#123;array[index]&#125;</span> <span class="comment">#按index取值</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$&#123;array[*]&#125;</span> || <span class="variable">$&#123;array[@]&#125;</span> <span class="comment">#取整个数组,获取数组长度在前加#</span></span><br></pre></td></tr></table></figure>

<h4 id="5-expr"><a href="#5-expr" class="headerlink" title="5.expr"></a>5.expr</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">str = <span class="string">&quot;hello world!&quot;</span></span><br><span class="line"><span class="built_in">echo</span> `expr length <span class="string">&quot;<span class="variable">$str</span>&quot;</span>` <span class="comment">#注意不是单引号，输出12</span></span><br><span class="line"><span class="built_in">echo</span> `expr index <span class="string">&quot;<span class="variable">$str</span>&quot;</span> aWd` <span class="comment">#输出任意一个字符在最前面的位置</span></span><br><span class="line"><span class="built_in">echo</span> `expr substr <span class="string">&quot;<span class="variable">$str</span>&quot;</span> 2 3` <span class="comment">#index从1开始,ell</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> `expr <span class="variable">$a</span> \* <span class="variable">$b</span>` <span class="comment">#支持乘法操作，但乘法需要转义</span></span><br><span class="line"><span class="built_in">echo</span> `expr \( <span class="variable">$a</span> + 1 \) \* \( <span class="variable">$b</span> + 1 \)` <span class="comment">#括号也需要转义</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> `expr <span class="variable">$a</span> <span class="string">&#x27;&lt;&#x27;</span> <span class="variable">$b</span>` | <span class="built_in">echo</span> `expr <span class="variable">$a</span> \&lt; <span class="variable">$b</span>` <span class="comment">#一样，小于等于等需要连续转义</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &amp;运算当两个非零时，返回第一个参数，否则返回0；若第一个为0或空，不计算第二个</span></span><br><span class="line"><span class="comment"># |运算，优先返回非空非0的值；若第一个参数非空或非0时，不会计算第二个参数</span></span><br></pre></td></tr></table></figure>

<h4 id="6-读取，-echo，printf-类似c-c-的"><a href="#6-读取，-echo，printf-类似c-c-的" class="headerlink" title="6.读取， echo，printf(类似c/c++的)"></a>6.读取， echo，printf(类似c/c++的)</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">read</span> name <span class="comment">#读取输入至name</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;please input your name&quot;</span> -t 30 name <span class="comment">#等三十秒提示输入到名字</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;Hi\n&quot;</span> <span class="comment"># -e开启转义, Hi回车</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span> &gt; output.txt <span class="comment">#输出到特定文件</span></span><br><span class="line"><span class="built_in">echo</span> `date` <span class="comment">#输出时间</span></span><br></pre></td></tr></table></figure>

<h4 id="7-test"><a href="#7-test" class="headerlink" title="7.test"></a>7.test</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">man <span class="built_in">test</span> <span class="comment">#可以查看test的用法</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> 2 -lt 3 <span class="comment"># 0表示真</span></span><br><span class="line"><span class="built_in">echo</span> $? <span class="comment">#输出上一个命令的返回值</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> -e filename <span class="comment">#判断是否存在， -f是否为文件，-d是否为目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#类似地， -r是否可读， -w可写， -x可执行， -s是否为空</span></span><br><span class="line"><span class="comment"># -eq -ne -gt -lt -ge -le latex懂得都懂</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#字符串也可比较</span></span><br><span class="line"><span class="built_in">test</span> str1 == str2</span><br><span class="line"><span class="built_in">test</span> str1 != str2</span><br><span class="line"></span><br><span class="line"><span class="built_in">test</span> -r filename -a -x filename <span class="comment"># -a是否同时成立， -o至少一个成立，！取反</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [] 与 test 类似</span></span><br></pre></td></tr></table></figure>

<h4 id="8-判断"><a href="#8-判断" class="headerlink" title="8.判断"></a>8.判断</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> condition  <span class="comment">#condition用上面的[]实现</span></span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">	<span class="comment">#blabla</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># if-else</span></span><br><span class="line"><span class="keyword">if</span> condition</span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">	<span class="comment">#blabla</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="comment">#blabla</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># if-elif-else</span></span><br><span class="line"><span class="keyword">if</span> condition</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">	<span class="comment">#blabla</span></span><br><span class="line"><span class="keyword">elif</span> condition</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">	<span class="comment">#blabla</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="comment">#blabla</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#case</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$name</span> <span class="keyword">in</span></span><br><span class="line">	value1)</span><br><span class="line">		<span class="comment">#bla</span></span><br><span class="line">		;;</span><br><span class="line">	value2)</span><br><span class="line">		<span class="comment">#bla</span></span><br><span class="line">		;;</span><br><span class="line">	*)</span><br><span class="line">		<span class="comment">#bla</span></span><br><span class="line">		;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<h4 id="9-循环语句"><a href="#9-循环语句" class="headerlink" title="9.循环语句"></a>9.循环语句</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#形式1</span></span><br><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> var1 var2 var3</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="comment">#blabla</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例子</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(seq 1 10) <span class="comment"># &#123;a..z&#125;输出a到z</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$i</span> <span class="comment">#输出1到10</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#形式2</span></span><br><span class="line"><span class="keyword">for</span> ((expr;cond;expr))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="comment">#bla</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例子</span></span><br><span class="line"><span class="keyword">for</span> ((i=1; i&lt;=10; i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#形式3</span></span><br><span class="line"><span class="keyword">while</span> condition</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="comment">#bla</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例子</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> name</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$name</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#形式4，while改until根据意思就知道</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#break命令无法跳出case，;;才行</span></span><br><span class="line"><span class="comment">#break命令可以跳出一层循环</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#continue类似</span></span><br></pre></td></tr></table></figure>

<h4 id="10-函数"><a href="#10-函数" class="headerlink" title="10.函数"></a>10.函数</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[<span class="keyword">function</span>] <span class="function"><span class="title">func_name</span></span>() &#123;</span><br><span class="line">	<span class="comment">#bla</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># $(func_name) 获取中间stdout的值</span></span><br><span class="line"><span class="comment"># $?获取上一次调用的返回</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">func</span></span>() &#123;</span><br><span class="line">	name=luohk</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;hello <span class="variable">$name</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output=$(func)</span><br><span class="line">ret=$?</span><br><span class="line"></span><br><span class="line"><span class="comment">#函数内采用 $1, $2来取输入参数，但$0仍是文件名</span></span><br><span class="line"><span class="built_in">echo</span> $(func 10)</span><br><span class="line"></span><br><span class="line"><span class="comment">#局部变量</span></span><br><span class="line"><span class="built_in">local</span> name=luohk</span><br></pre></td></tr></table></figure>

<h4 id="11-exit、文件重定向、引入外部脚本"><a href="#11-exit、文件重定向、引入外部脚本" class="headerlink" title="11.exit、文件重定向、引入外部脚本"></a>11.exit、文件重定向、引入外部脚本</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exit</span> 0 <span class="comment">#表示成功 且 能被$?接收</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">command</span> &gt; file <span class="comment">#将stdout重定向到file中</span></span><br><span class="line"><span class="built_in">command</span> &gt;&gt; file <span class="comment">#追加方式</span></span><br><span class="line"><span class="comment">#反之是读入</span></span><br><span class="line"></span><br><span class="line">```test.sh</span><br><span class="line"><span class="comment">#! /bin/bash</span></span><br><span class="line"><span class="built_in">read</span> a</span><br><span class="line"><span class="built_in">read</span> b</span><br><span class="line"><span class="built_in">echo</span> $(expr <span class="string">&quot;<span class="variable">$a</span>&quot;</span> + <span class="string">&quot;<span class="variable">$b</span>&quot;</span>)</span><br><span class="line">```</span><br><span class="line">```input.txt</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">```</span><br><span class="line">chmod +x test.sh</span><br><span class="line">./test.sh &lt; input.txt &gt; output.txt</span><br><span class="line">cat output.txt <span class="comment"># 7</span></span><br><span class="line"><span class="comment">#用这个也可以实现对拍噢</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> test1.sh</span><br><span class="line"><span class="comment">#可以使用test1.sh内的变量</span></span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>bash</tag>
      </tags>
  </entry>
  <entry>
    <title>django后端AI训练</title>
    <url>/2022/01/12/django/</url>
    <content><![CDATA[<h4 id="1-初始配置"><a href="#1-初始配置" class="headerlink" title="1.初始配置"></a>1.初始配置</h4><p>如果想完美贴合本次教程的环境，可以联系作者发送docker文件以确保环境相同。</p>
<p>在此之前若未安装docker可以先安装，安装教程<a href="https://luohk19.github.io/2022/01/12/%E7%A7%9F%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%8E%AF%E5%A2%83/">如此</a>，docker的使用教程[如此](<a href="https://luohk19.github.io/2022/01/12/docker/">docker使用 | luohk19</a>)。</p>
<p>安装镜像后，创建容器，开启项目，配置git</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">django-admin --version #检查是否安装</span><br><span class="line"></span><br><span class="line">django-admin startproject mysite #创建项目 xxx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看目录</span></span><br><span class="line">mysite/ #项目容器，可以随时改名</span><br><span class="line">	manage.py/ # 管理项目的命令行工具</span><br><span class="line">	mysite/ </span><br><span class="line">		__init__.py # 告诉python这个目录要被认为是一个包</span><br><span class="line">		settings.py # 配置文件</span><br><span class="line">		urls.py	# 路由文件</span><br><span class="line">		asgi.py # asgi在web服务器上的入口</span><br><span class="line">		wsgi.py # wsgi在web服务器上的入口</span><br><span class="line"></span><br><span class="line">git init #创建git环境</span><br></pre></td></tr></table></figure>

<h4 id="2-开始"><a href="#2-开始" class="headerlink" title="2.开始"></a>2.开始</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#初始运行</span></span><br><span class="line">python3 manage.py runserver <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">8000</span></span><br><span class="line"><span class="comment">#当用本地的host访问时会报错，需要在/acapp/settings.py内添加对应的allowed_hosts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#创建app</span></span><br><span class="line">python3 manage.py startapp game</span><br><span class="line"></span><br><span class="line"><span class="comment">#及时更新</span></span><br><span class="line">python3 manage.py migrate</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建管理员用户</span></span><br><span class="line">python3 manage.py createsuperuser <span class="comment">#随后打开host:port/admin登录</span></span><br><span class="line"><span class="comment">#随后创建urls.py,templates文件夹</span></span><br></pre></td></tr></table></figure>

<h4 id="3-创建路由"><a href="#3-创建路由" class="headerlink" title="3.创建路由"></a>3.创建路由</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在game app内创建的urls.py 中仿照总acapp内的urls.py 写url</span></span><br><span class="line"><span class="comment"># 最后在总的urls内添加对应的path</span></span><br><span class="line">```game/urls.py</span><br><span class="line"><span class="keyword">import</span> game.views <span class="keyword">import</span> index</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, index, name=<span class="string">&quot;index&quot;</span>)</span><br><span class="line">]</span><br><span class="line">```</span><br><span class="line">```game/views.py</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;hello World!&#x27;</span>)</span><br><span class="line">```</span><br><span class="line">```acapp/urls.py</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> include</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;game/&#x27;</span>, include(<span class="string">&#x27;game.urls&#x27;</span>)), <span class="comment">#当只有一个app时不需要写&#x27;game/&#x27;</span></span><br><span class="line">    ...</span><br><span class="line">]</span><br><span class="line">```</span><br></pre></td></tr></table></figure>

<h4 id="4-储存数据"><a href="#4-储存数据" class="headerlink" title="4.储存数据"></a>4.储存数据</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 需要在mysite的settings.py文件夹中加入，指示静态数据的位置</span></span><br><span class="line">STATIC_ROOT = os.path.join(BASE_DIR, <span class="string">&#x27;static&#x27;</span>) <span class="comment">#在lenet下创建static文件夹</span></span><br><span class="line">MEDIA_ROOT = os.path.join(BASE_DIR, <span class="string">&#x27;media&#x27;</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>后端</category>
      </categories>
      <tags>
        <tag>django</tag>
        <tag>后端</tag>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>docker使用</title>
    <url>/2022/01/12/docker/</url>
    <content><![CDATA[<h4 id="1-前期配置"><a href="#1-前期配置" class="headerlink" title="1.前期配置"></a>1.前期配置</h4><p>请看<a href="https://luohk19.github.io/2022/01/12/%E7%A7%9F%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%8E%AF%E5%A2%83/">服务器配置</a>，完成后便可开始</p>
<h4 id="2-Docker概念"><a href="#2-Docker概念" class="headerlink" title="2.Docker概念"></a>2.Docker概念</h4><h5 id="2-1-Docker的结构"><a href="#2-1-Docker的结构" class="headerlink" title="2.1 Docker的结构"></a>2.1 Docker的结构</h5><p>$docker\begin{cases}image \begin{cases}container \cr container \cr … \end{cases}   \cr image \cr …\end{cases}$</p>
<h5 id="2-2-Docker的小概念"><a href="#2-2-Docker的小概念" class="headerlink" title="2.2 Docker的小概念"></a>2.2 Docker的小概念</h5><p>采用相同的image（镜像）生成的container（容器）配置都相同。</p>
<p>每个container都是完全独立的云端服务器，docker管理image时会采取空间优化。</p>
<p>未来如果需要迁移container，可以先生成image（可下载到其他服务器加载）</p>
<h4 id="3-Docker-Images"><a href="#3-Docker-Images" class="headerlink" title="3.Docker Images"></a>3.Docker Images</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker pull ubuntu:20.04 <span class="comment">#可以拉取一个镜像 name:tag</span></span><br><span class="line"></span><br><span class="line">docker images <span class="comment">#查看目前存在的image</span></span><br><span class="line"></span><br><span class="line">docker rmi &lt;imageName&gt; <span class="comment">#便可删除对应镜像</span></span><br><span class="line"></span><br><span class="line">docker save -o ubuntu_20_04.tar ubuntu:20.04 <span class="comment">#保存镜像,可以用ls -l查看权限</span></span><br><span class="line"><span class="comment"># 查看权限后发现仅自己有可读写权限，因此需要添加权限</span></span><br><span class="line"></span><br><span class="line">docker load -i ubuntu_20_04.tar <span class="comment">#读取生成镜像</span></span><br><span class="line"><span class="comment">#可以将原镜像删去再检验</span></span><br></pre></td></tr></table></figure>

<p>自此通过scp命令可以实现不同服务器的镜像迁移</p>
<h4 id="4-Docker-Container"><a href="#4-Docker-Container" class="headerlink" title="4.Docker Container"></a>4.Docker Container</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker create -it ubuntu:20.04 <span class="comment">#利用image生成container</span></span><br><span class="line"></span><br><span class="line">docker ps -a <span class="comment">#查看创建了的容器，无a则展示正在运行的</span></span><br><span class="line"></span><br><span class="line">docker start CONTAINER_ID <span class="comment">#启动容器，docker ps检验</span></span><br><span class="line"></span><br><span class="line">docker stop CONTAINER_ID <span class="comment">#停止容器，docker ps检验</span></span><br><span class="line"></span><br><span class="line">docker restart CONTAINER_ID <span class="comment">#重启</span></span><br><span class="line"></span><br><span class="line">docker run -itd ubuntu:20.04 <span class="comment">#创建并启动container</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#CONTAINER_ID 与 CONTAINER_NAME 都可以，下面用CONTAINER代替</span></span><br><span class="line"></span><br><span class="line">docker attach CONTAINER <span class="comment">#进入容器，前提是已启动，默认root</span></span><br><span class="line"><span class="comment">#想退出？ ctrl+p 再 ctrl+q, ctrl+q是用于挂起，否则直接关闭</span></span><br><span class="line"></span><br><span class="line">docker <span class="built_in">exec</span> CONTAINER COMMAND <span class="comment">#在某容器内执行命令，!!!容器必须运行</span></span><br><span class="line"></span><br><span class="line">docker rm CONTAINER <span class="comment">#删除容器，注意rmi与rm的区别</span></span><br><span class="line"><span class="comment">#删除前要停止容器，全删除已停止的容器为docker container prune</span></span><br><span class="line"></span><br><span class="line">docker <span class="built_in">export</span> -o xxx.tar CONTAINER <span class="comment">#不保存历史记录等，占用内存比save更少</span></span><br><span class="line"><span class="comment">#注意添加可读权限</span></span><br><span class="line"></span><br><span class="line">docker import xxx.tar ubuntu:20.04 <span class="comment">#导入，实现容器到其他服务器镜像的迁移</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#剩下的都是一些小操作</span></span><br><span class="line">docker top CONTAINER <span class="comment">#查看容器的的所有进程</span></span><br><span class="line">docker stats <span class="comment">#查看所有容器的信息cpu等</span></span><br><span class="line">docker cp xxx CONTAINER:XXX <span class="comment">#本地与容器之间传递信息</span></span><br><span class="line">docker rename CONTAINER1 CONTAINER2 <span class="comment">#重命名</span></span><br><span class="line">docker update CONTAINER --XXX XXX <span class="comment">#更新各种参数</span></span><br></pre></td></tr></table></figure>

<h4 id="5-对于vscode"><a href="#5-对于vscode" class="headerlink" title="5.对于vscode"></a>5.对于vscode</h4><p>在docker挂起时，可能会发生vscode的快捷键冲突，因此需要找到左下角设置-&gt;快捷键</p>
<p>再查找ctrl+q的快捷方式，将视图的when条件加上 !terminalFocus 便可</p>
<p>解决方法来源于stackOverFlow</p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2022/01/08/hello-world/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">
  <script id="hbeData" type="hbeData" data-hmacdigest="60d335b7180a6957abe64f977aafef3d3a993b5bff30507ffd9f3e75ef7790de">10d79030e8222445804370796b90fca1fcf46a07b5ecf341c635269a7fe842f80cf07e697ff3618a365f409d43ee2a0b71169e7502cdfd2ac90458dd940f8bc9dffd4520316db24d3e303037ca2d5032e72bf872f07e40dbb3cf3ace773ac1c9</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>private</tag>
      </tags>
  </entry>
  <entry>
    <title>租服务器的环境配置</title>
    <url>/2022/01/12/%E7%A7%9F%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<h4 id="1-购买指南及前期操作"><a href="#1-购买指南及前期操作" class="headerlink" title="1.购买指南及前期操作"></a>1.购买指南及前期操作</h4><ul>
<li><p>内存不需要买太大（1核2G），后期动态扩容</p>
</li>
<li><p>不用买最大带宽，按量付费更实惠</p>
</li>
<li><p>选择ubuntu20.04，支持后续docker</p>
</li>
<li><p>安全组控制能访问那些端口（起码要有22端口）ssh，在sshconfig修改允许登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/ssh</span><br><span class="line">sudo vim sshd_config</span><br></pre></td></tr></table></figure></li>
<li><p>创建非root用户，给予sudo权限</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">adduser luohk</span><br><span class="line">usermod -aG sudo luohk</span><br><span class="line"></span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 装tmux, 根据自己的需求更改tmux.conf</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="2-在docker上配置"><a href="#2-在docker上配置" class="headerlink" title="2.在docker上配置"></a>2.在docker上配置</h4><h5 id="2-1-安装docker"><a href="#2-1-安装docker" class="headerlink" title="2.1 安装docker"></a>2.1 安装docker</h5><p><a href="https://docs.docker.com/engine/install/ubuntu/">Install Docker Engine on Ubuntu | Docker Documentation</a></p>
<p>到install Docker Engine第一步结束就可</p>
<h5 id="2-2-加入docker用户组"><a href="#2-2-加入docker用户组" class="headerlink" title="2.2 加入docker用户组"></a>2.2 加入docker用户组</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 不用每次都输入sudo</span></span><br><span class="line">sudo usermod -aG docker <span class="variable">$USER</span></span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第一天</title>
    <url>/2022/02/08/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day1/</url>
    <content><![CDATA[<h2 id="1-General-Purpose-Registers"><a href="#1-General-Purpose-Registers" class="headerlink" title="1. General Purpose Registers"></a>1. General Purpose Registers</h2><p>1.1. 32bit寄存器为4bytes，即xxxxh。</p>
<p>1.2. 以32位寄存器eax举例，内部还有低16bit[ax]，在ax内还分为高八位ah与低八位al</p>
<p>1.3. 对于64bit-Processors，将前面的e改成r或删去最后的D</p>
<p><a href="https://imgtu.com/i/H1pd6e"><img src="https://s4.ax1x.com/2022/02/08/H1pd6e.png" alt="寄存器" style="zoom: 80%;" /></a></p>
<p>1.3. 之所以为general purpose register，作用如下：</p>
<p><a href="https://imgtu.com/i/H19F1O"><img src="https://s4.ax1x.com/2022/02/08/H19F1O.png" alt="H19F1O.png"></a></p>
<h2 id="2-计算地址偏移量"><a href="#2-计算地址偏移量" class="headerlink" title="2. 计算地址偏移量"></a>2. 计算地址偏移量</h2><p>example:  08F1:0100的实际地址为08F10+0100=09010，即起始地址*16</p>
<p>？可能是由于地址范围大，需要用更少的位数表达更大的地址</p>
<h2 id="3-汇编程序的一般格式"><a href="#3-汇编程序的一般格式" class="headerlink" title="3. 汇编程序的一般格式"></a>3. 汇编程序的一般格式</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.386</span><br><span class="line">.model flat, stdcall</span><br><span class="line">.stack 4096</span><br><span class="line">ExitProcess PROTO, dwExitCode:DWORD</span><br><span class="line"></span><br><span class="line">.data</span><br><span class="line">; declare variables here, ; leads comment</span><br><span class="line">COMMENT !</span><br><span class="line">	;multi-lines comments</span><br><span class="line">!</span><br><span class="line">.code</span><br><span class="line">main PROC</span><br><span class="line">	; write your code here</span><br><span class="line">	INVOKE ExitProcess, 0</span><br><span class="line">main ENDP</span><br><span class="line"></span><br><span class="line">; insert additional procedures here</span><br><span class="line">END main</span><br></pre></td></tr></table></figure>

<h2 id="4-汇编的常见元素"><a href="#4-汇编的常见元素" class="headerlink" title="4. 汇编的常见元素"></a>4. 汇编的常见元素</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; 进制</span><br><span class="line">h hexadecimal</span><br><span class="line">d decimal</span><br><span class="line">b binary</span><br><span class="line">o octal</span><br><span class="line"></span><br><span class="line">; 操作</span><br><span class="line">stc ; set carry flag, no operands</span><br><span class="line"></span><br><span class="line">inc eax ; register</span><br><span class="line">inc myByte ; memory one operand</span><br><span class="line"></span><br><span class="line">add ebx, ecx ; register register</span><br><span class="line">sub myByte, 25 ; memory constant</span><br><span class="line">add eax, 36*25 ; register constant-expression</span><br></pre></td></tr></table></figure>

<h2 id="5-一个简单汇编例子"><a href="#5-一个简单汇编例子" class="headerlink" title="5. 一个简单汇编例子"></a>5. 一个简单汇编例子</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TITLE add and subtract</span><br><span class="line"></span><br><span class="line">.386</span><br><span class="line">.model flat, stdcall</span><br><span class="line">.stack 4096</span><br><span class="line"></span><br><span class="line">ExitProcess PROTO. dwExitCode:DWORD</span><br><span class="line">DumpRegs PROTO</span><br><span class="line"></span><br><span class="line">.code</span><br><span class="line">main PROC</span><br><span class="line">	mov eax, 10000h	; eax = 10000h</span><br><span class="line">	add eax, 40000h ; eax = 50000h</span><br><span class="line">	sub eax, 20000h ; eax = 30000h</span><br><span class="line">	call DumpRegs</span><br><span class="line">	INVOKE ExitProcess, 0</span><br><span class="line">main ENDP</span><br><span class="line">END main</span><br></pre></td></tr></table></figure>

<h2 id="6-汇编过程"><a href="#6-汇编过程" class="headerlink" title="6.汇编过程"></a>6.汇编过程</h2><p><a href="https://imgtu.com/i/H1Pq9P"><img src="https://s4.ax1x.com/2022/02/08/H1Pq9P.png" alt="H1Pq9P.png"></a></p>
<h2 id="7-数据类型"><a href="#7-数据类型" class="headerlink" title="7. 数据类型"></a>7. 数据类型</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; integer</span><br><span class="line">BYTE, SBYTE ; 8bit unsigned and signed</span><br><span class="line">WORD, SWORD ; 16it</span><br><span class="line">DWORD, SDWORD ; 32bit</span><br><span class="line">QWORD ; 64bit</span><br><span class="line">TBYTE ; 80bit integer</span><br><span class="line"></span><br><span class="line">; real</span><br><span class="line">REAL4 ; 4byte IEEE short real</span><br><span class="line">REAL8 ; 8byte long</span><br><span class="line">REAL10 ; 10byte extended</span><br><span class="line"></span><br><span class="line">; define variables</span><br><span class="line">val1 BYTE &#x27;A&#x27;</span><br><span class="line">val2 SBYTE +127 ; largest signed byte</span><br><span class="line">list1 BYTE 10, 20, 30, 40 ; list</span><br><span class="line">str1 BYTE &quot;enter your name&quot;, 0 ; null-terminated</span><br><span class="line"></span><br><span class="line">; 如果想实现回车，需要在末尾加入0dh,0ah</span><br><span class="line">; 0dh = carriage return</span><br><span class="line">; 0ah = line feed</span><br><span class="line">; 一个是回车，一个是换行</span><br><span class="line"></span><br><span class="line">; Using DUP operator</span><br><span class="line">var1 BYTE 20 DUP(0) ; 20 bytes, all equal to 0</span><br><span class="line">var2 BYTE 20 DUP(?) ; 20 bytes, uninitialized</span><br></pre></td></tr></table></figure>

<h2 id="8-小端法与大端法"><a href="#8-小端法与大端法" class="headerlink" title="8. 小端法与大端法"></a>8. 小端法与大端法</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">little endian order means least significant to low memory address</span><br><span class="line">big endian order is the opposite</span><br><span class="line"></span><br><span class="line">val1 DWORD 12345678h</span><br></pre></td></tr></table></figure>

<h2 id="9-Symbolic-Constants"><a href="#9-Symbolic-Constants" class="headerlink" title="9. Symbolic Constants"></a>9. Symbolic Constants</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; calculating the size of a byte array</span><br><span class="line">list BYTE 10, 20, 30, 40</span><br><span class="line">ListSize = ($ - list)</span><br><span class="line">; if it&#x27;s a word, listSize should be divided by 2</span><br><span class="line"></span><br><span class="line">; EQU Directive that can&#x27;t be redefined</span><br><span class="line">PI EQU &lt;3.1416&gt;</span><br><span class="line">pressKey EQU &lt;&quot;press any key to continue..&quot;,0&gt;</span><br><span class="line">.data</span><br><span class="line">prompt BYTE pressKey</span><br><span class="line"></span><br><span class="line">; TEXTEQU Directive that can be redefined</span><br><span class="line">continueMsg TEXTEQU &lt;&quot;Do you wish to continue (Y/N)?&quot;&gt;</span><br><span class="line">rowSize = 5</span><br><span class="line">.data</span><br><span class="line">prompt1 BYTE continueMsg</span><br><span class="line">count TEXTEQU %(rowSize * 2)</span><br><span class="line">setupAL TEXTEQU &lt;mov al, count&gt;</span><br><span class="line">.code</span><br><span class="line">	setupAL</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第二天</title>
    <url>/2022/02/08/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day2/</url>
    <content><![CDATA[<h2 id="1-Direct-Memory-Operand"><a href="#1-Direct-Memory-Operand" class="headerlink" title="1. Direct Memory Operand"></a>1. Direct Memory Operand</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">var1 BYTE 10h</span><br><span class="line">.code</span><br><span class="line">mov al, var1</span><br><span class="line">mov al, [var1]</span><br></pre></td></tr></table></figure>

<h4 id="1-1-mov-instruction"><a href="#1-1-mov-instruction" class="headerlink" title="1.1 mov instruction"></a>1.1 mov instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">count BYTE 100</span><br><span class="line">wVal WORD 2</span><br><span class="line">.code</span><br><span class="line">	mov bl, count</span><br><span class="line">	mov ax, wVal</span><br><span class="line">	mov count, al</span><br><span class="line">; 需要控制大小</span><br></pre></td></tr></table></figure>

<p>为解决以上需要控制大小的问题，引入了以下两种操作：</p>
<ol>
<li>movzx 用0填补空缺</li>
<li>movsx 用1填补空缺</li>
</ol>
<h4 id="1-2-xchg-instruction"><a href="#1-2-xchg-instruction" class="headerlink" title="1.2 xchg instruction"></a>1.2 xchg instruction</h4><p>至少有一个register</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">var1 WORD 1000h</span><br><span class="line">var2 WORD 2000h</span><br><span class="line">.code</span><br><span class="line">xchg ax, bx</span><br><span class="line">xchg var1, bx</span><br><span class="line">xchg ah, al</span><br></pre></td></tr></table></figure>

<h2 id="2-Direct-Offset-Operands"><a href="#2-Direct-Offset-Operands" class="headerlink" title="2. Direct-Offset Operands"></a>2. Direct-Offset Operands</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">arrayB BYTE 10h, 20h, 30h, 40h</span><br><span class="line">.code</span><br><span class="line">mov al, arrayB+1 ; al = 20h</span><br><span class="line">mov al, [arrayB + 1] ; al = 20h</span><br></pre></td></tr></table></figure>

<h2 id="3-addition-and-subtraction"><a href="#3-addition-and-subtraction" class="headerlink" title="3. addition and subtraction"></a>3. addition and subtraction</h2><h4 id="3-1-inc-and-dec"><a href="#3-1-inc-and-dec" class="headerlink" title="3.1    inc and dec"></a>3.1    inc and dec</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">	myWord WORD 1000h</span><br><span class="line">	myDword DWORD 10000000h</span><br><span class="line">.code</span><br><span class="line">	inc myWord	;1001h</span><br><span class="line">	dec myWord	;1000h</span><br><span class="line">	inc myDword ;10000001h</span><br><span class="line">	</span><br><span class="line">	mov ax, 00FFh</span><br><span class="line">	inc ax ; ax = 0100h</span><br><span class="line">	mov ax, 00FFh</span><br><span class="line">	inc al ; ax = 0000h</span><br></pre></td></tr></table></figure>

<h4 id="3-2-add-and-sub"><a href="#3-2-add-and-sub" class="headerlink" title="3.2    add and sub"></a>3.2    add and sub</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">	var1 DWORD 10000h</span><br><span class="line">	var2 DWORD 20000h</span><br><span class="line">.code				; ---EAX---</span><br><span class="line">	mov eax, var1	; 10000h</span><br><span class="line">	add eax, var2	; 30000h</span><br><span class="line">	add ax, 0FFFFh	; 3FFFFh</span><br><span class="line">	add eax, 1		; 40000h</span><br><span class="line">	sub ax, 1		; 4FFFFh</span><br></pre></td></tr></table></figure>

<h4 id="3-3-neg-instruction"><a href="#3-3-neg-instruction" class="headerlink" title="3.3    neg instruction"></a>3.3    neg instruction</h4><p>to reverse the sign of an operand</p>
<h4 id="3-4-flags"><a href="#3-4-flags" class="headerlink" title="3.4    flags"></a>3.4    flags</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; zero flag (ZF), when ans = 0, ZF = 1</span><br><span class="line">; sign flag (SF), When ans &lt; 0, SF = 1</span><br><span class="line">; carry flag (CF), when ans generates an unsigned value that&#x27;s out of range.</span><br><span class="line">; overflow flag (OF), change above unsigned to signed</span><br><span class="line">; parity flag (PF), when the number of &#x27;1&#x27; is even, PF = 1</span><br><span class="line">; auxiliary carry flag(AF), when a carry out of bit3 to bit4, AF = 1</span><br><span class="line"></span><br><span class="line">overflow flag changes when two positives or negatives add together.</span><br></pre></td></tr></table></figure>

<h2 id="4-Data-Related-Operators-and-Directives"><a href="#4-Data-Related-Operators-and-Directives" class="headerlink" title="4. Data-Related Operators and Directives"></a>4. Data-Related Operators and Directives</h2><h4 id="4-1-offset-operator"><a href="#4-1-offset-operator" class="headerlink" title="4.1    offset operator"></a>4.1    offset operator</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; example of offset</span><br><span class="line">.data</span><br><span class="line">bVal BYTE ?</span><br><span class="line">wVal BYTE ?</span><br><span class="line">dVal BYTE ?</span><br><span class="line">dVal2 BYTE ?</span><br><span class="line">.code</span><br><span class="line">mov esi, OFFSET bVal	; ESI = 00404000h</span><br><span class="line">mov esi, OFFSET wVal	; ESI = 00404001h</span><br><span class="line">mov esi, OFFSET dVal	; ESI = 00404003h</span><br><span class="line">mov esi, OFFSET dVal2	; ESI = 00404007h</span><br></pre></td></tr></table></figure>

<h4 id="4-2-PTR-Operator"><a href="#4-2-PTR-Operator" class="headerlink" title="4.2    PTR Operator"></a>4.2    PTR Operator</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">myDouble DWORD 12345678h</span><br><span class="line">.code</span><br><span class="line">mov ax, myDouble	; error</span><br><span class="line">mov ax, WORD PTR myDouble	; loads 5678h</span><br><span class="line">mov WORD PTR myDouble, 4321h; saves 4321h</span><br><span class="line"></span><br><span class="line">.data</span><br><span class="line">myDouble DWORD 12345678h</span><br><span class="line">,code</span><br><span class="line">mov al, BYTE PTR myDouble	; AL = </span><br><span class="line">mov al, BYTE PTR [myDouble + 1] ; +1是按byte加的, 与array区分开来</span><br></pre></td></tr></table></figure>

<h4 id="4-3-LENGTHOF-Operator"><a href="#4-3-LENGTHOF-Operator" class="headerlink" title="4.3    LENGTHOF Operator"></a>4.3    LENGTHOF Operator</h4><p>计算元素的个数，而非字节数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">byte1 BYTE 10,20,30</span><br><span class="line">array1 WORD 30 DUP(?), 0, 0</span><br><span class="line">.code</span><br><span class="line">mov ecx, LENGTHOF array1 ;32</span><br></pre></td></tr></table></figure>

<h4 id="4-4-SIZEOF-Operator"><a href="#4-4-SIZEOF-Operator" class="headerlink" title="4.4    SIZEOF Operator"></a>4.4    SIZEOF Operator</h4><p>计算的字节数大小</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">byte1 BYTE 10,20,30</span><br><span class="line">array1 WORD 30 DUP(?), 0, 0</span><br><span class="line">.code</span><br><span class="line">mov ecx, SIZEOF array1 ;64</span><br></pre></td></tr></table></figure>

<h4 id="4-5-LABEL-Directive"><a href="#4-5-LABEL-Directive" class="headerlink" title="4.5 LABEL Directive"></a>4.5 LABEL Directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">dwList LABEL DWORD</span><br><span class="line">wordList LABEL WORD</span><br><span class="line">intList BYTE 00h, 10h, 00h, 20h</span><br><span class="line">.code</span><br><span class="line">mov eax, dwList</span><br><span class="line">mov cx, wordList</span><br><span class="line">mov dl, intList</span><br></pre></td></tr></table></figure>

<h2 id="5-Indirect-Addressing"><a href="#5-Indirect-Addressing" class="headerlink" title="5. Indirect Addressing"></a>5. Indirect Addressing</h2><h4 id="5-1-使用-来间接寻址"><a href="#5-1-使用-来间接寻址" class="headerlink" title="5.1 使用[]来间接寻址"></a>5.1 使用[]来间接寻址</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">val1 BYTE 10h, 20h, 30h</span><br><span class="line">.code</span><br><span class="line">mov esi, OFFSET val1</span><br><span class="line">mov al, [esi]</span><br><span class="line">inc esi</span><br><span class="line">mov al, [esi]</span><br><span class="line">inc esi</span><br><span class="line">mov al, [esi]</span><br></pre></td></tr></table></figure>

<h4 id="5-2-使用PTR来确定"><a href="#5-2-使用PTR来确定" class="headerlink" title="5.2 使用PTR来确定"></a>5.2 使用PTR来确定</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">myCount WORD 0</span><br><span class="line">.code</span><br><span class="line">mov esi, OFFSET myCount</span><br><span class="line">inc [esi] ;error: ambiguous</span><br><span class="line">inc WORD PTR [esi] ;ok</span><br></pre></td></tr></table></figure>

<p>example</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">arrayW WORD 1000h, 2000h, 3000h</span><br><span class="line">.code</span><br><span class="line">mov esi, 0</span><br><span class="line">mov ax, [arrayW + esi]</span><br><span class="line">mov ax, arrayW[esi]		;alternate format</span><br></pre></td></tr></table></figure>

<h4 id="5-3-Index-Scaling"><a href="#5-3-Index-Scaling" class="headerlink" title="5.3 Index Scaling"></a>5.3 Index Scaling</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">arrayB BYTE 0,1,2,3,4,5</span><br><span class="line">arrayW WORD 0,1,2,3,4,5</span><br><span class="line">arrayD DWORD 0,1,2,3,4,5</span><br><span class="line">.code</span><br><span class="line">mov esi, 4</span><br><span class="line">mov al, arrayB[esi * TYPE arrayB]</span><br><span class="line">mov ax, arrayW[esi * TYPE arrayW]</span><br><span class="line">mov eax, arrayD[esi * TYPE arrayD]</span><br></pre></td></tr></table></figure>

<h4 id="5-4-pointers"><a href="#5-4-pointers" class="headerlink" title="5.4 pointers"></a>5.4 pointers</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">arrayW WORD 1000h, 2000h, 3000h</span><br><span class="line">ptrW DWORD arrayD ; ptrW DWORD OFFSET arrayD an alternate format</span><br><span class="line">.code</span><br><span class="line">mov esi, ptrW</span><br><span class="line">mov ax, [esi]</span><br></pre></td></tr></table></figure>

<h2 id="6-JMP-and-Loop-Instructions"><a href="#6-JMP-and-Loop-Instructions" class="headerlink" title="6. JMP and Loop Instructions"></a>6. JMP and Loop Instructions</h2><h4 id="6-1-JMP-Instruction"><a href="#6-1-JMP-Instruction" class="headerlink" title="6.1 JMP Instruction"></a>6.1 JMP Instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">top:</span><br><span class="line">	.</span><br><span class="line">	.</span><br><span class="line">	jmp top</span><br></pre></td></tr></table></figure>

<h4 id="6-2-Loop-Instruction"><a href="#6-2-Loop-Instruction" class="headerlink" title="6.2 Loop Instruction"></a>6.2 Loop Instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">	mov ax, 0</span><br><span class="line">	mov ecx, 5</span><br><span class="line">L1: add ax, cx</span><br><span class="line">	loop L1</span><br></pre></td></tr></table></figure>

<p>关注ecx寄存器，当其为0时退出</p>
<h4 id="6-3-Nested-Loop"><a href="#6-3-Nested-Loop" class="headerlink" title="6.3 Nested Loop"></a>6.3 Nested Loop</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">count DWORD ?</span><br><span class="line">.code</span><br><span class="line">	mov ecx, 100</span><br><span class="line">L1:</span><br><span class="line">	mov count, ecx</span><br><span class="line">	mov ecx, 20</span><br><span class="line">L2:	.</span><br><span class="line">	.</span><br><span class="line">	loop L2</span><br><span class="line">	mov ecx, count</span><br><span class="line">	loop L1</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第三天</title>
    <url>/2022/02/08/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day3/</url>
    <content><![CDATA[<h2 id="1-Stack-Operation"><a href="#1-Stack-Operation" class="headerlink" title="1. Stack Operation"></a>1. Stack Operation</h2><h4 id="1-1-Runtime-Stack"><a href="#1-1-Runtime-Stack" class="headerlink" title="1.1    Runtime Stack"></a>1.1    Runtime Stack</h4><ol>
<li>top的地址大于buttom的地址</li>
<li>受两个register管控，ss（stack segment）、esp（stack pointer）</li>
</ol>
<h4 id="1-2-Push-Operation"><a href="#1-2-Push-Operation" class="headerlink" title="1.2    Push Operation"></a>1.2    Push Operation</h4><p><a href="https://imgtu.com/i/H10nZ8"><img src="https://s4.ax1x.com/2022/02/08/H10nZ8.png" alt="H10nZ8.png"></a></p>
<p>减4，即4*8=32，再÷4=8，即剩余8位，正好32位。乘8是因为1byte=8bit</p>
<h4 id="1-3-Pop-Operation"><a href="#1-3-Pop-Operation" class="headerlink" title="1.3    Pop Operation"></a>1.3    Pop Operation</h4><p>add n to esp, 2 or 4 depends on the attribute of the operand</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push esi</span><br><span class="line">push ecx</span><br><span class="line">push ebx</span><br><span class="line"></span><br><span class="line">mov esi, OFFSET dwordVal	; display some memory</span><br><span class="line">mov ecx, LENGTHOF dwordVal</span><br><span class="line">mov ebx, TYPE dwordVal</span><br><span class="line">call DumpMem</span><br><span class="line"></span><br><span class="line">pop	ebx</span><br><span class="line">pop exc</span><br><span class="line">pop esi</span><br></pre></td></tr></table></figure>

<h2 id="2-defining-and-using-procedures"><a href="#2-defining-and-using-procedures" class="headerlink" title="2. defining and using procedures"></a>2. defining and using procedures</h2><h4 id="2-1-creating-procedure"><a href="#2-1-creating-procedure" class="headerlink" title="2.1    creating procedure"></a>2.1    creating procedure</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sample PROC</span><br><span class="line">	.</span><br><span class="line">	.</span><br><span class="line">	ret</span><br><span class="line">sample ENDP</span><br><span class="line"></span><br><span class="line">; EXAMPLE: SUM OF PROCEDURE</span><br><span class="line">SumOf PROC</span><br><span class="line">	add eax, ebx</span><br><span class="line">	add eax, ecx</span><br><span class="line">	ret</span><br><span class="line">SumOf ENDP</span><br><span class="line">COMMENT !</span><br><span class="line">    mov eax, 10</span><br><span class="line">    mov ebx, 20</span><br><span class="line">    mov ecx, 30</span><br><span class="line">    call SumOf</span><br><span class="line">    WriteDec</span><br><span class="line">!</span><br></pre></td></tr></table></figure>

<h4 id="2-2-Call-and-Ret-Instruction"><a href="#2-2-Call-and-Ret-Instruction" class="headerlink" title="2.2    Call and Ret Instruction"></a>2.2    Call and Ret Instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">main PROC</span><br><span class="line">	00000020 call MySub</span><br><span class="line">	00000025 mov eax, ebx</span><br><span class="line">	.</span><br><span class="line">	.</span><br><span class="line">main ENDP</span><br><span class="line">MySub PROC</span><br><span class="line">	00000040 mov eax, edx</span><br><span class="line">	.</span><br><span class="line">	.</span><br><span class="line">	ret</span><br><span class="line">MySub ENDP</span><br></pre></td></tr></table></figure>

<h4 id="2-3-USES-Operator"><a href="#2-3-USES-Operator" class="headerlink" title="2.3 USES Operator"></a>2.3 USES Operator</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ArraySum PROC</span><br><span class="line">	push esi</span><br><span class="line">	push ecx</span><br><span class="line">	.</span><br><span class="line">	.</span><br><span class="line">	pop ecx</span><br><span class="line">	pop esi</span><br><span class="line">	ret</span><br><span class="line">ArraySum ENDP</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/H1Im1x"><img src="https://s4.ax1x.com/2022/02/08/H1Im1x.png" alt="H1Im1x.png"></a></p>
<h2 id="3-linking-to-an-external-library"><a href="#3-linking-to-an-external-library" class="headerlink" title="3. linking to an external library"></a>3. linking to an external library</h2><p><a href="https://imgtu.com/i/H17fDf"><img src="https://s4.ax1x.com/2022/02/08/H17fDf.png" alt="H17fDf.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include Irvine32.inc</span><br><span class="line">.code</span><br><span class="line">	mov eax, 1234h</span><br><span class="line">	call WriteHex</span><br><span class="line">	call Crlf</span><br></pre></td></tr></table></figure>

<h2 id="4-64bit-assembly-programming"><a href="#4-64bit-assembly-programming" class="headerlink" title="4. 64bit assembly programming"></a>4. 64bit assembly programming</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ExitProcess PROTO</span><br><span class="line">WriteHex64 PROTO</span><br></pre></td></tr></table></figure>

<h2 id="5-boolean-and-comparison-instruction"><a href="#5-boolean-and-comparison-instruction" class="headerlink" title="5. boolean and comparison instruction"></a>5. boolean and comparison instruction</h2><p>AND, OR, XOR, NOT,</p>
<h4 id="5-1-Using-Bit-Mapped-Sets"><a href="#5-1-Using-Bit-Mapped-Sets" class="headerlink" title="5.1    Using Bit-Mapped Sets"></a>5.1    Using Bit-Mapped Sets</h4><p>like bit vectors</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; set complement</span><br><span class="line">mov eax, SetX</span><br><span class="line">not eax</span><br><span class="line">; set Intersection</span><br><span class="line">mov eax, SetX</span><br><span class="line">and eax, SetY</span><br><span class="line">; set Union</span><br><span class="line">mov eax, setX</span><br><span class="line">or eax, setY</span><br></pre></td></tr></table></figure>

<h4 id="5-2-Test-Instruction"><a href="#5-2-Test-Instruction" class="headerlink" title="5.2    Test Instruction"></a>5.2    Test Instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">test al, 00000011b</span><br><span class="line">jz ValueNotFound</span><br><span class="line">; neither bit0 and bit1 is set</span><br></pre></td></tr></table></figure>

<h4 id="5-3-CMP-Instruction"><a href="#5-3-CMP-Instruction" class="headerlink" title="5.3    CMP Instruction"></a>5.3    CMP Instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; nondestructive subtraction of source from destination</span><br><span class="line">mov al, 5</span><br><span class="line">cmp al, 5 ; zero flag is set</span><br><span class="line"></span><br><span class="line">mov al, 4</span><br><span class="line">cmp al, 5 ; carry flag is set</span><br></pre></td></tr></table></figure>

<h2 id="6-Conditional-Jumps"><a href="#6-Conditional-Jumps" class="headerlink" title="6. Conditional Jumps"></a>6. Conditional Jumps</h2><p>jumps based on specific flags, equality, unsigned comparisons, signed comparisons</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; JB, JC jumps to a label if carry flag is set</span><br><span class="line">; JE, JZ jumps to a label if zero flag is set</span><br><span class="line">; JS jumps to a label if sign flag is set</span><br><span class="line">; JNE, JNZ jump to a label if zero flag is clear</span><br><span class="line">; JECXZ jumps to a label if ECX equals to zero</span><br><span class="line">; Example BT Instruction</span><br><span class="line">; copy bit n to the carry flag</span><br><span class="line">; Task: jump to label L1 if bit 9 is set</span><br><span class="line"></span><br><span class="line">bt ax, 9</span><br><span class="line">jc L1</span><br></pre></td></tr></table></figure>

<h2 id="7-Conditional-Loop-Instruction"><a href="#7-Conditional-Loop-Instruction" class="headerlink" title="7. Conditional Loop Instruction"></a>7. Conditional Loop Instruction</h2><h4 id="LOOPZ-and-LOOPE"><a href="#LOOPZ-and-LOOPE" class="headerlink" title="LOOPZ and LOOPE"></a>LOOPZ and LOOPE</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; if ecx &gt; 0 and ZF = 1, jump to destination</span><br><span class="line">LOOPE destination</span><br><span class="line">LOOPZ destination</span><br><span class="line">; if ecx &gt; 0 and ZF = 0, jump to destination</span><br><span class="line">LOOPNE destination</span><br><span class="line">LOOPNZ destination</span><br><span class="line"></span><br><span class="line">; Example</span><br><span class="line">.data</span><br><span class="line">array SWORD -3,-6,-1,-10,10,30,4-,4</span><br><span class="line">sentinel SWORD 0</span><br><span class="line">.code</span><br><span class="line">	mov esi, OFFSET array</span><br><span class="line">	mov ecx, LENGTHOF array</span><br><span class="line">next:</span><br><span class="line">	test WORD PTR [esi], 8000h</span><br><span class="line">	pushfd</span><br><span class="line">	add esi, TYPE array</span><br><span class="line">	popfd</span><br><span class="line">	loopnz next</span><br><span class="line">	jecxz quit</span><br><span class="line">	sub esi, TYPE array</span><br><span class="line">quit:</span><br></pre></td></tr></table></figure>

<h2 id="8-Conditional-Structures"><a href="#8-Conditional-Structures" class="headerlink" title="8. Conditional Structures"></a>8. Conditional Structures</h2><h4 id="8-1-Block-Structured-IF-Statement"><a href="#8-1-Block-Structured-IF-Statement" class="headerlink" title="8.1    Block-Structured IF Statement"></a>8.1    Block-Structured IF Statement</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (op1 == op2)			</span><br><span class="line">	x = 1;					</span><br><span class="line">else						</span><br><span class="line">	x = 2;					</span><br><span class="line">.code</span><br><span class="line">	mov eax, op1</span><br><span class="line">	cmp eax, op2</span><br><span class="line">	jne L1</span><br><span class="line">	mov x, 1</span><br><span class="line">	jmp L2</span><br><span class="line">L1: mov x, 2</span><br><span class="line">L2:</span><br></pre></td></tr></table></figure>

<h4 id="8-2-Compound-Expression-with-AND"><a href="#8-2-Compound-Expression-with-AND" class="headerlink" title="8.2    Compound Expression with AND"></a>8.2    Compound Expression with AND</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (al &gt; bl) and (bl &gt; cl)</span><br><span class="line">	x = 1;</span><br><span class="line">; one implementation</span><br><span class="line">	cmp al, bl</span><br><span class="line">	ja L1</span><br><span class="line">	jmp next</span><br><span class="line">L1:</span><br><span class="line">	cmp bl, cl</span><br><span class="line">	ja L2</span><br><span class="line">	jmp next</span><br><span class="line">L2:</span><br><span class="line">	mov x, 1</span><br><span class="line">next:</span><br><span class="line"></span><br><span class="line">; the other implementation</span><br><span class="line">	cmp al, bl</span><br><span class="line">	jbe next</span><br><span class="line">	cmp bl, cl</span><br><span class="line">	jbe next</span><br><span class="line">	mov x, 1</span><br><span class="line">next:</span><br></pre></td></tr></table></figure>

<h2 id="9-Creating-IF-Statement"><a href="#9-Creating-IF-Statement" class="headerlink" title="9. Creating IF Statement"></a>9. Creating IF Statement</h2><h4 id="9-1-Runtime-Expression"><a href="#9-1-Runtime-Expression" class="headerlink" title="9.1    Runtime Expression"></a>9.1    Runtime Expression</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.if eax &gt; ebx &amp;&amp; eax &gt; ecx</span><br><span class="line">	mov edx, 1</span><br><span class="line">.else</span><br><span class="line">	mov edx, 2</span><br><span class="line">.endif</span><br><span class="line"></span><br><span class="line">; if 自动生成相反的命令jmp</span><br><span class="line">.data</span><br><span class="line">result DWORD ?</span><br><span class="line">.code</span><br><span class="line">mov ebx, 5</span><br><span class="line">mov eax, 6</span><br><span class="line">.if eax &gt; ebx</span><br><span class="line">	mov result, 1</span><br><span class="line">.endif</span><br><span class="line"></span><br><span class="line">	mov ebx, 5</span><br><span class="line">	mov eax, 6</span><br><span class="line">	cmp eax, ebx</span><br><span class="line">	jle @c0001</span><br><span class="line">	mov result, 1</span><br><span class="line">@c0001:</span><br><span class="line"></span><br><span class="line">; you can also prefix one of your register with the SDWORD PTR operator.</span><br></pre></td></tr></table></figure>

<h4 id="9-2-repeat-directive"><a href="#9-2-repeat-directive" class="headerlink" title="9.2    .repeat directive"></a>9.2    .repeat directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; Display integers 1 - 10</span><br><span class="line">mov eax, 0</span><br><span class="line">.repeat</span><br><span class="line">	inc eax</span><br><span class="line">	call WriteDec</span><br><span class="line">	call Crlf</span><br><span class="line">.until eax == 10</span><br></pre></td></tr></table></figure>

<h4 id="9-3-while-directive"><a href="#9-3-while-directive" class="headerlink" title="9.3    .while directive"></a>9.3    .while directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov eax, 0</span><br><span class="line">.while eax &lt; 10</span><br><span class="line">	inc eax</span><br><span class="line">	call WriteDec</span><br><span class="line">	call Crlf</span><br><span class="line">.endw</span><br></pre></td></tr></table></figure>















]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第Ⅹ天</title>
    <url>/2022/02/22/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day10/</url>
    <content><![CDATA[<h2 id="1-concept"><a href="#1-concept" class="headerlink" title="1. concept"></a>1. concept</h2><h4 id="1-1-Compilation"><a href="#1-1-Compilation" class="headerlink" title="1.1    Compilation"></a>1.1    Compilation</h4><p>translation from one language to simpler and more low-level one.</p>
<p>for example, C to assembly language.</p>
<span id="more"></span>

<h4 id="1-2-Compiler"><a href="#1-2-Compiler" class="headerlink" title="1.2    Compiler"></a>1.2    Compiler</h4><p>the program that does the translation is known as compiler.</p>
<h4 id="1-3-Preprocessor"><a href="#1-3-Preprocessor" class="headerlink" title="1.3    Preprocessor"></a>1.3    Preprocessor</h4><p>produce input to compilers and perform the following functions</p>
<p>Macro inclusion</p>
<p>File inclusion</p>
<p>Rational preprocessor</p>
<p>Language extension</p>
<h4 id="1-4-Assemblers"><a href="#1-4-Assemblers" class="headerlink" title="1.4    Assemblers"></a>1.4    Assemblers</h4><p>assembly code is passed to an assembler for further processing</p>
<p>Relation?</p>
<p>Assembly code is mnemonic version of machine code</p>
<p>names are used instead of binary codes for operations</p>
<p>names are also given to memory address.</p>
<h4 id="1-5-Loaders-and-Link-Editors"><a href="#1-5-Loaders-and-Link-Editors" class="headerlink" title="1.5    Loaders and Link-Editors"></a>1.5    Loaders and Link-Editors</h4><p><a href="https://imgtu.com/i/HvgTXj"><img src="https://s4.ax1x.com/2022/02/21/HvgTXj.png" alt="HvgTXj.png"></a></p>
<h4 id="1-6-编译程序和解释程序"><a href="#1-6-编译程序和解释程序" class="headerlink" title="1.6    编译程序和解释程序"></a>1.6    编译程序和解释程序</h4><p>编译程序先将程序翻译再执行，即先编译后运行，独立分开的过程。</p>
<p>解释程序接受某个语言的程序并立即运行，适合交互</p>
<h4 id="1-7-Syntax-Tree"><a href="#1-7-Syntax-Tree" class="headerlink" title="1.7    Syntax Tree"></a>1.7    Syntax Tree</h4><p>make Operations into a hierachical structure.</p>
<p><a href="https://imgtu.com/i/Hv2LKH"><img src="https://s4.ax1x.com/2022/02/21/Hv2LKH.png" alt="Hv2LKH.png"></a></p>
<h4 id="1-8-Symbol-Table"><a href="#1-8-Symbol-Table" class="headerlink" title="1.8    Symbol-Table"></a>1.8    Symbol-Table</h4><p>it’s a data-structure</p>
<p><a href="https://imgtu.com/i/HvhVZd"><img src="https://s4.ax1x.com/2022/02/21/HvhVZd.png" alt="HvhVZd.png"></a></p>
<h4 id="1-9-句型与句子"><a href="#1-9-句型与句子" class="headerlink" title="1.9    句型与句子"></a>1.9    句型与句子</h4><p>句型仅仅要求v -*&gt; w; 句子要求v -*&gt; w 且 w $\in V_T^*$ </p>
<p>因此，句子也是句型。</p>
]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第四天</title>
    <url>/2022/02/09/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day4/</url>
    <content><![CDATA[<h2 id="1-Shift-and-Rotate-Instruction"><a href="#1-Shift-and-Rotate-Instruction" class="headerlink" title="1. Shift and Rotate Instruction"></a>1. Shift and Rotate Instruction</h2><h4 id="1-1-Logical-Shift-vs-Arithmetic-Shifts"><a href="#1-1-Logical-Shift-vs-Arithmetic-Shifts" class="headerlink" title="1.1    Logical Shift vs Arithmetic Shifts"></a>1.1    Logical Shift vs Arithmetic Shifts</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; logical shift fills with 0</span><br><span class="line">; arithmetic shift fills with 1</span><br><span class="line"></span><br><span class="line">; SHL Instruction perform a logical left shift to fasten multiplication</span><br><span class="line">shl reg, imm8</span><br><span class="line">shl mem, imm8</span><br><span class="line">shl reg, cl</span><br><span class="line">shl mem, cl</span><br><span class="line"></span><br><span class="line">mov dl, 5</span><br><span class="line">shl dl, 2	; 5 * 2^2 = 20</span><br><span class="line"></span><br><span class="line">; SHR Instruction perform a logical right shift to fasten division</span><br><span class="line">mov dl, 80</span><br><span class="line">shr dl, 1</span><br><span class="line">shr dl, 2</span><br><span class="line"></span><br><span class="line">; SAL is identical to SHL</span><br><span class="line">; SAR perform a arithmetic shift</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/H8oazn"><img src="https://s4.ax1x.com/2022/02/09/H8oazn.png" alt="H8oazn.png"></a></p>
<h4 id="1-2-Rotation-Instruction"><a href="#1-2-Rotation-Instruction" class="headerlink" title="1.2    Rotation Instruction"></a>1.2    Rotation Instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; ROL Instruction no bits are lost</span><br><span class="line">; ROR Instruction is as above</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/H87D5F"><img src="https://s4.ax1x.com/2022/02/09/H87D5F.png" alt="H87D5F.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; RCL Instruction copy the most significant to CF and CF to least significant</span><br><span class="line">; RCR Instruction reverse the RCL Instruction</span><br></pre></td></tr></table></figure>

<h4 id="1-3-SHLD-Instruction-shift-left-double"><a href="#1-3-SHLD-Instruction-shift-left-double" class="headerlink" title="1.3    SHLD Instruction(shift left double)"></a>1.3    SHLD Instruction(shift left double)</h4><p><a href="https://imgtu.com/i/HGidSI"><img src="https://s4.ax1x.com/2022/02/09/HGidSI.png" alt="HGidSI.png"></a></p>
<p><a href="https://imgtu.com/i/HGiImT"><img src="https://s4.ax1x.com/2022/02/09/HGiImT.png" alt="HGiImT.png"></a></p>
<h4 id="1-4-SHRD-Instruction"><a href="#1-4-SHRD-Instruction" class="headerlink" title="1.4    SHRD Instruction"></a>1.4    SHRD Instruction</h4><p>just the reverse version of SHLD</p>
<h2 id="2-Multiplication-and-Division-Instruction"><a href="#2-Multiplication-and-Division-Instruction" class="headerlink" title="2. Multiplication and Division Instruction"></a>2. Multiplication and Division Instruction</h2><h4 id="2-1-MUL-Instruction"><a href="#2-1-MUL-Instruction" class="headerlink" title="2.1    MUL Instruction"></a>2.1    MUL Instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mul r/m8</span><br><span class="line">; mul instruction multiplies an 8-, 16-. 32-bit operand by either AL,AX,EAX</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/HGkRs0"><img src="https://s4.ax1x.com/2022/02/09/HGkRs0.png" alt="HGkRs0.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">val1 WORD 2000h</span><br><span class="line">val2 WORD 100h</span><br><span class="line">.code</span><br><span class="line">mov ax, val1</span><br><span class="line">mul val2	; DX:AX = 0020 0000h, CF = 1</span><br><span class="line"></span><br><span class="line">mov eax, 12345h</span><br><span class="line">mov ebx, 1000h</span><br><span class="line">mul ebx	; EDX:EAX = 00000000 12345000h, CF = 0 </span><br><span class="line">; CF indicates whether the upper half has significant digits</span><br></pre></td></tr></table></figure>

<h4 id="2-2-IMUL-Instruction"><a href="#2-2-IMUL-Instruction" class="headerlink" title="2.2    IMUL Instruction"></a>2.2    IMUL Instruction</h4><p><a href="https://imgtu.com/i/HGVFVf"><img src="https://s4.ax1x.com/2022/02/09/HGVFVf.png" alt="HGVFVf.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al, 48</span><br><span class="line">mov bl, 4</span><br><span class="line">imul bl ; AX = 00C0h, 0F = 1, because AH is not a sign extension of AL</span><br></pre></td></tr></table></figure>

<h4 id="2-3-DIV-Instruction"><a href="#2-3-DIV-Instruction" class="headerlink" title="2.3    DIV Instruction"></a>2.3    DIV Instruction</h4><p><a href="https://imgtu.com/i/HGZFyR"><img src="https://s4.ax1x.com/2022/02/09/HGZFyR.png" alt="HGZFyR.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov dx, 0000h ; clear dividend, high</span><br><span class="line">mov ax, 8003h</span><br><span class="line">mov cx, 100h</span><br><span class="line">div cx ; AX = 0080h, DX = 0003h</span><br><span class="line"></span><br><span class="line">.data</span><br><span class="line">dividend_hi QWORD 00000208h</span><br><span class="line">dividend_lo QWORD 33300020h</span><br><span class="line">divisor QWORD 00010000h</span><br><span class="line"></span><br><span class="line">.code</span><br><span class="line">mov rdx, dividend_hi</span><br><span class="line">mov rax, dividend_lo</span><br><span class="line">div divisor</span><br></pre></td></tr></table></figure>

<h4 id="2-4-Signed-Integer-Division"><a href="#2-4-Signed-Integer-Division" class="headerlink" title="2.4    Signed Integer Division"></a>2.4    Signed Integer Division</h4><p><a href="https://imgtu.com/i/HGuzRS"><img src="https://s4.ax1x.com/2022/02/09/HGuzRS.png" alt="HGuzRS.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; CBW, CWD, CDQ Instructions</span><br><span class="line">; CBW extends AL to AH</span><br><span class="line">; CWD extends AX to DX</span><br><span class="line">; CDQ extends eax to edx</span><br><span class="line"></span><br><span class="line">mov eax, 0FFFFFF9B</span><br><span class="line">cdq		; EDX:EAX = FFFFFFFFFFFFFF9Bh</span><br><span class="line"></span><br><span class="line">; example</span><br><span class="line">mov al, -48</span><br><span class="line">cbw</span><br><span class="line">mov bl, 5</span><br><span class="line">idiv bl</span><br></pre></td></tr></table></figure>

<h2 id="3-Extended-Addition-and-Subtraction"><a href="#3-Extended-Addition-and-Subtraction" class="headerlink" title="3. Extended Addition and Subtraction"></a>3. Extended Addition and Subtraction</h2><h4 id="3-1-adc-instruction"><a href="#3-1-adc-instruction" class="headerlink" title="3.1    adc instruction"></a>3.1    adc instruction</h4><h4 id="3-2-extended-precision-addition"><a href="#3-2-extended-precision-addition" class="headerlink" title="3.2    extended precision addition"></a>3.2    extended precision addition</h4><h4 id="3-3-sbb-instruction"><a href="#3-3-sbb-instruction" class="headerlink" title="3.3    sbb instruction"></a>3.3    sbb instruction</h4><h4 id="3-4-extended-precision-subtraction"><a href="#3-4-extended-precision-subtraction" class="headerlink" title="3.4    extended precision subtraction"></a>3.4    extended precision subtraction</h4><h2 id="4-Multimodule-Programs"><a href="#4-Multimodule-Programs" class="headerlink" title="4. Multimodule Programs"></a>4. Multimodule Programs</h2><p>source code has been divided up into separate ASM files</p>
<p>each ASM file is assembled into a separate OBJ file</p>
<p>all OBJ files belonging to the same program are linked using the link utility into a single exe</p>
<p>this process is called static linking</p>
<h2 id="5-Stack-Frames"><a href="#5-Stack-Frames" class="headerlink" title="5. Stack Frames"></a>5. Stack Frames</h2><p>also known as an activation record(活动记录)</p>
<p>created by the following steps:</p>
<ol>
<li><p>call program pushed arguments on the stack and calls the procedure</p>
</li>
<li><p>the called procedure pushed ebp on the stack, and set ebp to esp</p>
</li>
<li><p>if local var are needed, a constant is subtracted from ESP to make room on the stack</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pushad</span><br><span class="line">mov esi, OFFSET array</span><br><span class="line">mov ecx, LENGTHOF array</span><br><span class="line">mov ebx, TYPE array</span><br><span class="line">call DumpMem</span><br><span class="line">popad</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/HJFbwT"><img src="https://s4.ax1x.com/2022/02/09/HJFbwT.png" alt="HJFbwT.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; C Call: caller releases stack</span><br><span class="line">AddTwo_C PROC</span><br><span class="line">	push ebp</span><br><span class="line">	mov ebp, esp</span><br><span class="line">	mov eax, [ebp + 12]</span><br><span class="line">	add eax, [ebp + 8]</span><br><span class="line">	pop ebp</span><br><span class="line">	ret</span><br><span class="line">AddTwo_C ENDP</span><br><span class="line"></span><br><span class="line">_Example1 PROC</span><br><span class="line">	push 6</span><br><span class="line">	push 5</span><br><span class="line">	call AddTwo_C</span><br><span class="line">	add esp, 8</span><br><span class="line">	call DumpRegs</span><br><span class="line">	ret</span><br><span class="line">_Example1 ENDP</span><br><span class="line">; STDCall: procedure releases stack</span><br><span class="line">AddTwo PROC</span><br><span class="line">	push ebp</span><br><span class="line">	mov ebp, esp</span><br><span class="line">	mov eax, [ebp + 12]</span><br><span class="line">	add eax, [ebp + 8]</span><br><span class="line">	pop ebp</span><br><span class="line">	ret 8</span><br><span class="line">AddTwo ENDP</span><br><span class="line">_Example2 PROC</span><br><span class="line">	push 6</span><br><span class="line">	push 5</span><br><span class="line">	call AddTwo</span><br><span class="line">	call DumpRegs</span><br><span class="line">	ret</span><br><span class="line">_Example2 ENDP</span><br></pre></td></tr></table></figure>

<h4 id="5-1-Local-Variables"><a href="#5-1-Local-Variables" class="headerlink" title="5.1. Local Variables"></a>5.1. Local Variables</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void MySub()&#123;</span><br><span class="line">	int X = 10;</span><br><span class="line">	int Y = 20;</span><br><span class="line">&#125;</span><br><span class="line">;	LocalVars.asm</span><br><span class="line">MySub PROC</span><br><span class="line">	push ebp</span><br><span class="line">	mov ebp, esp</span><br><span class="line">	sub esp, 8</span><br><span class="line">	mov DWORD PTR [ebp - 4], 10</span><br><span class="line">	mov DWORD PTR [ebp - 8], 20</span><br><span class="line">	; Do Something</span><br><span class="line">	mov esp, ebp	; remove local vars</span><br><span class="line">	pop ebp</span><br><span class="line">MySub ENDP</span><br></pre></td></tr></table></figure>

<h4 id="5-2-ENTER-and-LEAVE"><a href="#5-2-ENTER-and-LEAVE" class="headerlink" title="5.2. ENTER and LEAVE"></a>5.2. ENTER and LEAVE</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; ENTER Instruction</span><br><span class="line">; push ebp on the stack						push ebp</span><br><span class="line">; steps ebp to the base of stack frame		mov ebp, esp</span><br><span class="line">; reserves space for local variables		sub esp, n</span><br><span class="line">; syntax: ENTER numBytesReserverd, nestingLevel</span><br><span class="line"></span><br><span class="line">; LEAVE instruction</span><br><span class="line">; restores esp to release local variables	mov esp, ebp</span><br><span class="line">; pops ebp for the caller					pop ebp</span><br><span class="line"></span><br><span class="line">MySub PROC</span><br><span class="line">	enter 8,0</span><br><span class="line">	;push ebp</span><br><span class="line">	;mov ebp, esp</span><br><span class="line">	;sub esp,8</span><br><span class="line">	...</span><br><span class="line">	...</span><br><span class="line">	leave</span><br><span class="line">	;mov esp,ebp</span><br><span class="line">	;pop ebp</span><br><span class="line">	ret</span><br><span class="line">MySub ENDP</span><br></pre></td></tr></table></figure>

<h4 id="5-3-LOCAL-Directive"><a href="#5-3-LOCAL-Directive" class="headerlink" title="5.3. LOCAL Directive"></a>5.3. LOCAL Directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MySub PROC</span><br><span class="line">	LOCAL var1:BYTE, var2:WORD, var3:SDWORD</span><br><span class="line">	LOCAL flagVals[20]:BYTE</span><br><span class="line">	LOCAL pArray:PTR WORD</span><br><span class="line">	LOCAL t1:BYTE</span><br><span class="line">MySub ENDP</span><br><span class="line">BubbleSort PROC</span><br><span class="line">	LOCAL temp:DWORD, SwapFlag:BYTE</span><br><span class="line">	...</span><br><span class="line">	ret</span><br><span class="line">BubbleSort ENDP</span><br><span class="line">; masm generates</span><br><span class="line">BubbleSort PROC</span><br><span class="line">	push ebp</span><br><span class="line">	mov ebp, esp</span><br><span class="line">	add esp, 0FFFFFFF8h		; add -8 to ESP</span><br><span class="line">	...</span><br><span class="line">	mov esp, ebp</span><br><span class="line">	pop ebp</span><br><span class="line">	ret</span><br><span class="line">BubbleSort ENDP</span><br></pre></td></tr></table></figure>

<h4 id="5-4-LEA-Instruction"><a href="#5-4-LEA-Instruction" class="headerlink" title="5.4. LEA Instruction"></a>5.4. LEA Instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; compared to OFFSET, LEA returns offsets of direct and indirect operands</span><br><span class="line">CopyString PROC</span><br><span class="line">	count:DWORD</span><br><span class="line">	LOCAL temp[20]:BYTE</span><br><span class="line">	</span><br><span class="line">	mov edi, OFFSET count			; invalid</span><br><span class="line">	mov esi, OFFSET temp			; invalid</span><br><span class="line">	lea edi, count					; ok</span><br><span class="line">	lea esi, temp					; ok</span><br><span class="line">	</span><br><span class="line">	lea esi, [ebp - 8]</span><br></pre></td></tr></table></figure>

<h2 id="6-Invoke-Addr-PROC-PROTO"><a href="#6-Invoke-Addr-PROC-PROTO" class="headerlink" title="6. Invoke, Addr, PROC, PROTO"></a>6. Invoke, Addr, PROC, PROTO</h2><h4 id="6-1-INVOKE-Directive"><a href="#6-1-INVOKE-Directive" class="headerlink" title="6.1    INVOKE Directive"></a>6.1    INVOKE Directive</h4><p>not in 64bit model</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; syntax:  INVOKE precedureName, [, argumentList]</span><br><span class="line">; arguments can be:</span><br><span class="line">; immediate values and integer expressions</span><br><span class="line">; var names</span><br><span class="line">; address and ADDR expression</span><br><span class="line">; register names</span><br><span class="line">.data</span><br><span class="line">byteVal BYTE 10</span><br><span class="line">wordVal WORD 1000h</span><br><span class="line">.code</span><br><span class="line">	invoke Sub1, byteVal, wordVal</span><br><span class="line">	invoke Sub2, ADDR byteVal</span><br><span class="line">	invoke Sub3, eax, (10 * 20)</span><br><span class="line">	invoke Sub4, [ebx]</span><br></pre></td></tr></table></figure>

<h4 id="6-2-ADDR-Operator"><a href="#6-2-ADDR-Operator" class="headerlink" title="6.2    ADDR Operator"></a>6.2    ADDR Operator</h4><p>not in 64bit model</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">myWord WORD ?</span><br><span class="line">.code</span><br><span class="line">	invoke mySub, ADDR myWord</span><br></pre></td></tr></table></figure>

<h4 id="6-3-PROC-Directive"><a href="#6-3-PROC-Directive" class="headerlink" title="6.3    PROC Directive"></a>6.3    PROC Directive</h4><p>not in 64bit model</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">label PROC [attributes][USES regList], paramList</span><br><span class="line">AddTWo PROC</span><br><span class="line">	val1:DWORD, val2:DWORD</span><br><span class="line">	</span><br><span class="line">	mov eax, val1</span><br><span class="line">	add eax, val2</span><br><span class="line">	ret</span><br><span class="line">AddTwo ENDP</span><br><span class="line">; example</span><br><span class="line">MySub PROTO</span><br><span class="line">.code</span><br><span class="line">invoke mySub</span><br><span class="line"></span><br><span class="line">MySub PROC</span><br><span class="line">	.</span><br><span class="line">MySub ENDP</span><br><span class="line"></span><br><span class="line">; example</span><br><span class="line">ArraySum PROTO</span><br><span class="line">	ptrArray:PTR DWORD</span><br><span class="line">	szArray:DWORD</span><br></pre></td></tr></table></figure>

<h2 id="7-Multimodule-Programs"><a href="#7-Multimodule-Programs" class="headerlink" title="7. Multimodule Programs"></a>7. Multimodule Programs</h2><h4 id="7-1-Creating-a-multimodule-program"><a href="#7-1-Creating-a-multimodule-program" class="headerlink" title="7.1 Creating a multimodule program"></a>7.1 Creating a multimodule program</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; 1. create the main module</span><br><span class="line">; 2. create a separate source code module for each procedure or set of related procedure</span><br><span class="line">; 3. create an include file that contains procedure prototypes for external procedures</span><br><span class="line">; 4. use the include directive to make your procedure prototypes available to each module</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第六天</title>
    <url>/2022/02/13/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day6/</url>
    <content><![CDATA[<h2 id="1-Conditional-Assembly-Directives"><a href="#1-Conditional-Assembly-Directives" class="headerlink" title="1. Conditional-Assembly Directives"></a>1. Conditional-Assembly Directives</h2><h4 id="1-1-Checking-for-Missing-Arguments"><a href="#1-1-Checking-for-Missing-Arguments" class="headerlink" title="1.1    Checking for Missing Arguments"></a>1.1    Checking for Missing Arguments</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; IFB directive returns true if its argument is blank</span><br><span class="line">IFB &lt;row&gt;</span><br><span class="line">	EXITM</span><br><span class="line">ENDIF</span><br><span class="line"></span><br><span class="line">; example</span><br><span class="line">mWriteStr MACRO string</span><br><span class="line">	IFB &lt;string&gt;</span><br><span class="line">		ECHO -----------------------------</span><br><span class="line">		ECHO * Error: parameter missing in mWriteStr</span><br><span class="line">		ECHO * (no code generated)</span><br><span class="line">		ECHO -----------------------------</span><br><span class="line">		EXITM</span><br><span class="line">	ENDIF</span><br><span class="line">	push edx</span><br><span class="line">	mov edx, OFFSET string</span><br><span class="line">	call WriteString</span><br><span class="line">	pop edx</span><br><span class="line">ENDM</span><br></pre></td></tr></table></figure>

<h4 id="1-2-Default-Argument-Initializers"><a href="#1-2-Default-Argument-Initializers" class="headerlink" title="1.2    Default Argument Initializers"></a>1.2    Default Argument Initializers</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mWriteLn MACRO text:=&lt;&quot; &quot;&gt;</span><br><span class="line">	mWrite text</span><br><span class="line">	call Crlf</span><br><span class="line">ENDM</span><br><span class="line">.code</span><br><span class="line">mWriteLn &quot;line one&quot;</span><br><span class="line">mWriteLn</span><br><span class="line">mWriteLn &quot;line three&quot;</span><br></pre></td></tr></table></figure>

<h4 id="1-3-Boolean-Expressions"><a href="#1-3-Boolean-Expressions" class="headerlink" title="1.3    Boolean Expressions"></a>1.3    Boolean Expressions</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; LT - less than</span><br><span class="line">; GT - greater than</span><br><span class="line">; EQ - equal to</span><br><span class="line">; NE - not equal to</span><br><span class="line">; LE - less than or equal</span><br><span class="line">; GE - Greater than or equal to</span><br></pre></td></tr></table></figure>

<h4 id="1-4-IF-ELSE-and-ENDIF-Directives"><a href="#1-4-IF-ELSE-and-ENDIF-Directives" class="headerlink" title="1.4    IF, ELSE and ENDIF Directives"></a>1.4    IF, ELSE and ENDIF Directives</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IF boolean-expression</span><br><span class="line">	statements</span><br><span class="line">[ELSE</span><br><span class="line">	statements]</span><br><span class="line">ENDIF</span><br><span class="line"></span><br><span class="line">IF RealMode EQ 1</span><br><span class="line">	mov ax, @data</span><br><span class="line">	mov ds, ax</span><br><span class="line">ENDIF</span><br><span class="line">; RealMode can be defined in following ways:</span><br><span class="line">RealMode = 1</span><br><span class="line">RealMode EQU 1</span><br><span class="line">RealMode TEXTEQU 1</span><br></pre></td></tr></table></figure>

<h4 id="1-5-IFIDN-and-IFIDNI-Directive"><a href="#1-5-IFIDN-and-IFIDNI-Directive" class="headerlink" title="1.5    IFIDN and IFIDNI Directive"></a>1.5    IFIDN and IFIDNI Directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IFIDNI &lt;symbol&gt;, &lt;symbol&gt;</span><br><span class="line">	statements</span><br><span class="line">ENDIF</span><br><span class="line">; example</span><br><span class="line">mReadBuf MACRO bufferPtr, maxChars</span><br><span class="line">	IFIDNI &lt;maxChars&gt;, &lt;EDX&gt;</span><br><span class="line">		ECHO Warning: Second argument cannot be EDX</span><br><span class="line">		ECHO **************************************</span><br><span class="line">		EXITM</span><br><span class="line">	ENDIF</span><br><span class="line">ENDM</span><br></pre></td></tr></table></figure>

<h4 id="1-6-Special-Operators"><a href="#1-6-Special-Operators" class="headerlink" title="1.6    Special Operators"></a>1.6    Special Operators</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; substitution &amp; operator resolves ambiguous reference</span><br><span class="line">; expansion % operator converts constant expression into text representation</span><br><span class="line">; literal-text &lt;&gt; operator groups one or two characters</span><br><span class="line">; literal-character ! operator forces the preprocessor to treat a predefined operator as an ordinary character</span><br><span class="line"></span><br><span class="line">ShowRegister MACRO regName</span><br><span class="line">.data</span><br><span class="line">	tempStr BYTE &quot; &amp;regName=&quot;, 0</span><br><span class="line">	.</span><br><span class="line">	.</span><br><span class="line">.code</span><br><span class="line">ShowRegister EDX</span><br><span class="line"></span><br><span class="line">mGotoXY %(5 * 10),%(3 + 4)</span><br><span class="line">The preprocessor generates the following code:</span><br><span class="line">push edx</span><br><span class="line">mov dl, 50</span><br><span class="line">mov dh, 7</span><br><span class="line">call Gotoxy</span><br><span class="line">pop edx</span><br><span class="line"></span><br><span class="line">mWrite &quot;Line three&quot;, 0dh, 0ah	; passes three arguments</span><br><span class="line">mWrite &lt;&quot;Line three&quot;, 0dh, 0ah&gt;	; passes a single argument</span><br><span class="line"></span><br><span class="line">BadYValue	TEXTEQU Warning: &lt;Y-coordinate is &gt; 24 &gt; ; ends when first &gt;</span><br><span class="line">BadYValue	TEXTEQU Warning: &lt;Y-coordinate is !&gt; 24 &gt; ; continues</span><br></pre></td></tr></table></figure>

<h4 id="1-7-Macro-Function"><a href="#1-7-Macro-Function" class="headerlink" title="1.7    Macro Function"></a>1.7    Macro Function</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IsDefined MACRO symbol</span><br><span class="line">	IFDEF symbol</span><br><span class="line">		EXITM &lt;-1&gt;</span><br><span class="line">	ELSE</span><br><span class="line">		EXITM &lt;0&gt;</span><br><span class="line">	ENDIF</span><br><span class="line">ENDM</span><br><span class="line"></span><br><span class="line">IF IsDefined( RealMode )</span><br><span class="line">	mov ax, @data</span><br><span class="line">	mov ds, ax</span><br><span class="line">ENDIF</span><br></pre></td></tr></table></figure>

<h2 id="2-Defining-Repeat-Blocks"><a href="#2-Defining-Repeat-Blocks" class="headerlink" title="2. Defining Repeat Blocks"></a>2. Defining Repeat Blocks</h2><h4 id="2-1-WHILE-Directive"><a href="#2-1-WHILE-Directive" class="headerlink" title="2.1    WHILE Directive"></a>2.1    WHILE Directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WHILE constExpression</span><br><span class="line">	statements</span><br><span class="line">ENDM</span><br><span class="line">.data</span><br><span class="line">val1 = 1</span><br><span class="line">val2 = 1</span><br><span class="line">DWORD val1</span><br><span class="line">DWORD val2</span><br><span class="line">val3 = val1 + val2</span><br><span class="line"></span><br><span class="line">WHILE val3 LT 0F0000000h</span><br><span class="line">	DWORD val3</span><br><span class="line">	val1 = val2</span><br><span class="line">	val2 = val3</span><br><span class="line">	val3 = val1 + val2</span><br><span class="line">ENDM</span><br></pre></td></tr></table></figure>

<h4 id="2-2-REPEAT-Directive"><a href="#2-2-REPEAT-Directive" class="headerlink" title="2.2    REPEAT Directive"></a>2.2    REPEAT Directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">REPEAT constExpression</span><br><span class="line">	statements</span><br><span class="line">ENDM</span><br><span class="line"></span><br><span class="line">iVal = 10</span><br><span class="line">REPEAT 100</span><br><span class="line">	DWORD iVal</span><br><span class="line">	iVal = iVal + 10</span><br><span class="line">ENDM</span><br></pre></td></tr></table></figure>

<h4 id="2-3-FOR-Directive"><a href="#2-3-FOR-Directive" class="headerlink" title="2.3    FOR Directive"></a>2.3    FOR Directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FOR parameter, &lt;arg1, arg2, arg3&gt;</span><br><span class="line">	statements</span><br><span class="line">ENDM</span><br><span class="line"></span><br><span class="line">Window STRUCT</span><br><span class="line">	FOR color, &lt;frame, titlebar, background, foreground&gt;</span><br><span class="line">		color DWORD ?</span><br><span class="line">	ENDM</span><br><span class="line">Window ENDS</span><br><span class="line">; generated code:</span><br><span class="line">Window STRUCT</span><br><span class="line">	frame DWORD ?</span><br><span class="line">	titlebar DWORD ?</span><br><span class="line">	background DWORD ?</span><br><span class="line">	foreground DWORD ?</span><br><span class="line">Window ENDS</span><br></pre></td></tr></table></figure>

<h4 id="2-4-FORC-Directive"><a href="#2-4-FORC-Directive" class="headerlink" title="2.4    FORC Directive"></a>2.4    FORC Directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FORC parameter, &lt;string&gt;</span><br><span class="line">	statements</span><br><span class="line">ENDM</span><br><span class="line"></span><br><span class="line">FORC code, &lt;ABCDEFG&gt;</span><br><span class="line">	Group_&amp;code WORD ?</span><br><span class="line">ENDM</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第五天</title>
    <url>/2022/02/11/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day5/</url>
    <content><![CDATA[<h2 id="1-String-Primitive-Instruction"><a href="#1-String-Primitive-Instruction" class="headerlink" title="1. String Primitive Instruction"></a>1. String Primitive Instruction</h2><h4 id="1-1-MOVSB-MOVSW-MOVSD"><a href="#1-1-MOVSB-MOVSW-MOVSD" class="headerlink" title="1.1.    MOVSB, MOVSW, MOVSD"></a>1.1.    MOVSB, MOVSW, MOVSD</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; copy data from [esi] to [edi]</span><br><span class="line">.data</span><br><span class="line">source DWORD 0FFFFFFFFh</span><br><span class="line">target DWORD ?</span><br><span class="line">.code</span><br><span class="line">mov esi, OFFSET source</span><br><span class="line">mov edi, OFFSET target</span><br><span class="line">movsd</span><br><span class="line">; esi and edi are automatically inc or dec depending on B,W,D</span><br><span class="line"></span><br><span class="line">; Direction Flag</span><br><span class="line">; DF = 0, inc esi and edi</span><br><span class="line">; DF = 1, dec esi and edi</span><br><span class="line">; that can be explicitly changed by cld and std</span><br><span class="line"></span><br><span class="line">; Using a Repeat Prefix</span><br><span class="line">.data</span><br><span class="line">source DWORD 20 DUP(&#x27;z&#x27;)</span><br><span class="line">target DWORD 20 DUP(?)</span><br><span class="line">.code</span><br><span class="line">cld</span><br><span class="line">mov ecx, LENGTHOF source</span><br><span class="line">mov esi, OFFSET source</span><br><span class="line">mov edi, OFFSET target</span><br><span class="line">rep movsw</span><br><span class="line">; wait till ecx == 0</span><br></pre></td></tr></table></figure>

<h4 id="1-2-CMPSB-CMPSW-CMPSD"><a href="#1-2-CMPSB-CMPSW-CMPSD" class="headerlink" title="1.2.    CMPSB, CMPSW, CMPSD"></a>1.2.    CMPSB, CMPSW, CMPSD</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; compare data from [esi] to [edi]</span><br><span class="line">; repeat prefix often used: repe(repz), repne(repnz)</span><br><span class="line">.data</span><br><span class="line">source DWORD 1234h</span><br><span class="line">target DWORD 5678h</span><br><span class="line">.code</span><br><span class="line">mov esi, OFFSET source</span><br><span class="line">mov edi, OFFSET target</span><br><span class="line">CMPSD</span><br><span class="line">ja L1</span><br><span class="line">jmp L2</span><br><span class="line"></span><br><span class="line">; repeat</span><br><span class="line">.data</span><br><span class="line">source DWORD COUNT DUP(?)</span><br><span class="line">target DWORD COUNT DUP(?)</span><br><span class="line">.code</span><br><span class="line">mov ecx, COUNT</span><br><span class="line">mov esi, OFFSET source</span><br><span class="line">mov edi, OFFSET target</span><br><span class="line">cld</span><br><span class="line">repe cmpsd</span><br></pre></td></tr></table></figure>

<h4 id="1-3-SCASB-SCASW-SCASD"><a href="#1-3-SCASB-SCASW-SCASD" class="headerlink" title="1.3.    SCASB, SCASW, SCASD"></a>1.3.    SCASB, SCASW, SCASD</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; compare a value in AL/AX/EAX to [edi]</span><br><span class="line">.data</span><br><span class="line">alpha BYTE &quot;ABCDEFGH&quot;, 0</span><br><span class="line">.code</span><br><span class="line">mov edi, OFFSET alpha</span><br><span class="line">mov al, &#x27;F&#x27;</span><br><span class="line">mov ecx, LENGTHOF alpha</span><br><span class="line">cld</span><br><span class="line">repne scasb</span><br><span class="line">jnz quit</span><br><span class="line">dec edi</span><br></pre></td></tr></table></figure>

<h4 id="1-4-STOSB-STOSW-STOSD"><a href="#1-4-STOSB-STOSW-STOSD" class="headerlink" title="1.4.    STOSB, STOSW, STOSD"></a>1.4.    STOSB, STOSW, STOSD</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; store content of al/ax/eax to [edi]</span><br><span class="line">.data</span><br><span class="line">Count = 100</span><br><span class="line">string1 BYTE Count DUP(?)</span><br><span class="line">.code</span><br><span class="line">mov al, OFFh</span><br><span class="line">mov edi, OFFSET string1</span><br><span class="line">mov ecx, Count</span><br><span class="line">cld</span><br><span class="line">rep stosb</span><br></pre></td></tr></table></figure>

<h4 id="1-5-LODSB-LODSW-LODSD"><a href="#1-5-LODSB-LODSW-LODSD" class="headerlink" title="1.5.    LODSB, LODSW, LODSD"></a>1.5.    LODSB, LODSW, LODSD</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; load from [esi] to al/ax/eax</span><br><span class="line">.data</span><br><span class="line">array BYTE 1,2,3,4,5,6,7,8,9</span><br><span class="line">.code</span><br><span class="line">	mov esi, OFFSET array</span><br><span class="line">	mov ecx, LENGTHOF array</span><br><span class="line">	cld</span><br><span class="line">L1:	lodsb</span><br><span class="line">	or al, 30h</span><br><span class="line">	call WriteChar</span><br><span class="line">	loop L1</span><br></pre></td></tr></table></figure>

<h2 id="2-Selected-String-Procedures"><a href="#2-Selected-String-Procedures" class="headerlink" title="2. Selected String Procedures"></a>2. Selected String Procedures</h2><h4 id="2-1-Two-Dimensional-Arrays"><a href="#2-1-Two-Dimensional-Arrays" class="headerlink" title="2.1 Two-Dimensional Arrays"></a>2.1 Two-Dimensional Arrays</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; Structure Application</span><br><span class="line">COORD STRUCT</span><br><span class="line">	X WORD ?</span><br><span class="line">	Y WORD ?</span><br><span class="line">COORD ENDS</span><br><span class="line">.data</span><br><span class="line">setOfCoordinates COORD 10 DUP(&lt;&gt;)</span><br><span class="line">.code</span><br><span class="line">	mov ebx, OFFSET setOfCoordinates</span><br><span class="line">	mov esi, 2</span><br><span class="line">	mov eax, 0</span><br><span class="line">	mov ecx, LENGTHOF setOfCoordinates</span><br><span class="line">L1: mov ax, [ebx + esi]</span><br><span class="line">	call WriteDec</span><br><span class="line">	add ebx, SIZEOF COORD</span><br><span class="line">	loop L1</span><br><span class="line">; common formats</span><br><span class="line">;	[base + index + displacement]</span><br><span class="line">;	displacement[base + index]</span><br><span class="line">table BYTE 10h, 20h, 30h, 40h, 50h</span><br><span class="line">	  BYTE 60h, 70h, 80h, 90h, 0A0h</span><br><span class="line">	  BYTE 0B0h, 0C0h, 0D0h, 0E0h, 0F0h</span><br><span class="line">NumCols = 5</span><br><span class="line">; alternate formats</span><br><span class="line">table BYTE 10h, 20h, 30h, 40h, 50h, 60h, 70h, 80h, 90h, 0A0h, OB0h, 0C0h, 0D0h, 0E0h, 0F0h</span><br><span class="line">NumCols = 5</span><br><span class="line"></span><br><span class="line">RowNumber = 1</span><br><span class="line">ColumnNumber = 2</span><br><span class="line"></span><br><span class="line">mov ebx, NumCols * RowNumber</span><br><span class="line">mov esi, ColumnNumber</span><br><span class="line">mov al, table[ebx + esi]</span><br></pre></td></tr></table></figure>

<h4 id="2-2-Searching-and-Sorting-Integer-Arrays"><a href="#2-2-Searching-and-Sorting-Integer-Arrays" class="headerlink" title="2.2.    Searching and Sorting Integer Arrays"></a>2.2.    Searching and Sorting Integer Arrays</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; pseudocode</span><br><span class="line">cx1 = N - 1</span><br><span class="line">while(cx1 &gt; 0)&#123;</span><br><span class="line">	esi = addr(array)</span><br><span class="line">	cx2 = cx1</span><br><span class="line">	while(cx2 &gt; 0)&#123;</span><br><span class="line">		if(array[esi] &lt; array[esi + 4])&#123;</span><br><span class="line">			exchange(array[esi], array[esi + 4])</span><br><span class="line">		&#125;</span><br><span class="line">		add esi, 4</span><br><span class="line">		dec cx2</span><br><span class="line">	&#125;</span><br><span class="line">	dec cx2</span><br><span class="line">&#125;</span><br><span class="line">; assembly code</span><br><span class="line">BubbleSort PROC USES eax, ecx, esi, pArray:PTR DWORD, Count:DWORD</span><br><span class="line">	mov ecx, Count</span><br><span class="line">	dec ecx</span><br><span class="line">L1:</span><br><span class="line">	push ecx</span><br><span class="line">	mov esi, pArray</span><br><span class="line">L2:</span><br><span class="line">	mov eax, [esi]</span><br><span class="line">	cmp [esi + 4], eax</span><br><span class="line">	jge L3</span><br><span class="line">	xchg eax, [esi + 4]</span><br><span class="line">	mov [esi], eax</span><br><span class="line">L3:</span><br><span class="line">	add esi, 4</span><br><span class="line">	loop L2</span><br><span class="line">	pop ecx</span><br><span class="line">	loop L1</span><br><span class="line">L4:</span><br><span class="line">	ret</span><br><span class="line">BubbleSort ENDP</span><br></pre></td></tr></table></figure>

<h2 id="3-Structure"><a href="#3-Structure" class="headerlink" title="3. Structure"></a>3. Structure</h2><h4 id="3-1-Structure-Definition-Syntax"><a href="#3-1-Structure-Definition-Syntax" class="headerlink" title="3.1    Structure Definition Syntax"></a>3.1    Structure Definition Syntax</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name STRUCT</span><br><span class="line">	field-declarations</span><br><span class="line">name ENDS</span><br><span class="line"></span><br><span class="line">Employee STRUCT</span><br><span class="line">	IdNum BYTE &quot;000000000&quot;</span><br><span class="line">	LastName BYTE 30 DUP(0)</span><br><span class="line">	Years WORD 0</span><br><span class="line">	SalaryHistory DWORD 0,0,0,0</span><br><span class="line">Employee ENDS</span><br></pre></td></tr></table></figure>

<h4 id="3-2-Declaring-Structure-Variables"><a href="#3-2-Declaring-Structure-Variables" class="headerlink" title="3.2    Declaring Structure Variables"></a>3.2    Declaring Structure Variables</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">point1 COORD &lt;5,10&gt;</span><br><span class="line">point2 COORD &lt;&gt;</span><br><span class="line">worker Employee &lt;&gt;</span><br><span class="line"></span><br><span class="line">; initializing Array Fields</span><br><span class="line">.data</span><br><span class="line">emp Employee &lt;,,,2 DUP(20000)&gt;</span><br></pre></td></tr></table></figure>

<h4 id="3-3-Array-of-Structure"><a href="#3-3-Array-of-Structure" class="headerlink" title="3.3    Array of Structure"></a>3.3    Array of Structure</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NumPoints = 3</span><br><span class="line">AllPoints COORD NumPoints DUP(&lt;0,0&gt;)</span><br><span class="line"></span><br><span class="line">RD_Dept Employee 20 DUP(&lt;&gt;)</span><br><span class="line"></span><br><span class="line">accounting Employee 10 DUP(&lt;,,,4 DUP(20000)&gt;)</span><br></pre></td></tr></table></figure>

<h4 id="3-4-Reference-Structure-Variables"><a href="#3-4-Reference-Structure-Variables" class="headerlink" title="3.4    Reference Structure Variables"></a>3.4    Reference Structure Variables</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Employee STRUCT								; BYTES</span><br><span class="line">	IdNum BYTE &quot;000000000&quot;					; 9</span><br><span class="line">	LastName BYTE 30 DUP(0)					; 30</span><br><span class="line">	Years WORD 0							; 2</span><br><span class="line">	SalaryHistory DWORD 0,0,0,0				; 16</span><br><span class="line">Employee ENDS								; 57</span><br><span class="line">.data</span><br><span class="line">worker Employee &lt;&gt;</span><br><span class="line"></span><br><span class="line">mov eax, TYPE Employee</span><br><span class="line">mov eax, SIZEOF Employee</span><br><span class="line">mov eax, SIZEOF worker</span><br><span class="line">mov eax, TYPE Employee.SalaryHistory</span><br><span class="line">mov eax, LENGTHOF Employee.SalaryHistory</span><br><span class="line">mov eax, SIZEOF Employee.SalaryHistory</span><br><span class="line">;</span><br><span class="line">mov dx, worker.Years</span><br><span class="line">mov worker.SalaryHistory, 20000</span><br><span class="line">mov worker.SalaryHistory+4, 30000</span><br><span class="line">mov edx, OFFSET worker.LastName</span><br><span class="line">;</span><br><span class="line">mov esi, OFFSET worker</span><br><span class="line">mov ax, (Employee PTR [esi]).Years</span><br><span class="line">;</span><br><span class="line">mov ax, [esi].Years	; invalid operand</span><br></pre></td></tr></table></figure>

<h4 id="3-5-Nested-Structure"><a href="#3-5-Nested-Structure" class="headerlink" title="3.5    Nested Structure"></a>3.5    Nested Structure</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Rectangle STRUCT</span><br><span class="line">	UpperLeft COORD &lt;&gt;</span><br><span class="line">	LowerRight COORD &lt;&gt;</span><br><span class="line">Rectangle ENDS</span><br><span class="line">.data</span><br><span class="line">rect1 Rectangle &#123;&#123;10,10&#125;,&#123;50,20&#125;&#125;</span><br><span class="line">rect2 Rectangle &lt; &lt;10,10&gt;, &lt;50,20&gt; &gt;</span><br><span class="line"></span><br><span class="line">mov rect1.UpperLeft.X, 10</span><br><span class="line">mov esi, OFFSET rect1</span><br><span class="line">mov (Rectangle PTR [esi]).UpperLeft.Y, 10</span><br><span class="line"></span><br><span class="line">mov edi, OFFSET rect2.LowerRight</span><br><span class="line">mov (COORD PTR [edi]).X, 50</span><br><span class="line">mov edi, OFFSET rect2.LowerRight</span><br><span class="line">mov WORD PTR [edi], 50</span><br></pre></td></tr></table></figure>

<h2 id="4-Declaring-and-Using-Union"><a href="#4-Declaring-and-Using-Union" class="headerlink" title="4. Declaring and Using Union"></a>4. Declaring and Using Union</h2><h4 id="4-1-union-definition-syntax"><a href="#4-1-union-definition-syntax" class="headerlink" title="4.1    union definition syntax"></a>4.1    union definition syntax</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name UNION</span><br><span class="line">	union-fields</span><br><span class="line">name ENDS</span><br><span class="line"></span><br><span class="line">; Integer Union Example</span><br><span class="line">Integer UNION</span><br><span class="line">	D DWORD 0</span><br><span class="line">	W WORD 0</span><br><span class="line">	B BYTE 0</span><br><span class="line">Integer ENDS</span><br><span class="line">.data</span><br><span class="line">val1 Integer &lt;12345678h&gt;</span><br><span class="line">val2 Integer &lt;100h&gt;</span><br><span class="line">val3 Integer &lt;&gt;</span><br><span class="line"></span><br><span class="line">mov val3.B, al</span><br><span class="line">mov ax, val3.W</span><br><span class="line">add val3.D, eax</span><br></pre></td></tr></table></figure>

<h4 id="4-2-Union-inside-a-structure"><a href="#4-2-Union-inside-a-structure" class="headerlink" title="4.2    Union inside a structure"></a>4.2    Union inside a structure</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Integer UNION</span><br><span class="line">	D DWORD 0</span><br><span class="line">	W WORD 0</span><br><span class="line">	B BYTE 0</span><br><span class="line">Integer ENDS</span><br><span class="line"></span><br><span class="line">FileInfo STRUCT</span><br><span class="line">	FileID Integer &lt;&gt;</span><br><span class="line">	FileName BYTE 64 DUP(?)</span><br><span class="line">FileInfo ENDS</span><br><span class="line"></span><br><span class="line">.data</span><br><span class="line">myFile FileInfo &lt;&gt;</span><br><span class="line">.code</span><br><span class="line">mov myFile.FileID.W, ax</span><br></pre></td></tr></table></figure>

<h2 id="5-Macro"><a href="#5-Macro" class="headerlink" title="5. Macro"></a>5. Macro</h2><p><a href="https://imgtu.com/i/HDZwJH"><img src="https://s4.ax1x.com/2022/02/13/HDZwJH.png" alt="HDZwJH.png"></a></p>
<h4 id="5-1-Defining-Macros"><a href="#5-1-Defining-Macros" class="headerlink" title="5.1    Defining Macros"></a>5.1    Defining Macros</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">macroname MACRO [param1, param2,...]</span><br><span class="line">	statement-list</span><br><span class="line">ENDM</span><br><span class="line"></span><br><span class="line">; example 1</span><br><span class="line">mNewLine MACRO</span><br><span class="line">	call Crlf</span><br><span class="line">ENDM</span><br><span class="line">.data</span><br><span class="line">.code</span><br><span class="line">mNewLine	; invoke the macro</span><br><span class="line"></span><br><span class="line">; example 2</span><br><span class="line">mPutChar MACRO char</span><br><span class="line">	push eax</span><br><span class="line">	mov al, char</span><br><span class="line">	call WriteChar</span><br><span class="line">	pop eax</span><br><span class="line">ENDM</span><br><span class="line">.code</span><br><span class="line">mPutChar &#x27;A&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-Invoking-Macros"><a href="#5-2-Invoking-Macros" class="headerlink" title="5.2    Invoking Macros"></a>5.2    Invoking Macros</h4><p><a href="https://imgtu.com/i/HDekkD"><img src="https://s4.ax1x.com/2022/02/13/HDekkD.png" alt="HDekkD.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mWriteStr MACRO buffer</span><br><span class="line">	push edx</span><br><span class="line">	mov edx, OFFSET buffer</span><br><span class="line">	call WriteString</span><br><span class="line">	pop edx</span><br><span class="line">ENDM</span><br><span class="line">.data</span><br><span class="line">str1 BYTE &quot;welcome!&quot;, 0</span><br><span class="line">.code</span><br><span class="line">mWriteStr str1</span><br><span class="line"></span><br><span class="line">; if you pass a blank argument, the error is also caught</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第八天</title>
    <url>/2022/02/20/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day8/</url>
    <content><![CDATA[<h2 id="1-MS-DOS-and-the-IBM-PC"><a href="#1-MS-DOS-and-the-IBM-PC" class="headerlink" title="1. MS-DOS and the IBM-PC"></a>1. MS-DOS and the IBM-PC</h2><h4 id="1-1-Real-Address-Mode"><a href="#1-1-Real-Address-Mode" class="headerlink" title="1.1    Real-Address Mode"></a>1.1    Real-Address Mode</h4><p><a href="https://imgtu.com/i/HOCUPO"><img src="https://s4.ax1x.com/2022/02/20/HOCUPO.png" alt="HOCUPO.png"></a></p>
<span id="more"></span>

<h4 id="1-2-MS-DOS-Memory-Organization"><a href="#1-2-MS-DOS-Memory-Organization" class="headerlink" title="1.2    MS-DOS Memory Organization"></a>1.2    MS-DOS Memory Organization</h4><p><a href="https://imgtu.com/i/HO1g2j"><img src="https://s4.ax1x.com/2022/02/20/HO1g2j.png" alt="HO1g2j.png"></a></p>
<h4 id="1-3-Redirecting-Input-Output"><a href="#1-3-Redirecting-Input-Output" class="headerlink" title="1.3    Redirecting Input-Output"></a>1.3    Redirecting Input-Output</h4><p><a href="https://imgtu.com/i/HO1qz9"><img src="https://s4.ax1x.com/2022/02/20/HO1qz9.png" alt="HO1qz9.png"></a></p>
<h4 id="1-4-INT-Instructions"><a href="#1-4-INT-Instructions" class="headerlink" title="1.4    INT Instructions"></a>1.4    INT Instructions</h4><p>this instruction executes a software interrupt, which is called an interrupt handler.</p>
<p>The Interrupt Vector Table holds a 32-bit segment-offset address for each possible interrupt handler.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INT number</span><br><span class="line">; (number = 0..FFh)</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/HO81hD"><img src="https://s4.ax1x.com/2022/02/20/HO81hD.png" alt="HO81hD.png"></a></p>
<h4 id="1-5-Common-Interrupts"><a href="#1-5-Common-Interrupts" class="headerlink" title="1.5     Common Interrupts"></a>1.5     Common Interrupts</h4><p><a href="https://imgtu.com/i/HOGtGF"><img src="https://s4.ax1x.com/2022/02/20/HOGtGF.png" alt="HOGtGF.png"></a></p>
<h2 id="2-MS-DOS-Function-Calls"><a href="#2-MS-DOS-Function-Calls" class="headerlink" title="2. MS-DOS Function Calls"></a>2. MS-DOS Function Calls</h2><h4 id="2-1-INT-21h-Function-4Ch-Terminate-Process"><a href="#2-1-INT-21h-Function-4Ch-Terminate-Process" class="headerlink" title="2.1    INT 21h Function 4Ch: Terminate Process"></a>2.1    INT 21h Function 4Ch: Terminate Process</h4><p>Ends the current process, returns an optional 8-bit return code to the calling process.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ah, 4Ch</span><br><span class="line">mov al, 0</span><br><span class="line">int 21h</span><br><span class="line">; same as:</span><br><span class="line">.EXIT 0</span><br></pre></td></tr></table></figure>

<h4 id="2-2-ASCII-Control-Characters"><a href="#2-2-ASCII-Control-Characters" class="headerlink" title="2.2    ASCII Control Characters"></a>2.2    ASCII Control Characters</h4><p><a href="https://imgtu.com/i/HOJjpD"><img src="https://s4.ax1x.com/2022/02/20/HOJjpD.png" alt="HOJjpD.png"></a></p>
<p><a href="https://imgtu.com/i/HOJhpF"><img src="https://s4.ax1x.com/2022/02/20/HOJhpF.png" alt="HOJhpF.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ah, 02h</span><br><span class="line">mov dl, &#x27;A&#x27;</span><br><span class="line">int 21h</span><br><span class="line"></span><br><span class="line">mov ah, 06h</span><br><span class="line">mov dl, 08h</span><br><span class="line">int 21h</span><br></pre></td></tr></table></figure>

<h4 id="2-3-Function-09h"><a href="#2-3-Function-09h" class="headerlink" title="2.3    Function 09h"></a>2.3    Function 09h</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">string BYTE &quot;This is a string$&quot;</span><br><span class="line">.code</span><br><span class="line">mov ah, 9</span><br><span class="line">mov dx, OFFSET string</span><br><span class="line">int 21h</span><br></pre></td></tr></table></figure>

<h4 id="2-4-Function-40h"><a href="#2-4-Function-40h" class="headerlink" title="2.4    Function 40h"></a>2.4    Function 40h</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">message BYTE &quot;Writing a string to the console&quot;</span><br><span class="line">bytesWritten WORD ?</span><br><span class="line">.code</span><br><span class="line">	mov ah, 40h</span><br><span class="line">	mov bx, 1</span><br><span class="line">	mov cx, LENGTHOF message</span><br><span class="line">	mov dx, OFFSET message</span><br><span class="line">	int 21h</span><br><span class="line">	mov bytesWritten, ax</span><br></pre></td></tr></table></figure>

<h4 id="2-5-Function-01h"><a href="#2-5-Function-01h" class="headerlink" title="2.5    Function 01h"></a>2.5    Function 01h</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">char BYTE ?</span><br><span class="line">.code</span><br><span class="line">mov ah, 01h</span><br><span class="line">int 21h</span><br><span class="line">mov char, al</span><br></pre></td></tr></table></figure>

<h4 id="2-6-Function-06h"><a href="#2-6-Function-06h" class="headerlink" title="2.6    Function 06h"></a>2.6    Function 06h</h4><p>Does not echo the input character</p>
<p>Does not wait for input(use the zero flag to check for an input character)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">char BYTE ?</span><br><span class="line">.code</span><br><span class="line">L1:</span><br><span class="line">	mov ah, 06h</span><br><span class="line">	mov dl, 0FFh</span><br><span class="line">	int 21h</span><br><span class="line">	jz L1</span><br><span class="line">	mov char, al</span><br><span class="line">	call DumpRegs</span><br></pre></td></tr></table></figure>

<h4 id="2-7-Function-0Ah"><a href="#2-7-Function-0Ah" class="headerlink" title="2.7    Function 0Ah"></a>2.7    Function 0Ah</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">count = 80</span><br><span class="line"></span><br><span class="line">KEYBOARD STRUCT</span><br><span class="line">	maxInput BYTE count				; max chars to input</span><br><span class="line">	inputCount BYTE ?				; actual input count</span><br><span class="line">	buffer BYTE count DUP(?)		; holds input chars</span><br><span class="line">KEYBOARD ENDS</span><br><span class="line"></span><br><span class="line">.data</span><br><span class="line">kybdData KEYBOARD &lt;&gt;</span><br><span class="line">.code</span><br><span class="line">	mov ah, 0Ah</span><br><span class="line">	mov dx, OFFSET kybdData</span><br><span class="line">	int 21h</span><br></pre></td></tr></table></figure>

<h4 id="2-8-Function-0Bh"><a href="#2-8-Function-0Bh" class="headerlink" title="2.8    Function 0Bh"></a>2.8    Function 0Bh</h4><p>get status of std input buffer</p>
<p>can be interrupted by ctrl+c</p>
<p>loop until a key is pressed. save it in a variable</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">L1:</span><br><span class="line">	mov ah, 0Bh</span><br><span class="line">	int 21h</span><br><span class="line">	cmp al, 0</span><br><span class="line">	je L1</span><br><span class="line">	mov ah, 1</span><br><span class="line">	int 21h</span><br><span class="line">	mov char, al</span><br><span class="line"></span><br><span class="line">; example: String Encryption</span><br><span class="line">XORVAL = 239</span><br><span class="line">.code</span><br><span class="line">main PROC</span><br><span class="line">	mov ax, @data</span><br><span class="line">	mov ds, ax</span><br><span class="line">L1:</span><br><span class="line">	mov ah, 6</span><br><span class="line">	mov dl, 0FFh		; don&#x27;t wait for character</span><br><span class="line">	int 21h	</span><br><span class="line">	jz L2				; quit if zf = 1</span><br><span class="line">	xor al, XORVAL</span><br><span class="line">	mov ah, 6</span><br><span class="line">	mov dl, al</span><br><span class="line">	int 21h				; write to output</span><br><span class="line">	jmp L1</span><br><span class="line">L2: EXIT</span><br></pre></td></tr></table></figure>

<h4 id="2-9-Function-3Fh"><a href="#2-9-Function-3Fh" class="headerlink" title="2.9    Function 3Fh"></a>2.9    Function 3Fh</h4><p>Reads a block of bytes</p>
<p>can be interrupted by ctrl+c</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">inputBuffer BYTE 127 DUP(0)</span><br><span class="line">bytesRead WORD ?</span><br><span class="line">.code</span><br><span class="line">mov ah, 3Fh</span><br><span class="line">mov bx, 0</span><br><span class="line">mov cx, 127</span><br><span class="line">mov dx, OFFSET inputBuffer</span><br><span class="line">int 21h</span><br><span class="line">mov bytesRead, ax</span><br></pre></td></tr></table></figure>

<h4 id="2-10-Function-2Ah"><a href="#2-10-Function-2Ah" class="headerlink" title="2.10    Function 2Ah"></a>2.10    Function 2Ah</h4><p>returns year in cx, month in dh, day in dl, and aday of week in al</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ah, 2Ah</span><br><span class="line">int 21h</span><br><span class="line">mov year, cx</span><br><span class="line">mov month, dh</span><br><span class="line">mov day, dl</span><br><span class="line">mov dayOfWeek, al</span><br></pre></td></tr></table></figure>

<h4 id="2-11-Function-2Bh"><a href="#2-11-Function-2Bh" class="headerlink" title="2.11    Function 2Bh"></a>2.11    Function 2Bh</h4><p>sets the system date.</p>
<p>AL = 0 if function was successful</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ah, 2Bh</span><br><span class="line">mov cx, year</span><br><span class="line">mov dh, month</span><br><span class="line">mov dl, day</span><br><span class="line">int 21h</span><br><span class="line">cmp al, 0</span><br><span class="line">jne failed</span><br></pre></td></tr></table></figure>

<h4 id="2-12-Function-2Ch"><a href="#2-12-Function-2Ch" class="headerlink" title="2.12    Function 2Ch"></a>2.12    Function 2Ch</h4><p>returns hours in ch, minutes in cl, seconds in dh, hundredth in dl</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ah, 2Ch</span><br><span class="line">int 21h</span><br><span class="line">mov hours, ch</span><br><span class="line">mov minutes, cl</span><br><span class="line">mov seconds, dh</span><br></pre></td></tr></table></figure>

<h4 id="2-13-Function-2Dh"><a href="#2-13-Function-2Dh" class="headerlink" title="2.13 Function 2Dh"></a>2.13 Function 2Dh</h4><p>sets the system date. AL = 0 if function was successful</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ah, 2Dh</span><br><span class="line">mov ch, hours</span><br><span class="line">mov cl, minutes</span><br><span class="line">mov dh, seconds</span><br><span class="line">int 21h</span><br><span class="line">cmp al, 0</span><br><span class="line">jne failed</span><br></pre></td></tr></table></figure>

<h2 id="3-File-Function"><a href="#3-File-Function" class="headerlink" title="3. File Function"></a>3. File Function</h2><h4 id="3-1-Function-716Ch"><a href="#3-1-Function-716Ch" class="headerlink" title="3.1 Function 716Ch"></a>3.1 Function 716Ch</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax, 716Ch</span><br><span class="line">mov bx, 2</span><br><span class="line">mov cx, 0</span><br><span class="line">mov dx, 10h + 02h</span><br><span class="line">mov si, OFFSET Filename</span><br><span class="line">int 21h</span><br><span class="line">jc failed</span><br><span class="line">mov handle, ax</span><br><span class="line">mov actionTaken, cx</span><br></pre></td></tr></table></figure>

<h4 id="3-2-Function-3Eh"><a href="#3-2-Function-3Eh" class="headerlink" title="3.2    Function 3Eh"></a>3.2    Function 3Eh</h4><p>use the same file handle that was returned by int21h when the file was opened</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">filehandle WORD ?</span><br><span class="line">.code</span><br><span class="line">mov ah, 3Eh</span><br><span class="line">mov bx, filehandle</span><br><span class="line">int 21h</span><br><span class="line">jc failed</span><br></pre></td></tr></table></figure>

<h4 id="3-3-Function-42h"><a href="#3-3-Function-42h" class="headerlink" title="3.3    Function 42h"></a>3.3    Function 42h</h4><p>permits random access to a file</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ah, 42h</span><br><span class="line">mov al, 0</span><br><span class="line">mov bx, handle</span><br><span class="line">mov cx, offsetHi</span><br><span class="line">mov dx, offsetLo</span><br><span class="line">int 21h</span><br></pre></td></tr></table></figure>

<h4 id="3-4-Function-5706h"><a href="#3-4-Function-5706h" class="headerlink" title="3.4    Function 5706h"></a>3.4    Function 5706h</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax, 5706h</span><br><span class="line">mov bx, handle		; handle of open file</span><br><span class="line">int 21h</span><br><span class="line">jc error</span><br><span class="line">mov date, dx</span><br><span class="line">mov time, cx</span><br><span class="line">mov millisecconds, si</span><br></pre></td></tr></table></figure>

<h2 id="4-BIOS-Introduction"><a href="#4-BIOS-Introduction" class="headerlink" title="4. BIOS Introduction"></a>4. BIOS Introduction</h2><p><a href="https://imgtu.com/i/HOxIxA"><img src="https://s4.ax1x.com/2022/02/20/HOxIxA.png" alt="HOxIxA.png"></a></p>
<p><a href="https://imgtu.com/i/HOzez9"><img src="https://s4.ax1x.com/2022/02/20/HOzez9.png" alt="HOzez9.png"></a></p>
<h2 id="5-Keyboard-Input-with-INT-16h"><a href="#5-Keyboard-Input-with-INT-16h" class="headerlink" title="5. Keyboard Input with INT 16h"></a>5. Keyboard Input with INT 16h</h2><p><a href="https://imgtu.com/i/HXSd1J"><img src="https://s4.ax1x.com/2022/02/20/HXSd1J.png" alt="HXSd1J.png"></a></p>
<p><a href="https://imgtu.com/i/HXSXcj"><img src="https://s4.ax1x.com/2022/02/20/HXSXcj.png" alt="HXSXcj.png"></a></p>
<p><a href="https://imgtu.com/i/HXpEv9"><img src="https://s4.ax1x.com/2022/02/20/HXpEv9.png" alt="HXpEv9.png"></a></p>
<h4 id="5-1-Function-10h"><a href="#5-1-Function-10h" class="headerlink" title="5.1    Function 10h"></a>5.1    Function 10h</h4><p>if a key is in buffer, returns it immediately. Or, pauses and waits for user input</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">scanCode BYTE ?</span><br><span class="line">ASCIICode BYTE ?</span><br><span class="line"></span><br><span class="line">.code</span><br><span class="line">mov ah, 10h</span><br><span class="line">int 16h</span><br><span class="line">mov scanCode, ah</span><br><span class="line">mov ASCIICode, al</span><br></pre></td></tr></table></figure>

<h4 id="5-2-Function-12h"><a href="#5-2-Function-12h" class="headerlink" title="5.2    Function 12h"></a>5.2    Function 12h</h4><p>retrieves a copy of the keyboard status flags from the BIOS data area</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">keyFlags WORD ?</span><br><span class="line">.code</span><br><span class="line">mov ah, 12h</span><br><span class="line">int 16h</span><br><span class="line">mov keyFlags, ax</span><br></pre></td></tr></table></figure>

<h4 id="5-3-Function-11h"><a href="#5-3-Function-11h" class="headerlink" title="5.3    Function 11h"></a>5.3    Function 11h</h4><p>clear the zero flag if a key is waiting in the buffer</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">L1:</span><br><span class="line">	mov ah, 11h</span><br><span class="line">	int 16h</span><br><span class="line">	jz noKey</span><br><span class="line">	mov ah, 10h</span><br><span class="line">	int 16h</span><br><span class="line">	cmp ah, scanCode</span><br><span class="line">	je quit</span><br><span class="line">	jmp L1</span><br><span class="line">noKey:</span><br><span class="line">	or al, 1</span><br><span class="line">quit:</span><br></pre></td></tr></table></figure>

<h2 id="6-VIDEO-Programming-with-INT-10h"><a href="#6-VIDEO-Programming-with-INT-10h" class="headerlink" title="6. VIDEO Programming with INT 10h"></a>6. VIDEO Programming with INT 10h</h2><h4 id="6-1-Three-levels-of-Video-Access"><a href="#6-1-Three-levels-of-Video-Access" class="headerlink" title="6.1    Three levels of Video Access"></a>6.1    Three levels of Video Access</h4><p><a href="https://imgtu.com/i/HjMyGQ"><img src="https://s4.ax1x.com/2022/02/21/HjMyGQ.png" alt="HjMyGQ.png"></a></p>
<p><a href="https://imgtu.com/i/HjQpJe"><img src="https://s4.ax1x.com/2022/02/21/HjQpJe.png" alt="HjQpJe.png"></a></p>
<h4 id="6-2-Displaying-a-Color-String"><a href="#6-2-Displaying-a-Color-String" class="headerlink" title="6.2    Displaying a Color String"></a>6.2    Displaying a Color String</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov si, OFFSET string</span><br><span class="line">...</span><br><span class="line">mov ah, 9				; write character</span><br><span class="line">mov al, [si]			; character to display</span><br><span class="line">mov bh, 0				; video page 0</span><br><span class="line">mov bl, color			; attribute</span><br><span class="line">or bl, 10000000b		; set blink/intensity bit</span><br><span class="line">mov cx, 1				; display it one time</span><br><span class="line">int 10h</span><br></pre></td></tr></table></figure>

<h4 id="6-3-DrawLine-Program"><a href="#6-3-DrawLine-Program" class="headerlink" title="6.3    DrawLine Program"></a>6.3    DrawLine Program</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ah, 0Ch					; white graphics pixel</span><br><span class="line">mov al, color				; pixel color</span><br><span class="line">mov bh, 0					; video page 0</span><br><span class="line">mov cx, currentX</span><br><span class="line">int 10h</span><br></pre></td></tr></table></figure>

<h4 id="6-4-Memory-Mapped-Graphics"><a href="#6-4-Memory-Mapped-Graphics" class="headerlink" title="6.4    Memory-Mapped Graphics"></a>6.4    Memory-Mapped Graphics</h4><p><a href="https://imgtu.com/i/HjwA3t"><img src="https://s4.ax1x.com/2022/02/21/HjwA3t.png" alt="HjwA3t.png"></a></p>
<h4 id="6-5-OUT-Instruction"><a href="#6-5-OUT-Instruction" class="headerlink" title="6.5    OUT Instruction"></a>6.5    OUT Instruction</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov dx, 3c8h		; port address</span><br><span class="line">mov al, 20h			; value to be sent</span><br><span class="line">out dx, al			; send to the port</span><br></pre></td></tr></table></figure>

<h2 id="7-Mouse-Programming"><a href="#7-Mouse-Programming" class="headerlink" title="7. Mouse Programming"></a>7. Mouse Programming</h2><h4 id="7-1-INT-33h"><a href="#7-1-INT-33h" class="headerlink" title="7.1    INT 33h"></a>7.1    INT 33h</h4><p>ax = 0, reset mouse and get status</p>
<p>ax = 1, show mouse</p>
<p>ax = 2, hide mouse</p>
<p>ax = 3, get mouse position &amp; status</p>
<p>ax = 4, set mouse position</p>
<p>ax = 5, get button press information</p>
<p>ax = 6, get button release information</p>
<p>ax = 7, set horizontal limits</p>
<p>ax = 8, set vertical limits</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax, 0</span><br><span class="line">int 33h</span><br><span class="line">cmp ax, 0</span><br><span class="line">je MouseNotAvailable</span><br><span class="line">mov numberOfButtons, bx</span><br><span class="line"></span><br><span class="line">mov ax, 1</span><br><span class="line">int 33h</span><br><span class="line">mov ax, 2</span><br><span class="line">int 33h</span><br><span class="line"></span><br><span class="line">mov ax, 3</span><br><span class="line">int 33h</span><br><span class="line">test bx, 1</span><br><span class="line">jne Left_Button_Down</span><br><span class="line">text bx, 2</span><br><span class="line">jne Right_Button_Down</span><br><span class="line">text bx,4</span><br><span class="line">jne Center_Button_Down</span><br><span class="line">mov xCoord, cx</span><br><span class="line">mov yCoord, dx</span><br><span class="line"></span><br><span class="line">mov ax, 4</span><br><span class="line">mov cx, 200</span><br><span class="line">mov dx, 100</span><br><span class="line">int 33h</span><br><span class="line"></span><br><span class="line">mov ax, 5</span><br><span class="line">mov bx, 0</span><br><span class="line">int 33h</span><br><span class="line">test ax, 1		; left button down?</span><br><span class="line">jz skip			; no - skip</span><br><span class="line">mov X_coord, cx</span><br><span class="line">mov Y_coord, dx	; save coordinates</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第Ⅸ天</title>
    <url>/2022/02/20/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day9/</url>
    <content><![CDATA[<h2 id="1-Defining-Segments"><a href="#1-Defining-Segments" class="headerlink" title="1.    Defining Segments"></a>1.    Defining Segments</h2><p><a href="https://imgtu.com/i/HjgpHx"><img src="https://s4.ax1x.com/2022/02/21/HjgpHx.png" alt="HjgpHx.png"></a></p>
<span id="more"></span>

<p><a href="https://imgtu.com/i/HjgPUK"><img src="https://s4.ax1x.com/2022/02/21/HjgPUK.png" alt="HjgPUK.png"></a></p>
<h4 id="1-1-NEAR-and-FAR-Segment"><a href="#1-1-NEAR-and-FAR-Segment" class="headerlink" title="1.1    NEAR and FAR Segment"></a>1.1    NEAR and FAR Segment</h4><p><a href="https://imgtu.com/i/HjgKVP"><img src="https://s4.ax1x.com/2022/02/21/HjgKVP.png" alt="HjgKVP.png"></a></p>
<h4 id="1-2-MODEL-Directive"><a href="#1-2-MODEL-Directive" class="headerlink" title="1.2    .MODEL Directive"></a>1.2    .MODEL Directive</h4><p><a href="https://imgtu.com/i/HjgWa6"><img src="https://s4.ax1x.com/2022/02/21/HjgWa6.png" alt="HjgWa6.png"></a></p>
<p><a href="https://imgtu.com/i/HjgHsA"><img src="https://s4.ax1x.com/2022/02/21/HjgHsA.png" alt="HjgHsA.png"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;	syntax:</span><br><span class="line">		.MODEL type, language, stackdistance</span><br><span class="line">;	StackDistance can be NEARSTACK, FARSTACK(stack and data aren&#x27;t together)</span><br></pre></td></tr></table></figure>

<h4 id="1-3-STACK-Directive"><a href="#1-3-STACK-Directive" class="headerlink" title="1.3    .STACK Directive"></a>1.3    .STACK Directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; Syntax: .STACK [stacksize]</span><br><span class="line">; default 1024</span><br><span class="line">; example</span><br><span class="line">.stack 2048</span><br></pre></td></tr></table></figure>

<h4 id="1-4-CODE-Directive"><a href="#1-4-CODE-Directive" class="headerlink" title="1.4    .CODE Directive"></a>1.4    .CODE Directive</h4><p><a href="https://imgtu.com/i/HjRGBn"><img src="https://s4.ax1x.com/2022/02/21/HjRGBn.png" alt="HjRGBn.png"></a></p>
<h4 id="1-5-Near-Data-Segments"><a href="#1-5-Near-Data-Segments" class="headerlink" title="1.5    Near Data Segments"></a>1.5    Near Data Segments</h4><p><a href="https://imgtu.com/i/HjRBjJ"><img src="https://s4.ax1x.com/2022/02/21/HjRBjJ.png" alt="HjRBjJ.png"></a></p>
<h4 id="1-6-Far-Data-Segments"><a href="#1-6-Far-Data-Segments" class="headerlink" title="1.6    Far Data Segments"></a>1.6    Far Data Segments</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.FARDATA</span><br><span class="line">myVar</span><br><span class="line">.CODE</span><br><span class="line">	mov ax, SEG myVar		; SEG operator returns the segment value of a lab.</span><br><span class="line">	mov ds, ax</span><br></pre></td></tr></table></figure>

<h4 id="1-7-SEGMENT-Directive"><a href="#1-7-SEGMENT-Directive" class="headerlink" title="1.7    SEGMENT Directive"></a>1.7    SEGMENT Directive</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name SEGMENT [align][combine][&#x27;class&#x27;]</span><br><span class="line">	statements</span><br><span class="line">name ENDS</span><br><span class="line">; name: ExtraData</span><br><span class="line">; paragraph align type (starts on 16-byte boundary)</span><br><span class="line">; public combine type</span><br><span class="line">; &#x27;DATA&#x27;</span><br><span class="line">ExtraData SEGMENT PARA PUBLIC &#x27;DATA&#x27;</span><br><span class="line">	var1 BYTE 1</span><br><span class="line">	var2 WORD 2</span><br><span class="line">ExtraData ENDS</span><br></pre></td></tr></table></figure>

<h4 id="1-8-ASSUME-Directive"><a href="#1-8-ASSUME-Directive" class="headerlink" title="1.8    ASSUME Directive"></a>1.8    ASSUME Directive</h4><p>tells the assembler how to calculate the offsets of labels</p>
<p>associates a segment register with a segment name</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; syntax:</span><br><span class="line">	ASSUME segreg:segname [,segreg:segname]</span><br><span class="line">; example</span><br><span class="line">	ASSUME cs:myCode, ds:Data, ss:myStack</span><br><span class="line">	ASSUME es:ExtraData</span><br></pre></td></tr></table></figure>

<h4 id="1-9-Multiple-Data-Segments"><a href="#1-9-Multiple-Data-Segments" class="headerlink" title="1.9    Multiple Data Segments"></a>1.9    Multiple Data Segments</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; example 1</span><br><span class="line">cseg SEGMENT &#x27;CODE&#x27;</span><br><span class="line">ASSUME cs:cseg, ds:data1, es:data2, ss:mystack</span><br><span class="line"></span><br><span class="line">main PROC</span><br><span class="line">	mov ax, data1			; ds points to data1</span><br><span class="line">	mov ds, ax</span><br><span class="line">	mov ax, SEG val2		; es points to data2</span><br><span class="line">	mov es, ax</span><br><span class="line">	mov ax, val1</span><br><span class="line">	mov bx, val2</span><br><span class="line">	mov ax, 4C00h			; same as .exit</span><br><span class="line">	int 21h</span><br><span class="line">main ENDP</span><br><span class="line">cseg ENDS</span><br><span class="line"></span><br><span class="line">; example 2</span><br><span class="line">data1 SEGMENT &#x27;DATA&#x27;</span><br><span class="line">	var1 WORD 1001h</span><br><span class="line">data1 ENDS</span><br><span class="line"></span><br><span class="line">data2 SEGMENT &#x27;DATA&#x27;</span><br><span class="line">	var2 WORD 1002h</span><br><span class="line">data2 ENDS</span><br><span class="line"></span><br><span class="line">myStack SEGMENT PARA STACK &#x27;STACK&#x27;</span><br><span class="line">	BYTE 100h DUP(&#x27;S&#x27;)</span><br><span class="line">myStack ENDS</span><br><span class="line">END MAIN</span><br></pre></td></tr></table></figure>

<h2 id="2-Interrupt-Handling"><a href="#2-Interrupt-Handling" class="headerlink" title="2. Interrupt Handling"></a>2. Interrupt Handling</h2><h4 id="2-1-Interrupt-Vector-Table"><a href="#2-1-Interrupt-Vector-Table" class="headerlink" title="2.1    Interrupt Vector Table"></a>2.1    Interrupt Vector Table</h4><p><a href="https://imgtu.com/i/HjjMdK"><img src="https://s4.ax1x.com/2022/02/21/HjjMdK.png" alt="HjjMdK.png"></a></p>
<h4 id="2-2-Hardware-Interrupt"><a href="#2-2-Hardware-Interrupt" class="headerlink" title="2.2    Hardware Interrupt"></a>2.2    Hardware Interrupt</h4><p><a href="https://imgtu.com/i/HjjvFO"><img src="https://s4.ax1x.com/2022/02/21/HjjvFO.png" alt="HjjvFO.png"></a></p>
<h4 id="2-3-Common-IRQ-Assignments"><a href="#2-3-Common-IRQ-Assignments" class="headerlink" title="2.3    Common IRQ Assignments"></a>2.3    Common IRQ Assignments</h4><p><a href="https://imgtu.com/i/HjvPOI"><img src="https://s4.ax1x.com/2022/02/21/HjvPOI.png" alt="HjvPOI.png"></a></p>
<p><a href="https://imgtu.com/i/HjvATf"><img src="https://s4.ax1x.com/2022/02/21/HjvATf.png" alt="HjvATf.png"></a></p>
<h4 id="2-4-Interrupt-Control-Instructions"><a href="#2-4-Interrupt-Control-Instructions" class="headerlink" title="2.4    Interrupt Control Instructions"></a>2.4    Interrupt Control Instructions</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; STI = set interrupt flag</span><br><span class="line">- enable external interrupts</span><br><span class="line">- executed at beginning of an interrupt handler</span><br><span class="line">; CLI = clear interrupt flag</span><br><span class="line">- disable external interrupts</span><br><span class="line">- used before critical code sections that can&#x27;t be interrupt</span><br><span class="line">- suspends the system timer</span><br></pre></td></tr></table></figure>

<h4 id="2-5-Writing-a-Custom-Interrupt-Handler"><a href="#2-5-Writing-a-Custom-Interrupt-Handler" class="headerlink" title="2.5    Writing a Custom Interrupt Handler"></a>2.5    Writing a Custom Interrupt Handler</h4><p><a href="https://imgtu.com/i/HjxpNT"><img src="https://s4.ax1x.com/2022/02/21/HjxpNT.png" alt="HjxpNT.png"></a></p>
<p>-tip0: Function 35h get interrupt vector, returns segment offset addr of handler in es:bx</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">int9Save LABEL WORD</span><br><span class="line">vector DWORD ?</span><br><span class="line">.code</span><br><span class="line">mov ah, 35h				; get interrupt</span><br><span class="line">mov al, 9				; for int 9</span><br><span class="line">int 21h					; call MS-DOS</span><br><span class="line">mov int9Save, bx		; store the offset</span><br><span class="line">mov [int9Save+2],es		; store the segment</span><br></pre></td></tr></table></figure>

<p>-tip1: Function 25h, set interrupt vector installs new interrupt handler, pointed to by ds:dx</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax, SEG kybd_rtn</span><br><span class="line">mov ds, ax</span><br><span class="line">mov dx, OFFSET kybd_rtn</span><br><span class="line">mov ah, 25h</span><br><span class="line">mov al, 9h</span><br><span class="line">int 25h</span><br></pre></td></tr></table></figure>

<h4 id="2-6-Keyboard-Processing-Steps"><a href="#2-6-Keyboard-Processing-Steps" class="headerlink" title="2.6    Keyboard Processing Steps"></a>2.6    Keyboard Processing Steps</h4><p><a href="https://imgtu.com/i/HvyQYD"><img src="https://s4.ax1x.com/2022/02/21/HvyQYD.png" alt="HvyQYD.png"></a></p>
<p><a href="https://imgtu.com/i/HvywtS"><img src="https://s4.ax1x.com/2022/02/21/HvywtS.png" alt="HvywtS.png"></a></p>
<h4 id="2-7-Terminate-and-Stay-Resident-Programs"><a href="#2-7-Terminate-and-Stay-Resident-Programs" class="headerlink" title="2.7    Terminate and Stay Resident Programs"></a>2.7    Terminate and Stay Resident Programs</h4><p>installed in memory until removed by a removal program or by rebooting</p>
<h4 id="2-8-Hardware-Control-Using-I-0-Ports"><a href="#2-8-Hardware-Control-Using-I-0-Ports" class="headerlink" title="2.8    Hardware Control Using I/0 Ports"></a>2.8    Hardware Control Using I/0 Ports</h4><p><a href="https://imgtu.com/i/Hv6I58"><img src="https://s4.ax1x.com/2022/02/21/Hv6I58.png" alt="Hv6I58.png"></a></p>
<p><a href="https://imgtu.com/i/Hv6TPS"><img src="https://s4.ax1x.com/2022/02/21/Hv6TPS.png" alt="Hv6TPS.png"></a></p>
]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>os xv6源码解读(操作系统架构)</title>
    <url>/2022/03/25/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/os_day2/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">
  <script id="hbeData" type="hbeData" data-hmacdigest="99d27d7f1b7b5810d9ef0639ae5ea17c8af90c14e37bf66bb671c407656d3ce4">10d79030e8222445804370796b90fca1b3149e2c2a0f36d6b4ea04e548758c2142f44fd7ccb8d269f64e53a5eb295dde04e16089bc5e0c3d07e452f07721d323cb37f6ea9ca5386b0915059098b19a89977c4f8dc30cd4a01e521f95df7cc91608eceb06cc41545067f6bc1189c49a3dd9a9a03f30b99a34b4a425dbc83a8a67f75061011e67f7da0d4ae2294a57cb43894f93866f1663f8a5ab215f5bb72207c6fd6e993656b12636dee5f5c719f17094e548c12deb568b7f7872d4e1f1337b50f1f2e0bf17abb9dfda03320aa8c8366a61cbe01f9051dba266db27e8bb2fbe6c5fa839034c26157d1b7cb64c51ebad48c7f1e1e36be95f24ea22e0080c64d6f78fe6ebfeb6025345542e5b3a90b260b906d4b2b169318543bedb10df70cf5d1f073978a794903e8bbfb68b6920f38ca5627cdd9d2a631ca005c6ed201883689d1a84bf245bab3a07a229375301d639e01991379772b4b694c5580d3c074e414999e1403c59280a7165118c84a985a5882a0602c34b5bd8b19c24b1d0235927bc5df12264e5e64c3c5d844e33770c3f9c5af12228511fb8b3187d53602ed102cd710f7758c8d77b3e38cca8492decf158ccd495cf03d0ef75cc513663403aaa797ab47676e282def15bf6d6769d90dee9fc613c813a2de9ae052397ec218ac51cffcd726ecc1b6cd05cee1a91bfc8c80a99bfa2f85423aeae51a6f4d39578f3fdd563f44e3334295137ba6f0105a3a34db969eed01a004985280eb49091656828cba9e4dcb1e32dea706265bb38deecf41d907e9e05bfb883618f376ba12f669717a1dae9ff135e1c80a977edc447113aac5935d8c68b9ebfe614bb5f28673e38a6bcc2ef2b6cb7326679e25941eeecc65b262bc48c1bec8581b5e15ea90a0157543e326e33969b3838147ce808cb4e57ad6980cea5702a315cdf51e569fe85d898f64af359aa532035d690f121a167abc0b2c56197b81555b537ee6eeeaf43172de362c6da233a8274d943768bb41a37aacee944e3ded63ebc5c11badff9d1e73a9eb727e68379b747bd8f216c8b7a876e2e053e70f4c1b733b9bdb7e16cb15e828f4d1dfbfce50ad9b1a2a1b1613400e89819516b054927a47e715bc43016c2e84ad25910f209156bca091a8e626112c68ce85e0d8585261f4d94ed6203a328bfbf8fa50dff784c954aebda14d969d1af1c8f42da390cf413e5289b3c3cfdd2ba0af9b4861f2f7daed829dfcb53b6f80c2fe07dacfc8cf55516048bb4bc21650ba2375ec29089940c3f15ca21efd318200e3d7132b0b19b931ed16e796655ea69422b052d73cfec82d811a3643c70d76f108ef29b0f8badb995daa105b8eeb49a74ddd7db8fe274517c424cc492f6f2f5c18e12c51852e54985930f80bb12851bb3ac196a164854871da21bddfd2fbf5e6d31184213e8ddcfe665e42e629ec99c06f7d956c2bf89b70b42b3ab426ebf7e057172b0d2ba7eb8ff8f11853868e153e742cfc6744ba203a9e91ed1bceae73ad35657b9a85e418e9cfe3d0e8ff56bcff9dc9a902a3ce1ffca03c029a094bbf8e07e9621733dd28cfb3881c6e7e5cdbf82d97a168f09ca040ff3cd6953d9fcee10f84be57a52c1e32209e1624043431297ea5c5471346d26f9e9a4e387c84631f0695cd963d3c4a290272c3ff7511ab2b3ddf687317905f126242be2a6b5d25c7dfb1877635a065f657d178a71a18088424fcd4eab384f2a87362337d7f87ca1a555cd35943dff48f4547fa46a6cf9ff783211c1818d0c2c845698b0d1704c0edbf0e1dae975d728b0d7bff45b1b28228e6c6ab26e52272a33d8ca66ca5a77ae91983d3f8f5c9b5d17274b4a48516b562125cdb999c0ebd536a7c181a76d571f2fd33109f5a5c2cd09073a0bf86bbd3214441f549d7b1e1fd9640f5b88cfd1c0357a0512a2dec58b3801b6c1967ea7d83a49e8e1449dd71a085ed6fe6f9eab02124c99690fa938ba257991daa4735d33c768083356359c80e775b6bdef2b51112bcc15be3bed7d1afe94b454509391c041331a6017aa4c906d2755f8feef44f8811a929890c18ed33b997b692c61d0fd22ca1e779f6d958cd4c4b0891b71b0991b31e81d669aff668598d61f04927c3cea1f90d99053ba6fc3c2b48c5cdffe5b9e6de7e1fa9895b8c18959240b0d39ebadcceb8c9f2b55cb25a6e2487b8af9912cd0a74f6ef07d41b952658b79ff3f94cf0fb89b5d5f77f9c01c1741eac3548144ec08d56e753159e57157b14c808d865a727af0481312fc777187435dea1980bf9a9370c4b83552c35f74d911dccebc017566b1aa7f0be6bb667febeca16760feceea282fd2ab936636999429a3dd5809678491c0293c0be699af5722e76e3316a4a112238d0dd984306e7671e89754f005f2f1a8aaf4d76fd88802a235d678b863e0ed8b1595773d3cb6421f334ff498e1131383cc63d381d16affc0c6b27c798f806a38b55ce12e74e56ecf8301d6e730ca11105736ad22478ffab25a7b7aa3bf99b87c087008ce3fc7ec4b9ce9bac80efc033a4d9306e2a3c9df14a0b6e6d24dba90004c8b8a705c853aadd472c3ba6eb1c1bb53b72ee27296676b353709fbee55db58bb369ddf4f05e1d82d55fad8be5de06a1fc42d5b97ddba94769da605034d611e78d3a049a0115a3940e733d90370db0c78553672d57c73d8a4eb20e3f610ffdaeeccadbd0075425031389a3a74ae89d176c6898b71720c45764225eaecb4f7d56fb959e47346378d5cf8a830768e32ff5df4254c5b8e309612e5bc6b70c63aebda9ee843758f9a850cb07762327d00e706aa745a37e68f2ae6a59a3c63a548d615f52deccb4c09c12f596cdac9a03b2e033eea594a9af7bf125f0b563f84ec8b56434d47151a04215b4fb023007412a3f4543beb92eb19fabc2131e039982eb13ab44b9416b6144e40d1d272045fec4d4a636cc573881ff47c0d7a52bda8bae5392733e9b07c9d170cc818c5b9954b9fae55b739db2f6ba160bf55421d3b27ce10fa6f0ffce7b238d9ae3d310bc898d3e76b546f825c60f4c5da36326b1a75bfc32222140697170ae5736239c0b8120253550020f497e250abeb540ed55a635e94d3df82688b90a862828228e5f0213feadbdf15f7487a5b491a6c3027a3e4eb3e9e2a1ab425bba0e186747b66e3660b8960474431c5ce578ca7a0d78a041263eb3a0563fcf32e2750b13caa43fd73e4a47d5dbea53c530e5f2599a9c42ed757613e87b1cc7c33b0a6ca5c3157f587b67b9ac4e3463d7cf9732dc3cc0a52fb75ca305963603c65ce058dcbc5362e50de018ca06adcf598986e2a41a433cc0a45088a86b8bfe732086c25bc6c0808861470e67c72d5d18a035546b7f9850a2f01d60c635fa28ab5c50127016cc38262c043cfdab6498512f14c64ffc03ee5a2ac72fcb01ce708f8dd49a9f21377d814737e86e10436233b14220a19c68ade2fb9ad03e78bf3fb7fa6e95eba11297c08cdeb248dbfe206b3d36c7885d02d8aba3c8b5aa98960431a58d5b9cf0d1516b7042f8560e890dc75c5415caed268a42a340773fc2191408b500c16088cadccc2fd9687766108b7e5052e225d77a530f717b8f715ce76ece09ebaa452496675106706496885fe1b0d54311b00b128160f6a1e57385b229116406d01f726b93ac2f692f50fbe16840296f533d5e0fa5b206850139a010f750f917a66a8207001a5580fd9041f380a3545d4cc96eaef590b852ee944160d43727c343d2edd03e2760b604a561d5e1fd00dfa4585364c62a45211872b1f17201d86217c04cb157f71f0b8a6d6bf1eed2a075a86f88cdd889f1ca017709a7eb1b09e27631d49ae6f22526ddc380238fb8d5b83902a32295db3c835d004f2d65433fd955d62083bd06efbd5d31bd94469766f0bf381a1fd90f214fecfd42943f46eef5c43d534d144c40b0626918dae78ec93a83fa170c181e3cf3def6cb23915c1535982ca50bb397c9667585d010bc57114ef30c31c88aa205f74088d74da09ca526ae72644955761f851a2ad40db6808936a6837564cb91d9e68e48748faea771531a5d35c243181ead9ce0edbb9810f98ac936e63d0b8a45be475842751caa17f28cffc75c40b6075160bc01e4a52147a84a00cb592e7c9d7059c326f00be3a5a4131cdc56afd2b86b686a567f3fd288364b1f68f715557abfffd1db1a2c094899c8bba3337bab79b5f172e8edddb4ee62ae6db1cd3a996b5b77181653f3434e4796e0186ea4119b99f62753593f8554298aeb7e0bfe2cf7e1fd32cb6660fc998f2c90b9c539528e4b860a45ff01b889378e09febc580293294df3d1c21841b736cf3e959d4f1f6d6f5e6ecd630e901f8c7d5dadaf27d6123f0a7d11edf77ed09843d36ad31c4cc447a991ad82d864914b277cfca5cf721ae7d06738e83ec7162f71b2b51327616cbac2c2025f2482125ed22449024cd1ade745fdad81248307d7826a218bf3bbd86783a82c9fa19541ce11326ac7770aa0ae02e57418484b885748dbdabae47dd14ffd0f02be0307383d8f1536e1edbf56fdfd8080edac9671c15103ebd1ede05cb133cbd8d5357ab7e808adb40572000be44435ca87d059d771ab11aff2ee101bd7ad203127806ff8a4935fbc0b9707f20aa8efccb72d9dfdfa1712d6d2d77bf0d4edbe4a7e78b52d7122d3bdc126b6c13cdd5643ce5ce11084eea5881e51f083c3d187f9d82d3e6e11f69d5b95b2c4587ddafa2eedc9b5ba6892949d820b97ab78cb1ec9d99f2ad8303a2fa9db3e23f447936d02d6c1e7d0c934dfd2c39fd0b7cc1590df18974e950c1810d4a034fc743e200ed5d60516bdce75abae008fbdfb35b04b9f8b73a6a8f9b72eb7dd88f270c2e22d87a011b9a32d01236af6a7559175fb2fc57ef64c7c66db8320566184a6197fa66756dd1ea55d16a6aa19f951ef2e24938aad01385a5ae36ca96283eb6afd0ee3d6c1cd23ab7a2ff62b9cfdffaed95080656a3463093f939b79683f5f73df1a5141d223ec25efa6bc385c78036c5c75018232468194a779cf20747aa013d3191bd888e15c7b7074e57c013793187562db8d9bcb6b40c0118645bbd366572c59997dafd3ce8759cad33aade028ee006da923c5b53431176dcd3bf85b3b0f529895f78096c5f3014b70f339dfb02632174624cc5a34dcea048b33834fd26078e130ec690b6799aa04d9c19ff9b4f072972ac0ea1434c309a18573b711f77a387a2c3e647622f112a9417fc4d417319880cbebcd9bfb759abf372c304a9306e1bd3b5aea8bc491a4d816a1215fe3d0968be2caa9be89699437ee40c694eb34db1883283b0a2859ff769841811a18702145c6a47f2c382e8e1b6ddbe68984429ca3fcee8071b3fc09b93b0ecff277ba5e0492d8818dabdc1c6e3ddbea0433f6ff8a028fbb3309c150777cacab32404c8a52fa6d519bae0c993830bba1b790d0a3397c76ddf013615cb79dfaa84402567784ad16aaa226d80f9efded0a1e3ef7a83c546dc194440f718a38247abff87edcdc4f46a2a37ca42c88eef8624965c2fd43cb5fa11b06587075709e6be695eb04e84d380f99c8ecc077584c8d4403e89b21169d62339a02c7803d38cbfdc26d9cac904b61cceb040f7785ce454a83377722ded2941efad057e7b07d761d68ff137688b859c8e0e9a8ff7583e193061d76084649abf7baa5e652f96479d3815c915a9ef4ad17cc42d15eaad93ed2e5f2da96fe7515ea91ada9eb6d6534e4debf01abdbe89e489abb0174b93d8a26c7357af5492811ef6b6a5532383da9f9a741d293fd1f8d2989bb4ad7223d4a0bc624d259aa932bbdc403332471721e4b321a5af348cd57efdb57afd84d507538a0309d6ab6d1df76eda2fce600015ef6da31941de857970ebcd41a5a6f14ade377fd70b32ec9012089c5acafe80ad3b9c2cb7b7547777cc9a90e1e1c942a6564013f4ecc3f788eb6da07b3d117b38df61b7d5c38e2a8fa6a9950b9361331263a7e42aa45de10b1896c6af2c883e32da8aca14830e7d79263065e615303ea42f1c4c1e960ce90fb38e926dbbd292023aabfa1a6fabb6515a13b3ec0e0a5119a3a0303a0251cfe5c497d5a194d02f59278063a4904264e8b4d391c6d14d193bedc01560203d7b972f5b78aae1c4700d8cc1a7256a6db23261014d85dd58193fe450fe5836f08937b5904c171e7bf328fc039f5914c1b6d693936ba2db9263b4fc38dbbaffe790a9f06c8fab8a5459baf13c1db699c5b44b0f7fe44c7598bc1f5befaddd19b413c5614234a1a4b07e063ef2a83307d11ba6cafe1fe6fab1b9b3e151c58af01b17d286ba5f7a402fe65f2f084b3f71af2400a03a0f29d91c1779955283fc0dfc5131a7c7c4a0cd70c3b49ae9a7cedb401b88930f27e7758579d0b5aa7c8817e90026453f5b72201db2fc3adeb773349a3ab3f75737b7423d27490083ce8b92e3d8296f1f1e260b0e7b4718407263f74ff97403547b0b26113648ab719a63e441cafb1279f554b5fac327f8fa883bb5d5db2d05c44196c0a19747c4cb8f3fd71c9c878c2b7c805f127c8a6b1b7a6b64f498aa211a59c7444bcae633b7f4b66a7cca157055d02b87090dfd07337d7ecbf060976e98364dc19c3179c89df502b1193912e6f74c80bc9eead83879d0af5954889db6d1c46d8205f70584b46814491deee2e3dcd89e93f0ebe84d73376ce59c25d90f7cc8eaaead1a969fc5fbbe5b436cb28fbb76e2f72f978bf2fb1f9e36d3d218bab4cc7f382fef0348e0322b0ffa51834c00ede302cbbe290f15778990c7be6e56fb6230e785818b3a3b8f11282c8b3a2c989dcf35d113a7f45c69703e12ed0a0802e6dc0b46c464b1786cf67b40e486150bdb435a2758ed30383a1314ef41629904c029a4a3aac7e442ba4adcf3921c38e12b80f048dbdb4eee35cda153c4af5b895425e191fc60e81a43fae2229faa3eb3c3d4f3ceda482a4d0116a11c15964af98a5cce50bfc0be292053313ce422ee924a7b3c5aefaf7eafb53e92a12b44d19b02aea63c85f14671b3d161239d607fc18b994968a40a4bba7684baaf22c74ce950c655b4daa6aa5d576391b61c70336219cb310f61076a7ba48bc0b111f8c5a94f88040bb3edf9059e1c550e508c60a2c8751c237b744a8adb5606c64f7752e721dddcbb639479291b6f1ca5ab2bb70d450335b893e543f1a089f09b1903b21ec5a08f7a8cedc389fed6dd17fcfa73d6cee60094beb8adf4cfd34482fbd21b6ab9dfd8a8eebc972c12471e0bd31bc6104b1dba6a842d8fd758f61029d4ea5f65f6b66b90a9e77106bb34861cedab4e2885701e8cab97620f9f311c7e0cd4b2bfd93ad1fbfc83ce70383fdfeab85cf7d3fcc2cc49e5ab40fff5d13d5230f60855d092c6a0bc3ed64a566bae7a9986122aff8b74f36362f8aa270a2299cf6d2c2f6c8980a66a88310555422954924b47f4c6b1358c07734569fa36c3c014d0464ae6d9b496613255d0c2c81ebee7b18e3628529eb6c2426db33fc2d9c5641710cf729f0086e505826f3e74f59beab52ff84205e3d6e63c8761fcc6080679d3af47086b84c17b8faf7a9ce2e041da5ac451a71f9152a55cc33f387ec5e729658dd86e0dd5cda17ebe1aadd15afb27801e88e3746fc38e43acc258e3e48ecc5446e5dd3918f8ceaded475de3d95a50974d5404e90a4876ec0f50d43e7560b3fc443e788ef6192a8987cd257d09b33214b9fd2ce4a728cc40a190486491c3168ac822673ba1572a42fbc05863b55d652c430719422372f0060f2fff09a0a2db0f3382e5f8b4bd657e5f7be8605bc9e1b8c7738046272f162d8d3b19d62652028bb0abb1059a57ca5f2d77f4b12f32ef95ceae2bc23732851946ac9778e3c27bbedd66a210567c4b6a390dadea58ebb0262a103e0fbe1958e1c88fc850b2a2219739c2802f0e63fdc9efc31ba2a03468dc0392f7b0e3de17be90554b83d21986c039acf44a951984282d64382d3244cc00a858dca5a6b5875aab67832966cae55d325e9f1b3e9d678ae7d6bf084099a1c7af957c5b94c72359ce40d29edf773def0c1dbdf5e478fb362e314a7cf7948e323c6a7a88fe8d63188705119b8089f29fc2d64ba27cbc2de392485b1c8c511a69b3d49380df7c73ab463746f114489f284ad6338285704465a2c00006bf526bfca4789298c1c65fb68062a14cd75fda1e989c4352ca8dae0e33024c3a25135356edd3aceb2638d9035e82222dcbc80882a3ce5d62702dc185c0caa53eb01d005aac66428d99b8eebef68c7bb7f291b033f708d60dd881c964b1cf2aade2bfbe51ed268646ba67020a2205e40486919614b4c3b204fe41400214e11c0f42805510c1515cfec45536d487e7267ff12fcfe694bac7f059c164b921abb7d66c35500af51322b3c873cb026e500673e93193acc3b6a6d09b43ec6e02cdc2e891314352f6722a05b5ad92a566e17743489517aa6d8065d3af780a0fae7ab42a1d50899be2390c1749d17d2d842fcacf5c1ffa57e510a5a783cddb0666a501fba12f7a3cdea8b1fb75e0bbd2e1f0df0ddf84124179059bc2349435632b3e26e8743d485a776ca7fae6aacec581c548a42cf24e78d2788177509ffb88d2563a4c0f0547a256d1e6ad54f5a392e0c9e2df6e2d82d24ac99060dff1331c39495d2b12de034f1f5e2d27481fb92999a0c64ae05670177cb320f0dc66abbc5dd8d6c3ad5ae496b876ce09c9671d4c726a0517055b12370573b92755233128256b7ce3e603278a6498adfa60b4514c2a4bf6adb70ef294bf8eaea21429dbe18292fa434697f52813445c43d8fa59ed6f3700b0eed46be35d4500bdbee5940b5ef8369b7cbc5ba63510a94fbcffed962aca8a39ae973575436c8f6bf7d751ac55763c082ed9c74268473f845b9399ff52fcb06585ff48fc2bd1110a76eff577b4d3617caac50f90b4c1f77b084c5a0fd7aa5068c3691a061b3c55be58dc38dd925c3eae5c58b323e97832735cf9b9bfdea661ebf8dcf37b0ebdfac7f0a7fbe7c1ae8abfbd6dfdb547ae86f0c8ba788af6018ba5e38a30c2b7c6f9250b4c483ff5aa15855db154243292fd69cb68c7467a91d41d75d84dfd1f9f7a1bd1307b6f8f24835ec57cb6144e44aa7c17a739c9d3fe3816f9f4ef587087f0082ec3d95ea33588878a38f510bbf9b9c1164d352cfee5337064c893c13220e1dfd7d359c41c51e3f1b057559101ba89c7b85b7d0653880db2ca5265a647b5c5524eb4fd823e38a764091ebe744b377a3e91ee417361b6a553f0be316a3f290921b25d359d0028a34419ff3ca56ad02512542f72c0274e79798c434ec2bfcc4145a62f6d410ca446fe8fcc4ed8257c1f06a0bbbcad0bc3de7b622454857218c295365b1ecfc1babfdd6a7fb91db7f1293fae00b05f6435cce72b4bb8d3c97e70335d992d5192f5c7509efc8605484962f6ace1d2c835cc81e8f30f4f3b298e3c62efb56b19e3f456ed4f8ef7aea55f3e9879509202cae4a8ebcfab6ae6e6c52add8389203ee752f987151dcbd1eae519f1041ac5c9bf7b47f29746ab57d8ea804971cf80dace1b37f5a10ed0b4466212975f51dd5759aa3eaf6a67cb535de10e043d9cb9fb479d65f241a85c0bf7ee3f16f05df3957359e496fc43de093b8d731580f8710e4a2f43db1f2bf174c697530448859ca31e328552678d221dd38b9068f4e52607c00cef9f29179bdcc169c879be942f059df51cafa5cde2b4b64b368bff4b47db3ffdeaf58f25cfc20c7a424d3dce14a3d7a2193f129d2b1087c94c92cf7480cf9c897bce5f333e86fdb467394f04a9fa40bb878b60c14bc631022e16f10fa77e92003b326c38b8617e6ff42ff25851d11dc26072ec83efd9061454d672f7f0167ed121e57e9d38077027b11fd934ccafd1c0e5fe0fbb3bab2c34b80de660ea326770230a53172c3f9e7f766b22dec4d0a3b50091fde874623dce7c23f3f5607fd1bac7421acbd768512c913fc39b0682fcb1ba8d44e75ef72204701c9026593e3d8af7f6ccd69c470d4f0f513ce1ac299a1b3ad645206bdf6200c754b7011b18823a68fec3697194f3efdd64b0df270764adcd7307258f0f869c0e4a37a47bd1127ee2c06c89eb545a46b1156ae186d259f4021baf6917bf2557a781442fc4fe258da0e9b64177016c642d650f7c47d3dd62a6e50880843ccb8f4895a983b55c2c6a412d61fd08ed91226b2503fc04c78ec2f2d19db4bf6cc06d7d7cc693f317929cd65300ac7e1ac86e2d97e00a033dcda25c997a8f236e115c5ae495f42480e693e426145b2318c284391522b4cf5be6c070e552de8170a8ab7c1aef820fec600073594d64fe3fcf44f3c0ac259f13fe02ff48cfc21ffd06811ca5d93d61ce0d7e399bd5e0224d037474b5e6ed2af9d58cf2b08168db25bd42edec0887feab62176f762f2775a4d228dcd547ea5644654c6036e5fe027c636429eb7be331324e69416176bb1fb854357d43a882fb53bdf5b34fdacb6de625165dd9825946f463ee03aa30a37a06fe4be8baa84c63a994cb3f2fedd8c5dec1a3ec017acd8cb91d3d218a02f026d86a75982d943ed5d7db7c42abaf5262505ac95718b1195fea0c4fe3de5f807dc51da50bd00b74c3d78f8f89207e56b919e839137c48</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>操作系统</category>
      </categories>
      <tags>
        <tag>private</tag>
        <tag>os</tag>
      </tags>
  </entry>
  <entry>
    <title>os xv6源码解读(操作系统接口)</title>
    <url>/2022/02/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/os_day1/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">
  <script id="hbeData" type="hbeData" data-hmacdigest="21426ad87cb8dd9a870a202dd6fb89a1251330a87ac6337bf97cd158155da9fe">10d79030e8222445804370796b90fca1b3149e2c2a0f36d6b4ea04e548758c2138c82a57bbcc35721ee7b1ccd17333ca678da103cfb7d50eb4bd8d1c4d1e4ad4270ee2e14fb3d880fa811f891a8a19f49f2277de30012c62fb0be2f46ce99d5268fecc32a3866cb8986d41b777f30a370755a575361176168adbf8dd8b5af1c2e09e4acbc5314c7b9c8a4441d0f6aa1842b44bd0c80c6e677c92dc5b07f733ab74866c887ea33d5ae3a78de58e80ce88158d085d2bbf96d7d9dbf6ddb5d836e3e5ccbeca5d6f2c621398c12f89c9e6b48c191e8c5e42a7d9342615cfb7faf899c4102cc9620d5a49acf2d532ea95f113351b7f2bd54a8392a6f2cb66ebb10898a15cb43fc3e0ccac2fb5c8d95ce0b9cf72258b5fbf34a0a3bb203f3e9d12eb488a9f1bfb91b8edc262e09bb671ae760286d84e9ecef3d986662223ca1798be0092d79240786268dbe317d34cd15ceaa5f558b8468c40d4a7c4b78de117ffd211d5de213565be5b1bb55eef6a9d9e2ec8486b90766cb3955b7ff07775571b3d86a330bd25034c8f856f9f6d8d6a8455ac5b6734aa8503b9f95cd1064e9e48bcd085feedc47e3a83a84681605cf7c398dee486e5189fd13c4f6d08811a5448fd72e20096430a4ac8455435b2c5356549dee9dd4e6d0912d456ed2021517ecab82917e693e9fccc631639c02380bf0be4eeb308c16c23e1f808ac51d582801367a37fb59d9632b64981d7c318ae1a8d0f8331dd77f92c7210d3155ecdbd146fdd22e0a1358fdcb7388f0a30cfed1b7cf0a3c2c9ccfb9bc488baa26d7925aa76a79d32499c1dddbd8d424ba2d81a48c4e29e7d94853637d5b1baa6d4e05ea652ac2561792cd38bce7404757f991c60dbaa3eb4d982e8afc05f3406bbbcf4f6dd7dff1587ec6ceacd7011c7b778f632136f22e7e37ff5376b15214f99a87fd0f26afb6d3fda2b5b0622a4c491d3af89fe88f6b5d510ab6dc0c0dea977100febff02543c23e983e169533cc8e30eedc7b4f9df9bb9cadf3e3380cf26f4a74ffa6435a228dd09c9686cc99057bb6e1f7fc2d0a05b47d8cab8178cb56c5f12266d948337faea93694b53d2e5743abc72eaf021a7f90816e212bac0bd31eaa07c766ee8402d5057b13313c1c435bfcd888ed3708a997704d18fae45e82fabb8a4b68092da0e5074c9324d8a0b9a6123b4b3b14baf5dc95ba7c66aa1f13e54bd01ac9193d33ef2e3cad2e5b572ac23a0b44bf28e41edbf4d6eecf516f5f299fb8194408338e7ea95ed7505e915687bc26e1112ade9e18fd39e50a6138f68a7a1dc4407588a755599324823ce7f809b8c362d7413fdfa2c784b904bc37b0a1e3704c94355bd718c98b39f4d11ab7a899681de75bf2f916b665afca0de770a8553824c226cba00addfefe4fc10fbf3202f0f7d648281b1876ca9cb94c0d274ea0a36aad9df4cb970812016d470db549d62c6333447da71cad2e0cbd1a9ac84f9e714de928e7bd31d6bde25e3a4cee2fa42d5351cebd53470b2ebdccc2aaeed8f62a6d910c046741f6f13c43d42c84a4e68cd0f48e51fc4dac0db20e5bbfe065392b11273889ce8cb742599dd1a43cc60a7e63d3014995412df703688ec4d31986caea8d3df152d273c24c3ae58fa109c101d7529b2730d7f1e1a2fe3948965c05057fa04638adbe6bd532914a2e1ff99ced28d8134e5232e60d516bf653efce89f778e798380129f102d8fc46d2f610c0e15645e6ea62f446ac2ebb94b2676e19eff6d1c33f175651a8cfacf0e3e1d96ddc498aff89bcae81d86dc378ce09e1860a7682c863618a2e377f5cbc1ed7d0915f282b33416f3bb032413ee3850822cf4146fa068ac99c90760295df851ad6faa9f900f8076d0e68d4dcf7c377a07b55c273b3df8b25fdf7e3c3d0976fa1e4f4fb6fc765f7ee1f395d196685dba9a0f6993ac2061ce23547bd92ef210072a1f2747fec5bf80446b8f443a9c82907a8c6c0c215dcb0c972cdafff63ef780e4568118ee7b8cf2925e3421d05af412de37766704a2332595d85fa1788a1ccf1322545f8f9f890c7a19979461d4682609101ec3237da5e5c7193ff72375d8b5680eb90f94e5fb8959686cc9b343a16e1a7b4ceeeb072e7800887fb9bcae49df3cff9bc38dc8e561252c5d62fdb465d5ace393c82b3f0e65584b00f13621eaba7bd60ffbf257c6e49fa700ab7fa7325bdd360bbe8a347b4839900907369955d31665c70d37a115e64fdaf0d67c9df9306bdb645ccae86ce64a7871a6ed77093abf760432a2301e22557dd35b7a8d0d2e2d374c3425eb339dd3f9dea62b42eb9d1e127b3fc9e2606959d2f9fca57d25341ccea65a322cc68060131f797c863be6f901c86676e2026bbbf5ca9c6cb745c5066281b46852de9a598de787928513d52690472ae842574acc89922573a6a29446cb8444b900b59bbdbc5f8cddc598a1924647879a3cb4e2b9c70468d0ebddad02422c3dbc705804dbcfd4317e7ea911da485e9c16ab705ea853b55f20ded456fcadd140eee2c6df9dd4756cb08cb4a5a68c3c0934c62b8f371c50c7c569ab307384b713c63206d9ce364b1bb6803f4c75e3e1b7fe1eb10c96b8a08c0a803de6cadbb7e9a3be4e3699a8a7a67774efbe51ce39fce624c265b2c132d6ecc509e2134344b8e4468ee3c0427403e135d4d39340ea53835e9b2722178650bf1d0fcadd40ef36755863af43a0a0bed2ff46c601ccd12172186fd853d8ad667b5b92e54226051b2b80cb4f6dc6d26a5304504346d25453282789ede58fed2b298c30cb08faa3266ff65c43cdccb2962ffb6511aa210c58f7f782d19fae3a270171620ae7dac609217b6464b00d8d945505966d8403d2890efc3ffd84a4b42a21c71b40cc92148819762baeb938166dfbb66e4d2f22f3a4ff6b6ecd96f2abdc60db9a1676e5b9abaf1ae5f33f30c246cb3e0759cd9b723b426067e0b4cf5b3cfe369b53b9ce9d77ee4a75da9a09b3712fe584a247d373488a52c4bed71a349cdbddb27eff774900ba2100c1432298b96b1b5c61d78a3952529b55761f1aea955dbb68a7797f368cc993a743f0087dcd968ee35f561f2de9204bb22f63f18a93da017659f3356d9731f009e6463a29985760443a863f4c59402e6b58cda9731237238f9306a9a4fb382d16b57458c02854562a116c616fd87c5e112b4f8e68e5efacc2ebddc03ed2c668a3fdb4368cf080d4ae372673e55ba857aacfc6f50ecf5e747305cdba6a607432ee70fab0f61bfcc70edbdd36119a2eba18555887bb701d4da0281d09431c37b50be60ea5940a31ea3ffe8c60e4e99028dbcf15bb12f40e4cc7e4bd64b605e92b8bd8b21d6778f5b9e5300f8161e693052ea20767d434ddb3423c42786242e3d305e91b5160e9fe052b43938b9c55114f39bbb282253f7f24bf71875c9dd7b794254832c94d71c080003e5d64a541ad52cbe7cb96081a4bfdf3e5bbae2bd557c2c58d886c54bae18aeb08defbb520865dc73c986ce27a7286a9c2b9a815a9ed03fb03b4ab6b8f7eb0417b27358a54ef1a8c57a3683ffce5e703f0b06dadd0dd72f51a47f45684168a0fbf0dc59f513525b8beb4a20fc6023d19c1b3b2c55f3c7b930ec7eefb8ad0ffd7fcd527dcb8bef02a3ffb7f248135ae120d408e7e5ab6f12676d4d6e177777eb0ed0c1ec6ef7b4c5a668a79e78440f4777c4181216ba16aa79e12ca8af9381656d48ae747cf653198227c46d0ce8e1fc5ea22bd3032409afd4edf9e819218840c12c367e97eeef98f078a4f4c11def8d654c44a0f6a0094a1fff2cbc3a325e67a7200554d9b773327b08839b2fdd03ee2dcf38d572896e059e0f72614c6b221429456aad7243cdf7ca3580076ec505a9d063cdbe241cb91bf6ba35d74fe9a64f7701f099f9295df6a790f85ff34cdfcca396352f692ec16e198245a8234a376c48518303fd79edcc3c2fa956505a6a060ebe35429fbc57be56528be3b28833840e3318cfc16dc81dd45530dcb0f99162f07bc9bad4cc9912dfa1e4531e974c130ea1548009671c597b07d12d257fd5ea13c3c76bf4779f8067158c7eea023e44967d5acd869f988a9631d7c77d2eae1b594e36377ea51e5ce1e190bb850dea4a74e4bb0d979e4df7a142e273f2bbd3fc21ba731f5f59896f086354a087ec67911c8185e98dbfa2f02af66a1f1237f59d3b5a5f14128fcc8104aeb7b94634345ab038edc1b6022141cc1dabf2ba9dc01e9544153ad53f33c24e7078b570200f2a5ab35ee711d9a8ac9976723e5e01661937e457c5b6ed70e5d458d4744b623e3c062ed8d4626c577518adc0a944331694629ca96db2962e96ca21b49e1fb73e7e2bcb2a7567df2d5012ba833dc56debcbc094e64f18c198e9178133eb0b412794828a1544f94f424dc3172f86096fb53ba13c453ee301bb93df2029aade59c93d22ce2bc5a94469309007b624cf901ba16f1f6803c1cda7e1eab2eeb04bb312c1a642da5f9c20f4a1b75fa365e8e5351a2d4984d21049c4c396d17d98ceda50470052804a14c0be5e239558a77be82c0226dffe2aa95cd5d995642dba41bfe68cfee9a665b92abf2d3de09426d942a4927a686c09536db1ba23ee0b0d9752cf63162a70811d0bda26e998e889b5cdccef87a4c923d9c22b418f5d9ea77e69e20d017336b922d8c8094d5abe32e1f3db6b3ea807a41e31900e26bddf187daf6e6960eb550abd464daa5ad8079471cec755489ed8f753969235998cb841c3d140c4f9d0b8e4f76411e6f0ea1ea74fcf87a8ad9ac4d86a27c661d522368a460211ef514a7eb30614b44eafb3e7563c5c731cf22b2175955e260049da0f650582c96f9328956ab55fa886b59eed37d1ba781858b8b189a642567ef08129593034e049f6e0cbf6b42629d4004b1bfdeae21b9faf9b6ba670291921413c1b1626face1952a17e4582544c27aa136ac07018b1240d75ec8a02be8ec4b45faa39f447c4763e8b9aefa9933062d1f3ebf976cef41d4eceb1521a2e53c6d295fb330737876b1c13cd9272e3f2ff68549b132258a5770db3a24ed61f51d9fbd86c1d904dd60370edcff708111dccb90d681f4ffdec29b7598de510cecfd2729b5534a8cbdf4dcb4dafb830ee5c9196a14caa0cece5aee4fc186553c0a7f98e7d78dfe8f603da039eb9ebb7b51b78645ed4f4e730853098854e7a3e3811042bedf81d4ad5a675c2ec4fd84b382803478cfb4ade4dbd27609d40b1fcea216df6cb03d3e1667144c31bdd6f321f7062988b7e5dd879396536112b6a3de9b635b160d945049ffc662ea273df981690fb919ddfe47a0a8ac4c9f733409928927527b0ea62ce3078c06d3381bddd0a27e0ac029bd6bd499ba5d47c7c621e05924036d88c42135224080a19d48b1cc63df4860610482484efd992413f9ead3024d275d3f4c7f53000b9f8b646ae93704dc8424c0c40690fad95a648f34a36b096edc4c75f3d89f75708c02efe710ff5425f738ebeb3820f588ed12f219b76d102d083802d95cffaccd2832cc925ebd68804fb5ae6dee3ff790694ed06161f037025b259674bafe61efc79b15217c2ac670ba141ddacb2c657e366aa59d4fab13ad71af5e6a33d7ed431158f31bdcf4827beb521383175c15801054d6d087c7d4c849db0d90e790cab622bbd43be8500f9b1314b2447f95215d2c974fff849096aa9dcc4fc6a0971abc9afda0cec6f2366aa255dbb1f8be9b7cf47172ad8d8bdaf3415f1b02a60739e4a21fd125a9f2da91b4352cab633be05c0a6a84a0c2a4bf2c8ac927a2ed27c2063a26837bc158d91ab90653093ce6de5363b1c08dbcd55862e7feb6025c55b7265271f3fd772fef790992250c8c399f5ce320d441f11c9be91da35e07282442acac30bee68f2e627cb5fcc1708e3aee5f276a4a2f6ea8394f00f68625683129dd0e5cea18569e314f4d1009e7a86938bb2456a4174aa0265d54da4e1b6c09092101264453df7d2fab921754fabcc9aaeb98147764ae5ec277a96468d59bac925a5f95a8974564cea688ed66e48d9df575417d8f5ed339b61af11dcd7e2713273d0ba20e8392a8377420e0f03def3b64b07315e0b5bd6700b46110790b3000979a3617a3d33d5ba5b48d3ea6307e27516eb8ac23d92860afefd9f88653678dc2009dc091270d1404bfee9b97923eca690a92598d66f7932007732f4016823b7aef72fe81ab9d9b39818510fc0ab1029fb98d3faa16c49f6bd03e3ba85e55d0cfda58f6878d1501b9d83600b53ddf9192fc43ebe746f916af241b2eaa558d5d1fe1fff50d1f02c70e08f03fecd0bb19a9738518712e5047d88517a7677b891646456fc1716ed580b62e70506e3d278375a5e04b5ef1cb1fa0aee6cab0bba975ea2efc7daad922008c0ffefd9bb7e4f01d3abf3ca19ce8314a254145cac29b46444cb4582191c4d72603ddbc081acf8a07bfbacc8afeadd46d3a4b2d45477ed0e32570f76af80dab123ada1a8a7f4f76f1ca987aa66fa4028fa014e443558c9616e347c77c8388fb9b29f68b7c1b596e382d1150e7dd8bf3f52958b2d9ae1e38f20c104f54b75e800f5f0f1f51836471ba7803e979388577c61e588eac6ce623f31a8ca3acd2a2c9ea87af0906d4f7b981fb9c50171a6793f6bacc4f66872f505827ed455024004931ff51f3fa581f584d1fa30334f2378fbc279359bc5bac030665b3fad0a7e84ebe273aff1867d0fff73bfa0fe97a342db307d17db4f0559a12603de8980b07d9efa0a8dc9483a35f493029b43960cad03569003bebb87e0d5844399424815cffa837448618e927c5273c5481f91e6b35079a96f383349b7b7d9819fe3165cc5957218ab3b833291e4170656d4d121fd766faedd6a033ea732dc0ccdcdec6881896e62c0da8c0f61ccfa9d6da24b918e38252c9a1e1bd83c835970ea67ea40936b5fcb08a46af4e2a23d76e52321cb9b35b01e1feb4988577ff64b6734bd69950093055b0c2d961677243b44cf0cbc1c27001badd499d215c3638182012f1e1f00b59543598ce9de7cae3cfd2b1fe6cea7d5d84d0bee816c8747ceaadba5ab4650da8040488d539ca15a192c29d85eec9bdd7e6a2d3edb0db6ce8726e90a2a0736f88ae688f1e88b14b41dee3bf33f2dc83d20543d8fc8c97974cf5cfd9b65419698823e88dcbd0fe2227eb7b06eff21fd23158704327c844c6eca8c894ddf45df3a3ea7211a789cdd59d80f8dcaaa57a546b46e482c72a7ed0150649b2c7380dd7ba4db1421fb14443d422daeecdad5cc781d1c647b6717ea03bd467a89799ea17e62cd759cb2108d3206f076502eb042dbc36e6c89f229d699e5a975e96f8a5bd2a8ce43a2cc27146e51321c73616b1aa2afe250cf889a27fa4a81a23dc272e27a0b76b2717a498eba55094c27e1217681927c56dba9a6b21851cf70a96974ef442b6320421fd0f3c456d2ea080f258b8798ce71855c6986fb0c6dbb8b7dad17f09705d7a2956319917b8ea594a7d542db65594ff07c2b8127d1189c9ba8e07f557710a0d0baa370b603055069f202db5c3d3c52476b504ed8bdedc273124d843dd7f041654bc707d6c33338476800b34e28b73ffc04eddbc026ac1be6d8177f6b7abb9e6ad60cd115c9a6ac64c2e93da8003c25b2c6ff5aac0ff20c138316ddb862086a78eca9e575c47f64cd4e88650f0bfc66a765c42757c89298249cf0c927b64403006c9bc1ad8dc2a5e0279b92a96cf717cdd0778152afdb5212a5ccf26bde8082ab5f05e0487f63d8c44116ca16efd8c376b1656d62dd5f8e219df71f1369afe4df969e9b2d1c4b21e9541db525b2bc6b08177f5ba6c9c0e2f1e384d04f7555b90f2dc75d54079006ea6b67b4edc28ddeda0d3f0283f2732328e9a03a2c146c28e085a667885a59ef9cdb6aeeedaa300897177376addae424ea9b51f81ddc49fe7f526984419ac404b4876907f1769d674f035a76a063831ef78d76bdd30aeffbdfcbf9158d6c921663bfc35caeb4bae906f81fcf4b6e6f0998650101e094f9531fa9877e7d20f3d223626a81fbe7cf829915896e885663c2ba3585b58a08d29b42e73bbf3d22919e155822a84876b432b3b9e95675755ab43d1dd4ac52c20ec455d9ea77cbbb79f13e8a4b10c56da823a60c59e5774076a6fa5d93c7661e7a3446189c6082db440b63d6320a6cb2fb3b5d95a8b8489f1f765656fa22eec28af7b2f43ad1e065f1b0e775c26edc1caa6526d576b1987882a1aec25f3088ffca4c9a16f6b468b58041a2f20c91cebb45a2969dbf218981f929276124ece5f3731c7ec931d2c1f8d895ec63defdd0de7c07a052a91be4a1b13364ebda5e94c8b49b872ad7bb27da7300e8e0048912dc4ad8b091593798bc6252302cb0a51e6b3a44ba79f13f55eea10cd3d42653a75e9c3c3963b00b5c1a73e0b71f675513def6595802eecb77888250b45abe3366022ca926e823318cb38dbd76fdaafc3ada863ae4bbbe8bf2e0a1c8dc717790aae313bf0eb1821defcbc1fd497f65b328666ef778ac8ed964d8145cf076ba80120fe447b404db27381d66bcadccfdd70f24d0f78b359c8510c7c9154bfa52a43b92f3668baf0be14eb125c8dba2ab9222719a698a739edf94641d72feb317b2a286021da34a9e87bcf852b115b8f7d0e92f33e6d1b44db22bcd2ed614c1d82552c33c4628a242eb4c6470f9b0394a29f6dc51e63c458dd27d457ae22723386b4990c9ca00c43416fa84073af37398ffe414592b31c8ba90ea4c62851ec5b6bfadb8d6099d96dd3aabf126c95412db3560d008ceaedd2e2e62506bba2b2c64aca1fd495c3118eee935bb5bf20bab3e52f56302fd4124b66a60cdbe380b920eb3f2370ff5b4bdeef62e00bf8805eef5ac058926e644c3006b4cff6e8525a9a32b401ec50bfb2e59f511b3deb9cc7907968fb69c57657ea1bbcad963be534e391bad8abeb12912446fe1bfa13c1add5bff5723e3e8da7c3792d3c1be0aa79cae582879d40a2aec9cc0c600001643e8995631c6609fd2c59f5c25e88b39e0d99524873efc7510aaf7ba1857a5010cf4627bc245cd6b644ed95e572f35414e8e9beb15bc789e739c8a3dd03ed63f16c23b08cd8108bdbce26d22bcc249f51f112e29acd304294e56dea12cdbfd10bab7b449476118e4d0dd051cf065f667a35be9f85907caff398f591ad15513585cf15e8d175946d69a4089bbb197245ce658788cc0e1550238f26e3ae46613feab9594afca72fed11abf986f4d84bff14bcc077c3191185a7d6c8919c873f08c2adaa42e021e25a60fa46b03116b8d7ce7eab35981c7772b81de8218f1d6ea4750e2889f4765b1735d1b802c9c700ff7063943010d9f648bd50a49dee8a9647ba4d867c40e3115602dccc111b99a4b6d6d9d1294c29ca521eaf0a062e623802b3cea2e3009e59f84dbab793ab054ad10fd192fc7840eacaa75edd355ee5f3ed724bac9d32c6e2a084a0317b31fb30d2e1eba2e28e542bfaaa0a633ad69b2a8a907bd3f7759bfc4f7ff13af0ef2eae442df77c7c8ccd5d967cbef8376403b4ac761a7c7c38b4b254c9fdffb9157d9cd8197bd3bab1b8206b4cb3531f8a8d1cb93769b34176c668d627290fc31fdb8611606cbe89be75659521a74df940584669b67f81df36b699305cbfe551d773de83446677b87cd131aca35991b23facb5336a67ca838bf70a2773765437e05c85bf43e037d35522504bc8114d5ada0174d6d51cbf8360330791fcea7f19ebd7688c783a704313ff5a7a41f92cdfa21b03ae1e405b2efc26005b2ad17c5b966a50acb86203eb3239b4bc0c89e97760308954e11ff0833ea8e1ffbef94df80e9535d7821893d60670fc2899253699a1ae1720b5ecd3054d5e2157cffe2f66327cbbf15c045a398cea96efdb2214900f8411654e4f67294b959c02bdfd1f643f729fe1f70486b056b94aecb9ea77309b3177f9061f8aedcfd2f7f4792cef486628bde1885a81ebc954e1af82b6ebb3d94e34ad82b0ba3e6d118f1b1244efac613d267852217ffa503e4518b3043a35861b21ab1d32202ff9711821d5b35fd9748b127791d8a79ad66520ec65a3f0c704d2350118b805eacd684c809b76935be04ebe20fbe750b61f62cf6e0b0662b1ff191e0478516bb99b822fb063f58cd376ed81dfbd5415bd6ba0d841e90cbe50bdd29fbae5fe65242084c8a93a178c1c00fd85a59865c8b0699be56683d0b3780afc1d0e74e4ef04c746589e150593ec264c9ac8a0e90117bb4daed26a6dac49664ef98116bea033efd3fb31120186cd645b4e088829e96093584e22c48db067967d086e7405ccd42d46b671d6fb7a6f3e1ac00f705fa72fc6b67420f7b6faf920884cbddabbe433ca4dfad6b855253e3f68c80367bce62fd3e9460e4234b3c399181c85186ba36c18a314dd24d2b0f07513ee98596c38eae3b7325cbee13d5cbeed6b8c88fdea11f514670241b1156c3c3839500046a02f9e682754db5665da6031c93db6e7049328f9ce36770edd35d00ae4755256e2eac69e0c72e5e34d82104a07d90dad0039e444cc32a8e067bfb9358d58092b20dd0d3bce4cbf8aa67d07e0458e1f269f9c7688556d2a34bcd2c98cb6ddfd58806daafc70b1258486d3515f5ac5cb518d7a2a75a6e67138da5a9e49672326d1a6768288f9b7087298fed4ee0a50f11690fb2bf1c6d7917e67d999bd779236e3af0ba88c4187d1cbf2d048452676e884a4b364dead8f0f257c173fea83b40e6f912edc005b138b40f9a4dc8e0ec59d7541c3bdc6ba189352573c804eab24545b62454efac4832aae041266735808965c97e107ebb0c5893bd6ea7971bb6ca20cd789c3bcb18ca72f0123a00e8784924720161dc8ca55feb555b5473504499259e1f4a4087ad40de1b30326e3f2fcf431a4825d68313fbd5f2375792f0b1574f048fb00d58437</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>操作系统</category>
      </categories>
      <tags>
        <tag>private</tag>
        <tag>os</tag>
      </tags>
  </entry>
  <entry>
    <title>os xv6源码解读(操作系统页表)</title>
    <url>/2022/03/25/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/os_day3/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，您输入的密码错误，请检查后重新输入。" data-whm="抱歉, 当前文章不能被校验, 不过您还是可以看看解密后的内容。">
  <script id="hbeData" type="hbeData" data-hmacdigest="bd0a73b7e58c03d58f6326ba1dd719fe5b329d8a99f7b6e3e24fe492420aff83">10d79030e8222445804370796b90fca1b3149e2c2a0f36d6b4ea04e548758c21ecee1ce7bf513806cbf8429e266592cf7f0e90d444665fe18da927ae66fabaf7a2aaeca2eb156af26bd1b337818b5235c509bbae72efd08a57e40c5818a223d6bef17196b01f43ea9c250e0db5f57daa464bf1351765cf2e3ca50d3897c98727942ed5ff1143a95ae00323ab894409cb572d4e1e7da371153fc164aa0bb005fb51a3a5fd60259849ce0fe3c60a1e2e57ae3f3613fda62e2f6155f5277b47b227045241012c1acceed608b5ee8ca4e2fca5a2a91b0ac85eb7eb149b5095394872ef9437fb8816630a408213ce9f1362dfa95361b2c8c726a92674ddc875b03fcc09639c0a939b5aa17169c6461116949c9a28aeceffdd9c2ec42677d6f17d09e83efbc757797aa8a54b50253010d7de4b56723b0fdd869d74e945dc4eb8c26cd0430566617ca32a8aac9554a4514c337e4b9291e1cb4acc559205252cf407e152a4e05cb62c0f9d0b48a28071e405f816f2b6bd5dfa498424eda06c37bd63ed4f0907c9798c2430e93e5e02f30227c17844fb26bc2e00512dc6be3a34e1994d7c368f8164b8347fc12d15d4960636bbc35f9b6bfc7dff98a6e7f5b2029803166e9925a4d10dd83b5ea7b189728ef27dfc83b78b916664e77974ff2202cf4dfc47a480fdc82998c560cfa09917438de791fc252f83662b3af78c8524b632fc1a3d1e55d81fc16efb516ff291c05fd1d2d36c30375176c6092510ad9f3280181bd7ccbc86a3d8490d50aa534977d5435b02848e52177da9a7df0dbd82ef66d445e0c77708e30725143418d252e0735d5df234d3eb4884f35eb07b17ba287af6dca89c4ad36fca6c8e78d07effeae65f65563c9268cb49f88d92632cdd83bcc897b514373ffeba7776ec2acad4f3f009fadf448b4fd817bf9db077f60ffde3e471781e70a2c5cb0a7ed0b9b5018a71879500b1da9d345dd3737f630d628b95162338ea02a40687697165cb32bff5c12d34fb86c9a8722408c4cd9c4c5a90af30c56af3f1b7fa7709457511bf262851a04bab3206461ffad5de6f0939ae2d0269b3c3e3eb15b48bf51972838cd22be148e9185ef5674a3a66d726ff253f14ebde36da47b64c4043c05e262e9b5a3eca9bdb2bd2610cf8f7f6c58acee31fe031a5a7ef642b85e5a8d0ff3045e55c15a9afbc998f0ba37ff7006c9f44ceaf6fc5eed8891e34cfbceb06a54461f9c1d6edc037b06057cf34548058f8e7853fe587ff676900bdb53a13fa7f95b082e96a58ca7ddebe86cb77550931e94c2b1e7a922289d72060c638d7c26dca427a0af104b91b426c1a561ce04da912201a9300544226f3669e41dbcc4f1565204c78d0663186866b0b98003696e176865efdf84101da8d7774cbc14ff02c850f3e169907e1d24707158e5de90a74c2515a168ea4645e58caad604f7b8c63809a35bac325df40996247162ea43f4a53364e907234ee12901e7f4b75495d6c974b1c7e449a580d120751c6efaa4c0dec7c3f404be04ef11b0d4e50f8f291491927ae9116b01978efdeda3c53e587dc13d058b3225b962ab9f9deddaf6656c8398123b2edaa8b2631f7079f0e368af28023b70ddef39cd400bbf4d036ea56c369796fe5c75a1dd5df92ffc88bc71840658b67ed093866ff691b04a3d2546824a61641a888ab190dc1d7344da52876779b14d61d42112e5030bb679fd828e4e2d9437a85970323fc21dc57ccbe02a193cd0a68ec81977c0b95e6c534d852cf5ad3f865c164b8e5aca081a73e47d066e2809d3fbf8f07fa8d39c0eccace7b6cb179a3c11c3442ea2992fec239128e570c4b3618c07d898e751967ea0598b3977579b4ad9a0b6c589b2f98af98a964337ddc16149c3b1ab1575970978791469157e6fd8b21ea9de1e11eeecd95da61c9ef1d97c122603f4f67aef3b0c0189b201c9abf70c458f52e26d2c33a3ae4787143862f13195597c55d623becb48783efd601d9298ec1bbd001756152c3dfab7169ff8c6f442858b1ee07a88fec17280596833161e900d161fe7a06e882cc0ac59a9a392683260fab343617d175faf740024715492c0d76a6a6f7ffa6ea10c06f6552248271e4ae6a8fd851dc01e7d976a1ce466eb30c2989a5f7da25778b54d3cdd812d4d3ba4b209e232c318db23ee5fc3bda0c7e8e00eb054e5b51c2ca95e8b981af5b6ad9dacb7274ad91bbb7debf89bee6bc49c6e621a4c8ad7d4aa02eee0d31cc97f22dde1ef79c615fdefe89f6a14e79afc77af5c385e1f764afe9b30ee0a1b796a6c456da94dfdbbdc3c88580d4fe0c2f2ccda192a281e15f698625decd20983300298602ff13859e54c94ef0380fc6f23226fdd64e283698cb6d0f6b9738d160067d4e7182eb4196c1a68717f470f6faa6c17eed456c3e9d908846c14042f4bf3a18ab1f598fdacda05a3cd2b657d0d4cf99ca05b80905109a0ff38082ed4185816b8441db0ecd2e813a47a1bc8e775265a9f015bd24a9376ede4f7b4a540af7de27e26ce57d4170418aa8eb0e6d86b21602cb9d481d9cf9694af2b25960f166456bf2513856de46e4bff41df565f97a5e5b3047fcc13f9cedadb28e89de7a371d02bc3c6ee45c744c6616b1139aff39082c60b9d964840b556b064c757fb51d2a4deb35fbb02a0b85ba6e66a25056112d2009301e089965838d4e767304dbc414efec3b3ebd82dab40cd038922e46379349876317e8aec7090495caa5861b848601300e96f1256447220901e9773d2360708a0fa3cf47f88cb7545c747205e6c5cae02b1d045e5e0aaaae700bb6a582779328e90d82d796182704b7c35927c7f72cc50e39813530b3a02adb01fca6b78a7f279d3de6d9f4202c20c7c01cab7a79e60ca9158aa969cba17f986da4ffa435ccdce2a175fae2a86a78651e7749fe9f988323c7db535aa076e88e5fc8187bf1e896dcc6aa8d409e4f20e7fa06a4e14590435e2f2c6c626ce90db5c5198e0c5a740a3152aacebde7828d0b969cfa2bc8b50351b2722544974dd06d96cceb6f86cede3382defc562d301db0c9965933df042360a9fdb4a8830cc99279df7d2f36af718e379259840717c73a18aae48f7f923531135320ed6555b321d7328e6297d34485c42137daaaec3511244286c302e7f58eb56a22e6c7cc4fabe7aa48986e081062676a63b9225279238de4f9f3bc9485509f725d3cac47f77d8bae87efc9d578052a25e7385509362034035b45323b5527e82b840bb04833178d11d44ff77dce314db6e8736530e917a729999fe4de4d898bfadb276ef28249ea04cff3f28db927c2533dcb2e24191e8ccb26792a803b18fd173b6ba9b4f8cf75e876d4e26f3a677598f3b52f0858b3a838b099b932abbafb6143a081bdb165665be6dc8b2509be48c048c751eef5eb083699e7379f919e4a20793285a8f8341ad334a6e128c5020fb5bd156d757ab085456658af4f6a5f4b4a45dc928e2f0fa11e197926f8aa3a7fdde2d389b6dd43ade8df184b25ef896f76af9334a133f96eddc03b6a2b853f0e38178c5a01d245fae373ce5487f3055f7022279605c5c3d44817313b4b13edae51c3c34164131a7925aa545aef5803860ab3e93300472ebbd82799312e223e0c115ae5ada50350493105832aa6be85e309244d1bc7c77fae80a9d38076aa8fc49a4deb5fe55c17fbafef2fa1420ed5f9027d10f22a313f555403354387c01d662ff78de30e14ea5238d112121fd24b06584cbf5ffc3c91aa9ad114bee83b5b29d862f700884caac97d4e4f4ca80ecb56cc9f2906990cca200c6e0144d513b1cfdc8a99d7707e2e10eede88d52c1a77ac736b4abe5f79a81a7ce0e9498098679bbdc5bf11893728fe3728ff40675dc61a9fae618bc94081bf5e436a09985f582bc23a44716d4cb10fcdff579e73b2b9e304af0e531c08983698b3831aefbb9ef50e48cf9847052b65c12b019087006862eb8ffa1c227b54522469ab4bb3cab21179bd1180a0e04014b37f620ac99e483f1a1cf8ecd4d9187ee0daab887e472a47a54eb779730fb65bf85cc04a4e43c5e420d576e0ed72b437315857468b1b7d64ff982bc228e5589b2f3a71e72c69f15c63ae7fa4c7736f0b1f4e5cc80ecfbe32fb77bcfbb31a39e120229997d40bdc601f82d1a6b804e17083c26c3e376c3e04b747144593d09c92067c560858eaff28f5381fca9596da005f0ac16c7f9fc0a5648287d43eab3915dfa81bf322bf9c111416d67d50a40f0a2ef429981d51ab129914563031843801a5882941611877f82ec7b066c0489c7b24976fd724902f32e356be203a5858dcace06a76b5f3f1078bcf3ff4705ff44a35ea3df07df9ee8349ec53ba233bfb7d09ac3ad21c25dfeccb6e41c4caa086a1eed2db07cf1574bf70f2944d93a01df7b659c410dc7eb81fdc8e7c9b7d8060f5142ce07456f10867d722070482a466799dca102563f0afa3ea9c5033ca27f965c0b4743ce109c112835403d0c87272ca7377633680d3ad1a911c365900fcb411158ac4ca6968f13efffe9d74c6cf6c9f294f34604f267792dd7b8a520d469a1976f9a3b3da7d523621bb2337f48ffff8a068340d7867fbfe0d7ea1ff28b182c51d1e9354ec726a655b110942146a01f65aa4aa3f4ea48fd32f3f477711d47f312564a82abb6c2a4f4629ae8e66dfb6714544a7a62031a314765e1561ebee151f2f7c97678ae75cc4b3685bb6b589b78896b9f25f8778ab51ff0d88b3dc2bdcaf5b7443edb041509e3304a8b9b326eb8805d7d27057eeb4c43d088192235af3db6afffeaed1ab737eee9d8af3a4d6a38e64e652c27311359473926aeb84483c220ec8f1b6d5f70ff9be6e7f125171093b6a0c9eeaf08ca1a69e142cae1d73caf79a2d70c6846235a3b7d989645512ba68957731b45f0d6db4b3385315fea7929cb2f53a4066e59d1319b79d51ec224ed3f7d7e08b165a18dcd98af0154f995f7d3289caf38f0a31b1e401f7e6836c30b1d1935e8a816dad23ea29911fdc9c3d30c3d70e228338668ef8feff3b0479b58429a35cfd81f813dd3cdb5eeaccfc02fa6bbe748f25c8741150a8a30ff4e7fd09f3d680467bb320f19f8a07b5f55a0732570b0bd194d1e7571d9b07b51cde3f7b0beb290d0b9c45effce73c777c9811f0ddc88e69c3a45ad8c2eba434e8e043dc9eb06cc20bf01cee9b91b2123df45e6a1e70c9604f5fcd507baa2fd6f20f7a5c57c764a3a9b521b41d55159be76d1301e53c76fff15829b37f83e46e93723a850be690ba66fe2e8a9ed7b781b62c7f04e8c62be79e80568442920a6ea354ac863b44b4486b066cd3455af26a69c6bfe568e5b0903ebbfcea57d911864579ed9816d0d35e318640e4d37f1c6473e761a12a2692566fcce198111f45abe249cb08b3b3c5d137f75a4b67b706196c89f836aa61cb65dc6178cd01062e400d92507e455e7276593f01e2bc52f1fe887794d538f17cba0ea84b7c56eeb8194e0b78c1d4047179110d84af43b568c15ee6a228fb7d089381c5abb5f6</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">当前文章暂不对外可见，请输入密码后查看！</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>操作系统</category>
      </categories>
      <tags>
        <tag>private</tag>
        <tag>os</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编第七天</title>
    <url>/2022/02/14/%E6%B1%87%E7%BC%96/%E6%B1%87%E7%BC%96_Day7/</url>
    <content><![CDATA[<h2 id="1-Win32-Console-Programming"><a href="#1-Win32-Console-Programming" class="headerlink" title="1. Win32 Console Programming"></a>1. Win32 Console Programming</h2><h4 id="1-1-Translating-Windows-Data-Types"><a href="#1-1-Translating-Windows-Data-Types" class="headerlink" title="1.1    Translating Windows Data Types"></a>1.1    Translating Windows Data Types</h4><table>
<thead>
<tr>
<th>Windows Types</th>
<th>MASM Type</th>
</tr>
</thead>
<tbody><tr>
<td>BOOL</td>
<td>DWORD</td>
</tr>
<tr>
<td>LONG</td>
<td>SWORD</td>
</tr>
<tr>
<td>COLORREF, HANDLE, LPARAM, LPCTSTR, LPTSTR, LPVOID, LRESULT, UINT, WNDPROC, WPARAM</td>
<td>DWORD</td>
</tr>
<tr>
<td>BSTR, LPCSTR, LPSTR</td>
<td>PTR BYTE</td>
</tr>
<tr>
<td>WORD</td>
<td>WORD</td>
</tr>
<tr>
<td>LPCRECT</td>
<td>PTR RECT</td>
</tr>
</tbody></table>
<h4 id="1-2-Standard-Console-Handles"><a href="#1-2-Standard-Console-Handles" class="headerlink" title="1.2    Standard Console Handles"></a>1.2    Standard Console Handles</h4><p>A handle is an unsigned 32-bit integer.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">STD_INPUT_HANDLE</span><br><span class="line">	; standard input</span><br><span class="line">STD_OUTPUT_HANDLE</span><br><span class="line">	; standard output</span><br><span class="line">STD_ERROR_HANDLE</span><br><span class="line">	; standard error output</span><br><span class="line"></span><br><span class="line">; GetStdHandle, the handle is returned in eax</span><br><span class="line">GetStdHandle PROTO,</span><br><span class="line">	nStdHandle:DWORD</span><br><span class="line"></span><br><span class="line">INVOKE GetStdHandle, STD_OUTPUT_HANDLE</span><br><span class="line">mov myHandle, eax</span><br><span class="line"></span><br><span class="line">ReadConsole PROTO,</span><br><span class="line">	handle:DWORD					; input handle</span><br><span class="line">	pBuffer:PTR BYTE				; pointer to buffer</span><br><span class="line">	maxBytes:DWORD					; number of chars to read</span><br><span class="line">	pBytesRead:PTR DWORD			; ptr to num bytes read</span><br><span class="line">	notUsed:DWORD					; (not used)</span><br><span class="line"></span><br><span class="line">WriteConsole PROTO,</span><br><span class="line">	handle:DWORD					; output handle</span><br><span class="line">	pBuffer:PTR BYTE				; pointer to buffer</span><br><span class="line">	bufsize:DWORD					; size of buffer</span><br><span class="line">	pCount:PTR DWORD				; output count</span><br><span class="line">	lpReserved:DWORD				; (not used)</span><br></pre></td></tr></table></figure>

<h4 id="1-3-Example"><a href="#1-3-Example" class="headerlink" title="1.3    Example"></a>1.3    Example</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mainc1 PROC</span><br><span class="line">; get the console output handle</span><br><span class="line">	INVOKE GetStdHandle, STD_OUTPUT_HANDLE</span><br><span class="line">	mov consoleHandle, eax</span><br><span class="line">	mov ebx, messageSize</span><br><span class="line">	</span><br><span class="line">	INVOKE WriteConsole, consoleHandle, ADDR message, ebx, ADDR bytesWriiten,0</span><br><span class="line">	INVOKE ExitProcess, 0</span><br><span class="line">mainc1 ENDP</span><br></pre></td></tr></table></figure>

<h2 id="2-Console-Window-Manipulation"><a href="#2-Console-Window-Manipulation" class="headerlink" title="2. Console Window Manipulation"></a>2. Console Window Manipulation</h2><h4 id="2-1-Screen-Buffer-and-Console-Window"><a href="#2-1-Screen-Buffer-and-Console-Window" class="headerlink" title="2.1    Screen Buffer and Console Window"></a>2.1    Screen Buffer and Console Window</h4><p>the active screen buffer includes data displayed by the console window</p>
<p><a href="https://imgtu.com/i/HLU6SS"><img src="https://s4.ax1x.com/2022/02/20/HLU6SS.png" alt="HLU6SS.png"></a></p>
<h4 id="2-2-SetConsoleTitle"><a href="#2-2-SetConsoleTitle" class="headerlink" title="2.2    SetConsoleTitle"></a>2.2    SetConsoleTitle</h4><p>SetConsoleTitle changes the console window’s title</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">titleStr BYTE &quot;Console title&quot;, 0</span><br><span class="line">.code</span><br><span class="line">INVOKE SetConsoleTitle, ADDR titleStr</span><br></pre></td></tr></table></figure>

<h4 id="2-3-GetConsoleScreenBufferInfo"><a href="#2-3-GetConsoleScreenBufferInfo" class="headerlink" title="2.3    GetConsoleScreenBufferInfo"></a>2.3    GetConsoleScreenBufferInfo</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">outHandlw DWORD ?</span><br><span class="line">consoleInfo CONSOLE_SCREEN_BUFFER_INFO &lt;&gt;</span><br><span class="line">.code</span><br><span class="line">	INVOKE GetConsoleScreenBufferInfo, outHandle, ADDR consoleInfo</span><br><span class="line"></span><br><span class="line">CONSOLE_SCREEN_BUFFER_INFO STRUCT</span><br><span class="line">	dwSize	COORD &lt;&gt;</span><br><span class="line">	dwCursorPos	COORD &lt;&gt;</span><br><span class="line">	wAttributes	WORD ?</span><br><span class="line">	srWindow	SMALL_RECT &lt;&gt;</span><br><span class="line">	maxWinSize	COORD &lt;&gt;</span><br><span class="line">CONSOLE_SCREEN_BUFFER_INFO ENDS</span><br><span class="line">; dwSize: size of the screen buffer(char columns and rows)</span><br><span class="line">; dwCursorPos: cursor location</span><br><span class="line">; wAttributes: colors of characters in console buffer</span><br><span class="line">; srWindow: coords of console window relative to screen buffer</span><br><span class="line">; maxWinSize: maximum size of the console window</span><br><span class="line">COORD STRUCT</span><br><span class="line">	X WORD ?</span><br><span class="line">	Y WORD ?</span><br><span class="line">COORD ENDS</span><br><span class="line">SMALL_RECT STRUCT</span><br><span class="line">	Left WORD ?</span><br><span class="line">	Top WORD ?</span><br><span class="line">	Right WORD ?</span><br><span class="line">	Bottom WORD ?</span><br><span class="line">SMALL_RECT ENDS</span><br></pre></td></tr></table></figure>

<h4 id="2-4-SetConsoleWindowInfo"><a href="#2-4-SetConsoleWindowInfo" class="headerlink" title="2.4    SetConsoleWindowInfo"></a>2.4    SetConsoleWindowInfo</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SetConsoleWindowInfo PROTO,</span><br><span class="line">	nStdHandle:DWORD,			; screen buffer handle</span><br><span class="line">	bAbsolute:DWORD,			; coordinate type</span><br><span class="line">	pConsoleRect:PTR SMALL_RECT ; window rectangle</span><br><span class="line"></span><br><span class="line">SetConsoleScreenBufferSize PROTO,</span><br><span class="line">	outHandle:DWORD,			; handle to screen buffer</span><br><span class="line">	dwSize:COORD 				; new screen buffer size</span><br></pre></td></tr></table></figure>

<h2 id="3-Controlling-the-cursor"><a href="#3-Controlling-the-cursor" class="headerlink" title="3. Controlling the cursor"></a>3. Controlling the cursor</h2><h4 id="3-1-CONSOLE-CURSOR-INFO"><a href="#3-1-CONSOLE-CURSOR-INFO" class="headerlink" title="3.1    CONSOLE_CURSOR_INFO"></a>3.1    CONSOLE_CURSOR_INFO</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CONSOLE_CURSOR_INFO STRUCT</span><br><span class="line">	dwSize	DWORD ?		; percentage 1 to 100 of the char cell</span><br><span class="line">	bVisible DWORD ?	; true or false</span><br><span class="line">CONSOLE_CURSOR_INFO ENDS</span><br></pre></td></tr></table></figure>

<h4 id="3-2-SetConsoleTextAttribute"><a href="#3-2-SetConsoleTextAttribute" class="headerlink" title="3.2    SetConsoleTextAttribute"></a>3.2    SetConsoleTextAttribute</h4><p>sets the foreground and background colors of all subsequent text written to the console</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SetConsoleTextAttribute	PROTO,</span><br><span class="line">	hConsoleOutput:HANDLE,		; console output handle</span><br><span class="line">	wAttributes:WORD 			; color attribute</span><br></pre></td></tr></table></figure>

<h4 id="3-3-WriteConsoleOutputAttribute"><a href="#3-3-WriteConsoleOutputAttribute" class="headerlink" title="3.3    WriteConsoleOutputAttribute"></a>3.3    WriteConsoleOutputAttribute</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WriteConsoleOutputAttribute PROTO,</span><br><span class="line">	hConsoleOutput:DWORD,		; output handle</span><br><span class="line">	lpAttribute:PTR WORD,       ; write attributes</span><br><span class="line">	nLength:DWORD, 				; number of cells</span><br><span class="line">	dwWriteCoord:COORD,			; first cell coordinates</span><br><span class="line">	lpNumberOfAttrsWritten:PTR DWORD	; output count</span><br></pre></td></tr></table></figure>

<h4 id="3-4-WriteConsoleOutputCharacter"><a href="#3-4-WriteConsoleOutputCharacter" class="headerlink" title="3.4    WriteConsoleOutputCharacter"></a>3.4    WriteConsoleOutputCharacter</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WriteConsoleOutputCharacter PROTO,</span><br><span class="line">	hConsoleOutput:HANDLE,		; console output handle</span><br><span class="line">	lpCharacter:PTR BYTE,		; pointer to buffer</span><br><span class="line">	nLength:DWORD,				; size of buffer</span><br><span class="line">	dwWriteCoord:COORD,			; first cell coordinates</span><br><span class="line">	lpNumberOfCharsWritten:PTR DWORD	; output count</span><br></pre></td></tr></table></figure>

<h2 id="4-File-Manipulation"><a href="#4-File-Manipulation" class="headerlink" title="4. File Manipulation"></a>4. File Manipulation</h2><h4 id="4-1-CreateFile"><a href="#4-1-CreateFile" class="headerlink" title="4.1    CreateFile"></a>4.1    CreateFile</h4><p>either creates a new file or opens an existing file.</p>
<p>if successful, returns a handle to the open file; otherwise, returns INVALID_HANDLE_VALUE</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CreateFile PROTO,</span><br><span class="line">	pFilename:PTR BYTE,			; ptr to filename</span><br><span class="line">	desireAccess:DWORD,			; access mod</span><br><span class="line">	shareMode:DWORD,			; share mode</span><br><span class="line">	lpSecurity:DWORD,			; ptr to security attribs</span><br><span class="line">	creationDisposition:DWORD,  ; file creation options</span><br><span class="line">	flagsAndAttributes:DWORD,	; file attributes</span><br><span class="line">	htemplate:DWORD				; handle to template file</span><br><span class="line"></span><br><span class="line">; opens an existing file for reading</span><br><span class="line">INVOKE CreateFile,</span><br><span class="line">	ADDR filename,				; ptr to filename</span><br><span class="line">	GENERIC_READ,				; access mode &quot;GENERIC_WRITE&quot;	</span><br><span class="line">	DO_NOT_SHARE,				; share mode</span><br><span class="line">	NULL,						; ptr to security attributes</span><br><span class="line">	OPEN_EXISTING,				; file creation options</span><br><span class="line">	FILE_ATTRIBUTE_NORMAL,		; file attributes</span><br><span class="line">	0							; handle to template file</span><br><span class="line"></span><br><span class="line">INVOKE CreateFile,</span><br><span class="line">	ADDR filename,				; ptr to filename</span><br><span class="line">	GENERIC_WRITE,				; access mode</span><br><span class="line">	DO_NOT_SHARE,				; share mode</span><br><span class="line">	NULL,						; ptr to security attributes</span><br><span class="line">	CREATE_ALWAYS,				; file creation options</span><br><span class="line">	FILE_ATTRIBUTE_NORMAL,		; file attributes</span><br><span class="line">	0							; handle to template file</span><br></pre></td></tr></table></figure>

<h4 id="4-2-ReadFile"><a href="#4-2-ReadFile" class="headerlink" title="4.2    ReadFile"></a>4.2    ReadFile</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ReadFile PROTO,</span><br><span class="line">	handle:DWORD,				; handle to file</span><br><span class="line">	pBuffer:PTR BYTE,			; ptr to buffer</span><br><span class="line">	nBufSize:DWORD,				; num bytes to read</span><br><span class="line">	pBytesRead:PTR DWORD,		; bytes actually read</span><br><span class="line">	pOverlapped:PTR DWORD		; ptr to asynch info</span><br></pre></td></tr></table></figure>

<h4 id="4-3-WriteFile"><a href="#4-3-WriteFile" class="headerlink" title="4.3    WriteFile"></a>4.3    WriteFile</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WriteFile PROTO</span><br><span class="line">	fileHandle:DWORD,			; output handle</span><br><span class="line">	pBuffer:PTR BYTE,			; pointer to buffer</span><br><span class="line">	nBufSize:DWORD,				; size of buffer</span><br><span class="line">	pBytesWritten:PTR DWORD,	; num bytes written</span><br><span class="line">	pOverlapped:PTR DWORD		; ptr to asynch info</span><br></pre></td></tr></table></figure>

<h4 id="4-4-SetFilePointer"><a href="#4-4-SetFilePointer" class="headerlink" title="4.4    SetFilePointer"></a>4.4    SetFilePointer</h4><p>SetFilePointer moves the position pointer of an open file. </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SetFilePointer PROTO,</span><br><span class="line">	handle:DWORD,				; file handle</span><br><span class="line">	nDistanceLo:SDWORD,			; bytes to move pointer</span><br><span class="line">	pDistanceHi:PTR SDWORD,		; ptr to bytes to move</span><br><span class="line">	moveMethod:DWORD			; starting point</span><br><span class="line">INVOKE SetFilePointer, fileHandle, 0,0, FILE_END</span><br></pre></td></tr></table></figure>

<h4 id="4-5-GetLocalTime-SetLocalTime"><a href="#4-5-GetLocalTime-SetLocalTime" class="headerlink" title="4.5    GetLocalTime, SetLocalTime"></a>4.5    GetLocalTime, SetLocalTime</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GetLocalTime PROTO,</span><br><span class="line">	pSystemTime:PTR SYSTEMTIME</span><br><span class="line">SetLocalTime PROTO,</span><br><span class="line">	pSystemTime:PTR SYSTEMTIME</span><br><span class="line"></span><br><span class="line">SYSTEMTIME STRUCT</span><br><span class="line">	wYear WORD ?</span><br><span class="line">	wMonth WORD ?</span><br><span class="line">	wDayOfWeek WORD ?</span><br><span class="line">	wDay WORD ?</span><br><span class="line">	wHour WORD ?</span><br><span class="line">	wMinute WORD ?</span><br><span class="line">	wSecond WORD ?</span><br><span class="line">	wMilliseconds ?</span><br><span class="line">SYSTEMTIME ENDS</span><br></pre></td></tr></table></figure>

<h4 id="4-6-GetTickCount-Sleep"><a href="#4-6-GetTickCount-Sleep" class="headerlink" title="4.6    GetTickCount, Sleep"></a>4.6    GetTickCount, Sleep</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GetTickCount PROTO, ; return value in eax</span><br><span class="line">Sleep PROTO,</span><br><span class="line">	dwMilliseconds:DWORD</span><br></pre></td></tr></table></figure>

<h2 id="5-Writing-a-Graphic-Windows-Application"><a href="#5-Writing-a-Graphic-Windows-Application" class="headerlink" title="5. Writing a Graphic Windows Application"></a>5. Writing a Graphic Windows Application</h2><h4 id="5-1-MessageBox-Function"><a href="#5-1-MessageBox-Function" class="headerlink" title="5.1    MessageBox Function"></a>5.1    MessageBox Function</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MessageBox PROTO,</span><br><span class="line">	hWnd:DWORD,					; a handle to the current window</span><br><span class="line">	lpText:PTR BYTE,			; ptr to string inside the box</span><br><span class="line">    lpCaption:PTR BYTE,			; ptr to string	in caption&#x27;s bar</span><br><span class="line">	uTyle:DWORD					; describe icon</span><br><span class="line"></span><br><span class="line">.data</span><br><span class="line">hMainWnd DWORD ?</span><br><span class="line">QuestionText BYTE &quot;Register this program now?&quot;, 0</span><br><span class="line">QuestionTitle BYTE &quot;Trial Period Has Expired&quot;, 0</span><br><span class="line">.code</span><br><span class="line">INVOKE MessageBox, hMainWnd, ADDR QuestionText, ADDR QuestionTitle,</span><br><span class="line">	MB_OK + MB_ICONQUESTION</span><br></pre></td></tr></table></figure>

<h4 id="5-2-Required-Files"><a href="#5-2-Required-Files" class="headerlink" title="5.2    Required Files"></a>5.2    Required Files</h4><p><a href="https://imgtu.com/i/HL4YpF"><img src="https://s4.ax1x.com/2022/02/20/HL4YpF.png" alt="HL4YpF.png"></a></p>
<h4 id="5-3-Structures"><a href="#5-3-Structures" class="headerlink" title="5.3    Structures"></a>5.3    Structures</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MSGStruct STRUCT</span><br><span class="line">	msgWnd DWORD ?</span><br><span class="line">	msgMessage DWORD ?</span><br><span class="line">	msgWparam DWORD ?</span><br><span class="line">	msgLparam DWORD ?</span><br><span class="line">	msgTime DWORD ?</span><br><span class="line">	msgPt POINT &lt;&gt;</span><br><span class="line">MSGStruct ENDS</span><br><span class="line"></span><br><span class="line">; each window belongs to a class and each program defines a window class for its main window</span><br><span class="line">WNDCLASS STRUCT</span><br><span class="line">	style DWORD ?				; window style options	</span><br><span class="line">	lpfnWndProc DWORD ?			; winproc function pointer</span><br><span class="line">	cbClsExtra DWORD ?			; shared memory</span><br><span class="line">	cbWndExtra DWORD ?			; number of extra bytes</span><br><span class="line">	hInstance DWORD ?			; handle to current program</span><br><span class="line">	hIcon DWORD ?				; handle to icon</span><br><span class="line">	hCursor DWORD ?				; handle to cursor</span><br><span class="line">	hbrBackground DWORD ?		; handle to background brush</span><br><span class="line">	lpszMenuName DWORD ?		; pointer to menu name</span><br><span class="line">	lpszClassName DWORD ?		; pointer ro winclass name</span><br><span class="line">WNDCLASS ENDS</span><br></pre></td></tr></table></figure>

<p><a href="https://imgtu.com/i/HL52CT"><img src="https://s4.ax1x.com/2022/02/20/HL52CT.png" alt="HL52CT.png"></a></p>
<h4 id="5-4-WinMain-Procedure"><a href="#5-4-WinMain-Procedure" class="headerlink" title="5.4    WinMain Procedure"></a>5.4    WinMain Procedure</h4><p>every windows application needs a startup procedure named WinMain</p>
<p>Get a handle to the current program</p>
<p>Load the program’s icon and mouse cursor</p>
<p>Register the program’s main window class and identify the procedure that will process event messages for the window</p>
<p>Create the main window</p>
<p>Show and update the main window</p>
<p>Begin a loop that receives and dispatches messages</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WindProc PROC,</span><br><span class="line">	hWnd:DWORD,			; handle to the window</span><br><span class="line">	localMsg:DWORD,     ; message ID</span><br><span class="line">	wParam:DWORD, 		; parameter 1</span><br><span class="line">	lParam:DWORD		; parameter 2</span><br></pre></td></tr></table></figure>

<h4 id="5-5-ErrorHandler-Procedure"><a href="#5-5-ErrorHandler-Procedure" class="headerlink" title="5.5    ErrorHandler Procedure"></a>5.5    ErrorHandler Procedure</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GetLastError: retrieve the system error number</span><br><span class="line">FormatMessage: retrieve the appropriate system-formatted error message string</span><br><span class="line">MessageBox: display a popup message box</span><br><span class="line">LocalFree: free the memory used by the error message string</span><br><span class="line"></span><br><span class="line">INVOKE GetLastError	; return message ID in eax</span><br><span class="line">mov messageID, eax</span><br><span class="line"></span><br><span class="line">INVOKE FormatMessage, FORMAT_MESSAGE_ALLOCATION_BUFFER + \</span><br><span class="line"> FORMAT_MESSAGE_FROM_SYSTEM, NULL, messageID, NULL, ADDR pErrorMsg, NULL, NULL</span><br><span class="line"></span><br><span class="line">INVOKE MessageBox, NULL, pErrorMsg, ADDR ErrorTitle, MB_ICONERROR + MB_OK</span><br><span class="line"></span><br><span class="line">INVOKE LocalFree, pErrorMsg</span><br><span class="line"></span><br><span class="line">Message_Loop:</span><br><span class="line">	INVOKE GetMessage, ADDR msg, NULL, NULL, NULL</span><br><span class="line">	.IF eax == 0</span><br><span class="line">		jmp Exit_Program</span><br><span class="line">	.ENDIF</span><br><span class="line">	INVOKE DispatchMessage, ADDR msg</span><br><span class="line">	jmp Message_Loop</span><br><span class="line"></span><br><span class="line">WinProc PROC, hWnd:DWORD, localMsg:DWORD,</span><br><span class="line">	wParam:WORD, lParam:DWORD</span><br><span class="line">	mov eax, localMsg</span><br><span class="line">	.IF eax == WM_LBUTTOMDOWN</span><br><span class="line">		INVOKE MessageBox, hWnd, ADDR PopupText, ADDR PopupTitle, MB_OK</span><br><span class="line">		jmp WinProcExit</span><br><span class="line">	.ELSEIF eax == WM_CREATE</span><br><span class="line">		INVOKE MessageBox, hWnd,ADDR AppLoadMsgText,ADDR AppLoadMsgTitle,MB_OK</span><br><span class="line">		jmp WinProcExit</span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<h2 id="6-Dynamic-Memory-Allocation"><a href="#6-Dynamic-Memory-Allocation" class="headerlink" title="6. Dynamic Memory Allocation"></a>6. Dynamic Memory Allocation</h2><p><a href="https://imgtu.com/i/HO9pc9"><img src="https://s4.ax1x.com/2022/02/20/HO9pc9.png" alt="HO9pc9.png"></a></p>
<h4 id="6-1-sample-create"><a href="#6-1-sample-create" class="headerlink" title="6.1 sample create"></a>6.1 sample create</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HEAP_START = 2000000	; 2MB</span><br><span class="line">HEAP_MAX = 400000000	; 400MB</span><br><span class="line">.data</span><br><span class="line">hHeap HANDLE ?</span><br><span class="line">.code</span><br><span class="line">INVOKE HeapCreate, 0, HEAP_START, HEAP_MAX</span><br><span class="line">.IF eax == NULL</span><br><span class="line">	jmp quit</span><br><span class="line">.ELSE</span><br><span class="line">	mov hHeap, eax</span><br><span class="line">.ENDIF</span><br></pre></td></tr></table></figure>

<h4 id="6-2-sample-free"><a href="#6-2-sample-free" class="headerlink" title="6.2    sample free"></a>6.2    sample free</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">hHeap HANDLE ?</span><br><span class="line">pArray DWORD ?</span><br><span class="line">.code</span><br><span class="line">INVOKE HeapFree, hHeap, 0, pArray</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>汇编</category>
      </categories>
      <tags>
        <tag>汇编</tag>
      </tags>
  </entry>
</search>
